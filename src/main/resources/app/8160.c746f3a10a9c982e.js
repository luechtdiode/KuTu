"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8160],{8160:(O,m,a)=>{a.r(m),a.d(m,{LastTopResultsPageModule:()=>y});var l=a(6396),p=a(4341),f=a(9355),s=a(7125),h=a(5964),u=a(1158),t=a(7241),g=a(8564),_=a(2350);function T(o,r){if(1&o&&(t.j41(0,"ion-select-option",9),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&o){const e=r.$implicit;t.Y8G("value",e.uuid),t.R7$(),t.SpI(" ",e.titel+" "+t.i5U(2,2,e.datum,"dd-MM-yy"))}}function R(o,r){if(1&o){const e=t.RV6();t.j41(0,"ion-select",7),t.mxI("ngModelChange",function(n){g.eBV(e);const c=t.XpG(2);return t.DH7(c.competition,n)||(c.competition=n),g.Njj(n)}),t.DNE(1,T,3,5,"ion-select-option",8),t.k0s()}if(2&o){const e=t.XpG(2);t.R50("ngModel",e.competition),t.R7$(),t.Y8G("ngForOf",e.getCompetitions())}}function v(o,r){if(1&o&&(t.j41(0,"ion-col")(1,"ion-item"),t.DNE(2,R,2,2,"ion-select",6),t.k0s()()),2&o){const e=t.XpG();t.R7$(2),t.Y8G("ngIf",e.getCompetitions().length>0)}}function k(o,r){if(1&o&&(t.j41(0,"ion-note",10),t.EFF(1),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.SpI(" ",e.competitionName()," ")}}function b(o,r){if(1&o&&(t.j41(0,"ion-col",13),t.nrm(1,"result-display",14),t.k0s()),2&o){const e=r.$implicit,i=t.XpG(3);t.BMQ("size-xl",i.getMaxColumnSpec()),t.R7$(),t.Y8G("item",e)("title",i.getTitle(e))("groupedBy",i.groupBy.PROGRAMM)}}function x(o,r){if(1&o&&(t.j41(0,"ion-row"),t.DNE(1,b,2,4,"ion-col",12),t.k0s()),2&o){const e=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ngForOf",i.getWertungen(e))}}function S(o,r){if(1&o&&(t.j41(0,"ion-grid",2),t.DNE(1,x,2,1,"ion-row",11),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.getProgramme())}}function G(o,r){if(1&o&&(t.j41(0,"ion-col",16),t.nrm(1,"result-display",14),t.k0s()),2&o){const e=r.$implicit,i=t.XpG(3);t.BMQ("size-xl",i.getMaxColumnSpec()),t.R7$(),t.Y8G("item",e)("title",i.getTitle(e))("groupedBy",i.groupBy.PROGRAMM)}}function I(o,r){if(1&o&&(t.j41(0,"ion-row"),t.DNE(1,G,2,4,"ion-col",15),t.k0s()),2&o){const e=r.$implicit,i=t.XpG(2);t.R7$(),t.Y8G("ngForOf",i.getWertungen(e))}}function M(o,r){if(1&o&&(t.j41(0,"ion-grid",2),t.DNE(1,I,2,1,"ion-row",11),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Y8G("ngForOf",e.getProgramme())}}let F=(()=>{class o{backendService;groupBy=u.R;items=[];toptop={};geraete=[];ngOnInit(){this.backendService.competitionSubject.subscribe(e=>{this.backendService.activateNonCaptionMode(this.backendService.competition).subscribe(i=>{this.geraete=i||[],this.sortItems()}),this.backendService.newLastResults.pipe((0,h.p)(i=>!!i&&!!i.lastTopResults)).subscribe(i=>{this.items=[],this.toptop={},Object.keys(i.lastTopResults).forEach(n=>{const c=i.lastTopResults[n],d=this.toptop[c.wertung.wettkampfdisziplinId];d?d.wertung.endnote<c.wertung.endnote&&(this.toptop[c.wertung.wettkampfdisziplinId]=c):this.toptop[c.wertung.wettkampfdisziplinId]=c}),Object.keys(this.toptop).forEach(n=>{this.items.push(this.toptop[n])}),this.sortItems()})})}constructor(e){this.backendService=e,this.backendService.competitions||this.backendService.getCompetitions()}sortItems(){this.items=this.items.sort((e,i)=>{let n=e.programm.localeCompare(i.programm);return 0===n&&(n=this.geraetOrder(e.geraet)-this.geraetOrder(i.geraet)),n})}get stationFreezed(){return this.backendService.stationFreezed}set competition(e){this.stationFreezed||(this.backendService.getDurchgaenge(e),this.backendService.activateNonCaptionMode(this.backendService.competition).subscribe(i=>{this.geraete=i||[],this.sortItems()}))}get competition(){return this.backendService.competition||""}getCompetitions(){return this.backendService.competitions||[]}competitionName(){if(!this.backendService.competitions)return"";const e=this.backendService.competitions.filter(i=>i.uuid===this.backendService.competition).map(i=>i.titel+", am "+(i.datum+"T").split("T")[0].split("-").reverse().join("-"));return 1===e.length?e[0]:""}geraetOrder(e){return this.geraete?this.geraete.findIndex(n=>n.id===e):0}geraetText(e){if(!this.geraete)return"";const i=this.geraete.filter(n=>n.id===e).map(n=>n.name);return 1===i.length?i[0]:""}getColumnSpec(){return this.geraete?.length||0}getMaxColumnSpec(){return Math.min(12,Math.max(1,Math.floor(12/this.geraete.length+.5)))}getTitle(e){return e.programm+" - "+this.geraetText(e.geraet)}onlyUnique(e,i,n){return n.indexOf(e)===i}getProgramme(){return this.items.map(e=>e.programm).filter(this.onlyUnique)}getWertungen(e){return this.items.filter(i=>i.programm===e)}itemTapped(e,i){}static \u0275fac=function(i){return new(i||o)(t.rXU(_.m))};static \u0275cmp=t.VBU({type:o,selectors:[["app-last-top-results"]],standalone:!1,decls:17,vars:4,consts:[["slot","start"],["slot","icon-only","name","menu"],["no-padding",""],[4,"ngIf"],["slot","end",4,"ngIf"],["no-padding","",4,"ngIf"],["label","Wettkampf","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange",4,"ngIf"],["label","Wettkampf","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["slot","end"],[4,"ngFor","ngForOf"],["class","align-self-start","size-xs","12","size-md","6","size-lg","3",4,"ngFor","ngForOf"],["size-xs","12","size-md","6","size-lg","3",1,"align-self-start"],[3,"item","title","groupedBy"],["class","align-self-start","size-xs","12","size-sm","6","size-md","4","size-lg","3",4,"ngFor","ngForOf"],["size-xs","12","size-sm","6","size-md","4","size-lg","3",1,"align-self-start"]],template:function(i,n){1&i&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-menu-toggle")(4,"ion-button"),t.nrm(5,"ion-icon",1),t.k0s()()(),t.j41(6,"ion-title")(7,"ion-grid",2)(8,"ion-row")(9,"ion-col")(10,"ion-label"),t.EFF(11,"Top Resultate"),t.k0s()(),t.DNE(12,v,3,1,"ion-col",3),t.k0s()()(),t.DNE(13,k,2,1,"ion-note",4),t.k0s()(),t.j41(14,"ion-content"),t.DNE(15,S,2,1,"ion-grid",5)(16,M,2,1,"ion-grid",5),t.k0s()),2&i&&(t.R7$(12),t.Y8G("ngIf",!n.competition),t.R7$(),t.Y8G("ngIf",n.competition),t.R7$(2),t.Y8G("ngIf",n.items.length>0&&6===n.getColumnSpec()),t.R7$(),t.Y8G("ngIf",n.items.length>0&&6!==n.getColumnSpec()))},dependencies:[l.Sq,l.bT,p.BC,p.vS,s.Jm,s.QW,s.hU,s.W9,s.lO,s.eU,s.iq,s.uz,s.he,s.cA,s.JI,s.ln,s.Nm,s.Ip,s.BC,s.ai,s.Je,u.v,l.vh],encapsulation:2})}return o})();var z=a(5079);const C=[{path:"",component:F}];let y=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=t.$C({type:o});static \u0275inj=g.G2t({imports:[l.MD,p.YN,s.bv,f.iI.forChild(C),z.h]})}return o})()}}]);