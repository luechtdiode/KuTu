(self.webpackChunkresultcatcher=self.webpackChunkresultcatcher||[]).push([[5372],{5372:(e,t,i)=>{"use strict";i.r(t),i.d(t,{ClubregEditorPageModule:()=>v});var n=i(8583),s=i(665),r=i(2952),a=i(2859),o=i(4762),d=i(5257),l=i(7225),c=i(8186),g=i(600);function h(e,t){if(1&e&&(c.TgZ(0,"ion-item"),c.TgZ(1,"ion-avatar",0),c._UZ(2,"img",23),c.qZA(),c._UZ(3,"ion-input",24),c._UZ(4,"ion-input",25),c.qZA()),2&e){const e=c.oxw(2);c.xp6(3),c.Q6J("readonly",!1)("disabled",!1)("ngModel",e.newRegistration.secret),c.xp6(1),c.Q6J("readonly",!1)("disabled",!1)("ngModel",e.newRegistration.verification)}}function p(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"ion-item"),c.TgZ(1,"ion-avatar",0),c._UZ(2,"img",23),c.qZA(),c.TgZ(3,"ion-input",26),c.NdJ("ngModelChange",function(t){return c.CHM(e),c.oxw(2).changePassword.secret=t}),c.qZA(),c.TgZ(4,"ion-input",27),c.NdJ("ngModelChange",function(t){return c.CHM(e),c.oxw(2).changePassword.verification=t}),c.qZA(),c.TgZ(5,"ion-button",28,29),c.NdJ("click",function(){return c.CHM(e),c.oxw(2).savePWChange()}),c._UZ(7,"ion-icon",21),c._uU(8,"Passwort \xe4ndern "),c.qZA(),c.qZA()}if(2&e){const e=c.oxw(2);c.xp6(3),c.Q6J("readonly",!1)("disabled",!1)("ngModel",e.changePassword.secret),c.xp6(1),c.Q6J("readonly",!1)("disabled",!1)("ngModel",e.changePassword.verification),c.xp6(1),c.Q6J("disabled",e.waiting||!e.changePassword.secret||e.changePassword.secret!==e.changePassword.verification)}}function m(e,t){if(1&e&&(c.TgZ(0,"ion-item"),c._uU(1),c.qZA()),2&e){const e=t.$implicit;c.xp6(1),c.hij(" ",e," ")}}function u(e,t){if(1&e){const e=c.EpF();c.TgZ(0,"ion-content"),c.TgZ(1,"form",7,8),c.NdJ("ngSubmit",function(){c.CHM(e);const t=c.MAs(2);return c.oxw().save(t.value)})("keyup.enter",function(){c.CHM(e);const t=c.MAs(2);return c.oxw().save(t.value)}),c.TgZ(3,"ion-list"),c.TgZ(4,"ion-item-divider",9),c._uU(5,"Verein"),c.qZA(),c.TgZ(6,"ion-item"),c.TgZ(7,"ion-avatar",0),c._UZ(8,"img",10),c.qZA(),c._UZ(9,"ion-input",11),c._UZ(10,"ion-input",12),c.qZA(),c.TgZ(11,"ion-item-divider",9),c._uU(12,"Verantwortliche Person"),c.qZA(),c.TgZ(13,"ion-item"),c.TgZ(14,"ion-avatar",0),c._UZ(15,"img",13),c.qZA(),c._UZ(16,"ion-input",14),c._UZ(17,"ion-input",15),c.qZA(),c.YNc(18,h,5,6,"ion-item",4),c.YNc(19,p,9,7,"ion-item",4),c.TgZ(20,"ion-item-divider",9),c._uU(21,"Kontakt"),c.qZA(),c.TgZ(22,"ion-item"),c.TgZ(23,"ion-avatar",0),c._UZ(24,"img",16),c.qZA(),c._UZ(25,"ion-input",17),c._UZ(26,"ion-input",18),c.qZA(),c.qZA(),c.TgZ(27,"ion-button",19,20),c._UZ(29,"ion-icon",21),c._uU(30,"Speichern "),c.qZA(),c.qZA(),c.TgZ(31,"ion-list"),c.TgZ(32,"ion-item-divider",9),c._uU(33),c.qZA(),c.YNc(34,m,2,1,"ion-item",22),c.qZA(),c.qZA()}if(2&e){const e=c.MAs(2),t=c.oxw();c.xp6(9),c.Q6J("readonly",!1)("disabled",!1)("ngModel",t.registration.vereinname),c.xp6(1),c.Q6J("readonly",!1)("disabled",!1)("ngModel",t.registration.verband),c.xp6(6),c.Q6J("readonly",!1)("disabled",!1)("ngModel",t.registration.respVorname),c.xp6(1),c.Q6J("readonly",!1)("disabled",!1)("ngModel",t.registration.respName),c.xp6(1),c.Q6J("ngIf",0===t.regId),c.xp6(1),c.Q6J("ngIf",t.regId>0),c.xp6(6),c.Q6J("readonly",!1)("disabled",!1)("ngModel",t.registration.mail),c.xp6(1),c.Q6J("readonly",!1)("disabled",!1)("ngModel",t.registration.mobilephone),c.xp6(1),c.Q6J("disabled",t.waiting||!e.valid||e.untouched),c.xp6(6),c.hij("Pendente Verarbeitungen (",t.sSyncActions.length,")"),c.xp6(1),c.Q6J("ngForOf",t.sSyncActions)}}const b=[{path:"",component:(()=>{class e{constructor(e,t,i,n,s,r){this.navCtrl=e,this.route=t,this.backendService=i,this.alertCtrl=n,this.actionSheetController=s,this.zone=r,this.waiting=!1,this.sSyncActions=[],this.backendService.competitions||this.backendService.getCompetitions()}ngOnInit(){this.waiting=!0,this.wkId=this.route.snapshot.paramMap.get("wkId"),this.regId=parseInt(this.route.snapshot.paramMap.get("regId")),this.backendService.getCompetitions().subscribe(e=>{this.wettkampfId=parseInt(e.find(e=>e.uuid===this.wkId).id),this.regId?this.backendService.getClubRegistrations(this.wkId).subscribe(e=>{e&&e.length>0&&this.updateUI(e.find(e=>e.id===this.regId))}):this.updateUI({mobilephone:"+417"})})}presentActionSheet(){return(0,o.mG)(this,void 0,void 0,function*(){let e={};e=this.registration.vereinId?{header:"Anmeldungen",cssClass:"my-actionsheet-class",buttons:[{text:"Athlet & Athletinnen",icon:"list",handler:()=>{this.editAthletRegistrations()}},{text:"Wertungsrichter",icon:"glasses",handler:()=>{this.editJudgeRegistrations()}},{text:"Kopieren aus anderem Wettkampf",icon:"share",handler:()=>{this.copyFromOthers()}},{text:"Registrierung l\xf6schen",role:"destructive",icon:"trash",handler:()=>{this.delete()}},{text:"Abbrechen",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]}:{header:"Anmeldungen",cssClass:"my-actionsheet-class",buttons:[{text:"Athlet & Athletinnen",icon:"list",handler:()=>{this.editAthletRegistrations()}},{text:"Wertungsrichter",icon:"glasses",handler:()=>{this.editJudgeRegistrations()}},{text:"Registrierung l\xf6schen",role:"destructive",icon:"trash",handler:()=>{this.delete()}},{text:"Abbrechen",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]};const t=yield this.actionSheetController.create(e);yield t.present()})}editable(){return this.backendService.loggedIn}ionViewWillEnter(){this.getSyncActions()}getSyncActions(){this.regId>0&&this.backendService.loadRegistrationSyncActions().pipe((0,d.q)(1)).subscribe(e=>{this.sSyncActions=e.filter(e=>e.verein.id===this.registration.id).map(e=>e.caption)})}updateUI(e){this.zone.run(()=>{this.waiting=!1,this.wettkampf=this.backendService.competitionName,this.registration=e,0===this.regId?this.newRegistration=e:this.changePassword={id:this.regId,wettkampfId:e.wettkampfId||this.wettkampfId,secret:"",verification:""},this.registration.mail.length>1&&(this.backendService.currentUserName=this.registration.mail)})}savePWChange(){this.changePassword&&this.changePassword.secret&&this.changePassword.secret===this.changePassword.verification&&this.backendService.saveClubRegistrationPW(this.wkId,this.changePassword)}save(e){if(0===this.regId){const t=e;t.secret!==t.verification?this.alertCtrl.create({header:"Achtung",subHeader:"Passwort-Verifikation",message:"Das Passwort stimmt nicht mit der Verifikation \xfcberein. Beide m\xfcssen genau gleich erfasst sein.",buttons:[{text:"OKAY",role:"cancel",handler:()=>{}}]}).then(e=>e.present()):this.backendService.createClubRegistration(this.wkId,{mail:t.mail,mobilephone:t.mobilephone,respName:t.respName,respVorname:t.respVorname,verband:t.verband,vereinname:t.vereinname,wettkampfId:t.wettkampfId||this.wettkampfId,secret:t.secret}).subscribe(e=>{this.regId=e.id,this.registration=e,this.backendService.currentUserName=e.mail,this.editAthletRegistrations()})}else this.backendService.saveClubRegistration(this.wkId,{id:this.registration.id,registrationTime:this.registration.registrationTime,vereinId:this.registration.vereinId,mail:e.mail,mobilephone:e.mobilephone,respName:e.respName,respVorname:e.respVorname,verband:e.verband,vereinname:e.vereinname,wettkampfId:e.wettkampfId||this.wettkampfId})}delete(){this.alertCtrl.create({header:"Achtung",subHeader:"L\xf6schen der Vereins-Registrierung und dessen Anmeldungen am Wettkampf",message:"Hiermit wird die Vereinsanmeldung am Wettkampf komplett gel\xf6scht.",buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"OKAY",handler:()=>{this.backendService.deleteClubRegistration(this.wkId,this.regId).subscribe(()=>{this.navCtrl.pop()})}}]}).then(e=>e.present())}editAthletRegistrations(){this.navCtrl.navigateForward(`reg-athletlist/${this.backendService.competition}/${this.regId}`)}editJudgeRegistrations(){this.navCtrl.navigateForward(`reg-judgelist/${this.backendService.competition}/${this.regId}`)}copyFromOthers(){this.backendService.findCompetitionsByVerein(this.registration.vereinId).subscribe(e=>{const t=e.map(e=>({type:"radio",label:e.titel+" ("+(0,l.tC)(e.datum)+")",value:e}));this.alertCtrl.create({header:"Anmeldungen kopieren",cssClass:"my-optionselection-class",message:"Aus welchem Wettkampf sollen die Anmeldungen kopiert werden?",inputs:t,buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"OKAY",handler:e=>{this.backendService.copyClubRegsFromCompetition(e,this.backendService.competition,this.registration.id).subscribe(()=>{this.getSyncActions(),this.alertCtrl.create({header:"Anmeldungen kopieren",message:"Alle nicht bereits erfassten Anmeldungen wurden \xfcbernommen.",buttons:[{text:"OKAY",role:"cancel",handler:()=>{}},{text:"> Athlet-Anmeldungen",handler:()=>{this.editAthletRegistrations()}},{text:"> WR Anmeldungen",handler:()=>{this.editJudgeRegistrations()}}]}).then(e=>e.present())})}}]}).then(e=>e.present())})}}return e.\u0275fac=function(t){return new(t||e)(c.Y36(a.SH),c.Y36(r.gz),c.Y36(g.v),c.Y36(a.Br),c.Y36(a.BX),c.Y36(c.R0b))},e.\u0275cmp=c.Xpm({type:e,selectors:[["app-clubreg-editor"]],decls:15,vars:3,consts:[["slot","start"],["defaultHref","/"],["slot","end"],[1,"athlet"],[4,"ngIf"],["size","large","expand","block","color","primary",3,"disabled","click"],["slot","start","name","list"],[3,"ngSubmit","keyup.enter"],["clubRegistrationform","ngForm"],["color","primary"],["src","assets/imgs/verein.png"],["placeholder","Vereinsname","type","text","name","vereinname","required","",3,"readonly","disabled","ngModel"],["placeholder","Verband","type","text","name","verband","required","",3,"readonly","disabled","ngModel"],["src","assets/imgs/chief.png"],["placeholder","Vorname","type","text","name","respVorname","required","",3,"readonly","disabled","ngModel"],["placeholder","Nachname","type","text","name","respName","required","",3,"readonly","disabled","ngModel"],["src","assets/imgs/atmail.png"],["placeholder","Mail","type","email","pattern","^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,5})$","name","mail","required","",3,"readonly","disabled","ngModel"],["placeholder","Mobile/SMS (+4179...)","type","tel","pattern","[+]{1}[0-9]{11,14}","name","mobilephone","required","",3,"readonly","disabled","ngModel"],["size","large","expand","block","type","submit","color","success",3,"disabled"],["btnSaveNext",""],["slot","start","name","save"],[4,"ngFor","ngForOf"],["src","assets/imgs/password.png"],["placeholder","Passwort","type","password","name","secret","required","",3,"readonly","disabled","ngModel"],["placeholder","Passwort best\xe4tigen","type","password","name","verification","required","",3,"readonly","disabled","ngModel"],["placeholder","Passwort","type","password","name","secret",3,"readonly","disabled","ngModel","ngModelChange"],["placeholder","Passwort best\xe4tigen","type","password","name","verification",3,"readonly","disabled","ngModel","ngModelChange"],["size","small","color","danger",3,"disabled","click"],["btnChangePassword",""]],template:function(e,t){1&e&&(c.TgZ(0,"ion-header"),c.TgZ(1,"ion-toolbar"),c.TgZ(2,"ion-buttons",0),c._UZ(3,"ion-back-button",1),c.qZA(),c.TgZ(4,"ion-title"),c._uU(5,"Vereins-Anmeldung"),c.qZA(),c.TgZ(6,"ion-note",2),c.TgZ(7,"div",3),c._uU(8),c.qZA(),c.qZA(),c.qZA(),c.qZA(),c.YNc(9,u,35,23,"ion-content",4),c.TgZ(10,"ion-footer"),c.TgZ(11,"ion-toolbar"),c.TgZ(12,"ion-button",5),c.NdJ("click",function(){return t.presentActionSheet()}),c._UZ(13,"ion-icon",6),c._uU(14,"Anmeldungen... "),c.qZA(),c.qZA(),c.qZA()),2&e&&(c.xp6(8),c.hij("f\xfcr ",t.wettkampf,""),c.xp6(1),c.Q6J("ngIf",t.registration),c.xp6(3),c.Q6J("disabled",t.waiting||0===t.regId))},directives:[a.Gu,a.sr,a.Sm,a.oU,a.cs,a.wd,a.uN,n.O5,a.fr,a.YG,a.gu,a.W2,s._Y,s.JL,s.F,a.q_,a.rH,a.Ie,a.BJ,a.pK,a.j9,s.Q7,s.JJ,s.On,s.c5,n.sg],styles:[""]}),e})()}];let v=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=c.oAB({type:e}),e.\u0275inj=c.cJS({imports:[[n.ez,s.u5,a.Pc,r.Bz.forChild(b)]]}),e})()}}]);