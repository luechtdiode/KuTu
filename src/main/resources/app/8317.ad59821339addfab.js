"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8317],{5079:(F,p,a)=>{a.d(p,{h:()=>f});var u=a(2200),d=a(4341),g=a(9912),r=a(2615),c=a(3664);let f=(()=>{class h{static \u0275fac=function(v){return new(v||h)};static \u0275mod=c.$C({type:h});static \u0275inj=r.G2t({imports:[u.MD,d.YN,g.bv]})}return h})()},8317:(F,p,a)=>{a.r(p),a.d(p,{SearchAthletPageModule:()=>G});var u=a(2200),d=a(4341),g=a(8132),r=a(9912),c=a(2615),f=a(4942),h=a(2350),b=a(1413),_=a(4412),v=a(7673),C=a(1266),A=a(6354),T=a(152),k=a(3294),P=a(7647),j=a(5558),t=a(3664),S=a(7705);let I=(()=>{class o{programm=(0,S.hFB)(void 0);teilnehmer=(0,S.hFB)(void 0);selected=(0,S.CGW)();constructor(){}ngOnInit(){}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=t.VBU({type:o,selectors:[["startlist-item"]],inputs:{programm:[1,"programm"],teilnehmer:[1,"teilnehmer"]},outputs:{selected:"selected"},standalone:!1,decls:16,vars:5,consts:[[3,"click"],["slot","start"],["src","assets/imgs/athlete.png"],["slot","end"]],template:function(n,i){1&n&&(t.j41(0,"ion-item",0),t.bIt("click",function(){return i.selected?i.selected.emit(i.teilnehmer()):{}}),t.j41(1,"ion-avatar",1),t.nrm(2,"img",2),t.k0s(),t.j41(3,"ion-label"),t.EFF(4),t.j41(5,"small"),t.EFF(6),t.k0s(),t.nrm(7,"br"),t.j41(8,"small")(9,"em"),t.EFF(10),t.k0s()()(),t.j41(11,"ion-note",3),t.EFF(12," Startger\xe4t:"),t.nrm(13,"br"),t.j41(14,"b"),t.EFF(15),t.k0s()()()),2&n&&(t.R7$(4),t.SpI("",i.teilnehmer().athlet,"\xa0"),t.R7$(2),t.JRh(i.teilnehmer().verein+", "+i.programm().programm),t.R7$(4),t.Lme("",i.teilnehmer().durchgang," ",i.teilnehmer().team),t.R7$(5),t.JRh(i.teilnehmer().start))},dependencies:[r.mC,r.uz,r.he,r.JI],styles:["ion-note[_ngcontent-%COMP%]{text-align:end}"]})}return o})();function R(o,m){if(1&o&&(t.j41(0,"ion-select-option",8),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&o){const e=m.$implicit;t.Y8G("value",e.uuid),t.R7$(),t.SpI(" ",e.titel+" "+t.i5U(2,2,e.datum,"dd-MM-yy"))}}function E(o,m){if(1&o){const e=t.RV6();t.j41(0,"ion-select",7),t.mxI("ngModelChange",function(i){c.eBV(e);const s=t.XpG(2);return t.DH7(s.competition,i)||(s.competition=i),c.Njj(i)}),t.Z7z(1,R,3,5,"ion-select-option",8,t.fX1),t.k0s()}if(2&o){const e=t.XpG(2);t.R50("ngModel",e.competition),t.R7$(),t.Dyx(e.getCompetitions())}}function $(o,m){if(1&o&&(t.j41(0,"ion-col")(1,"ion-item"),t.nVh(2,E,3,1,"ion-select",6),t.k0s()()),2&o){const e=t.XpG();t.R7$(2),t.vxM(e.getCompetitions().length>0?2:-1)}}function B(o,m){if(1&o&&(t.j41(0,"ion-note",4),t.EFF(1),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.SpI(" ",e.competitionName()," ")}}function O(o,m){1&o&&(t.j41(0,"ion-item")(1,"ion-label"),t.EFF(2,"loading ..."),t.k0s(),t.nrm(3,"ion-spinner"),t.k0s())}function x(o,m){if(1&o){const e=t.RV6();t.j41(0,"ion-item-sliding",null,0)(2,"startlist-item",9),t.bIt("click",function(){const i=c.eBV(e).$implicit,s=t.sdS(1),l=t.XpG(3);return c.Njj(l.itemTapped(i,s))}),t.k0s(),t.j41(3,"ion-item-options",10)(4,"ion-item-option",11),t.bIt("click",function(){const i=c.eBV(e).$implicit,s=t.sdS(1),l=t.XpG(3);return c.Njj(l.followAthlet(i,s))}),t.nrm(5,"ion-icon",12),t.EFF(6),t.k0s(),t.j41(7,"ion-item-option",13),t.bIt("click",function(){const i=c.eBV(e).$implicit,s=t.sdS(1),l=t.XpG(3);return c.Njj(l.followRiege(i,s))}),t.nrm(8,"ion-icon",12),t.EFF(9," Riege verfolgen "),t.k0s()()()}if(2&o){const e=m.$implicit,n=t.XpG().$implicit;t.R7$(2),t.Y8G("teilnehmer",e)("programm",n),t.R7$(4),t.SpI(" ",e.athlet," verfolgen ")}}function D(o,m){if(1&o&&(t.j41(0,"div")(1,"ion-item-divider"),t.EFF(2),t.k0s(),t.Z7z(3,x,10,3,"ion-item-sliding",null,t.fX1),t.k0s()),2&o){const e=m.$implicit;t.R7$(2),t.JRh(e.programm),t.R7$(),t.Dyx(e.teilnehmer)}}function L(o,m){if(1&o&&(t.j41(0,"ion-content")(1,"ion-list"),t.nVh(2,O,4,0,"ion-item"),t.nI1(3,"async"),t.Z7z(4,D,5,1,"div",null,t.fX1),t.k0s()()),2&o){const e=t.XpG();t.R7$(2),t.vxM(t.bMT(3,1,e.isBusy)?2:-1),t.R7$(2),t.Dyx(e.filteredStartList.programme)}}let Q=(()=>{class o{navCtrl=(0,c.WQX)(f.q9);route=(0,c.WQX)(C.nX);router=(0,c.WQX)(C.Ix);backendService=(0,c.WQX)(h.m);sStartList;sFilteredStartList;sMyQuery;tMyQueryStream=new b.B;sFilterTask=void 0;busy=new _.t(!1);constructor(){this.backendService.competitions||this.backendService.getCompetitions()}ngOnInit(){this.busy.next(!0);const e=this.route.snapshot.paramMap.get("wkId");this.sMyQuery=this.route.snapshot.queryParamMap.get("query")||"",e&&(this.competition=e)}get stationFreezed(){return this.backendService.stationFreezed}set competition(e){this.syncPath(this.sMyQuery),(!this.startlist||e!==this.backendService.competition)&&(this.busy.next(!0),this.startlist={},this.backendService.getDurchgaenge(e),this.backendService.loadStartlist(void 0).subscribe(n=>{this.busy.next(!1);const i=this.tMyQueryStream.pipe((0,A.T)(s=>s?.target?.value||""),(0,T.B)(1e3),(0,k.F)(),(0,P.u)());i.subscribe(s=>{this.busy.next(!0)}),i.pipe((0,j.n)(this.runQuery(n))).subscribe(s=>{this.sFilteredStartList=s,this.busy.next(!1),this.syncPath(this.sMyQuery)}),this.startlist=n}))}get competition(){return this.backendService.competition||""}set startlist(e){this.sStartList=e,this.reloadList({target:{value:this.sMyQuery}})}get startlist(){return this.sStartList}get filteredStartList(){return this.sFilteredStartList||{programme:[]}}get isBusy(){return this.busy}syncPath(e=this.sMyQuery){e?.trim().length>0?this.router.navigate(["search-athlet",this.competition],{queryParams:{query:e},queryParamsHandling:"merge"}):this.router.navigate(["search-athlet",this.competition])}runQuery(e){return n=>{const i=n.trim();let s;return s={programme:[]},e&&e.programme.forEach(l=>{const W=this.filter(i),M=l.teilnehmer.filter(y=>W(y,l.programm));M.length>0&&(s=Object.assign({},e,{programme:[...s.programme,{programm:l.programm,teilnehmer:M}]}))}),(0,v.of)(s)}}reloadList(e){this.tMyQueryStream.next(e)}itemTapped(e,n){n.getOpenAmount().then(i=>{i>0?n.close():n.open("end")})}followAthlet(e,n){n.close(),this.navCtrl.navigateForward(`athlet-view/${this.backendService.competition}/${e.athletid}`)}followRiege(e,n){n.close(),this.backendService.getGeraete(this.backendService.competition,e.durchgang).subscribe(i=>{this.backendService.getSteps(this.backendService.competition,e.durchgang,i.find(s=>s.name===e.start).id).subscribe(s=>{this.navCtrl.navigateForward("station")})})}getCompetitions(){return this.backendService.competitions||[]}competitionName(){if(!this.backendService.competitions)return"";const e=this.backendService.competitions.filter(n=>n.uuid===this.backendService.competition).map(n=>n.titel+", am "+(n.datum+"T").split("T")[0].split("-").reverse().join("-"));return 1===e.length?(this.startlist||(this.competition=this.backendService.competition),e[0]):""}filter(e){const n=e.toUpperCase().split(" ");return(i,s)=>n.filter(l=>{if(i.athletid+""===l||i.athlet.toUpperCase().indexOf(l)>-1||i.verein.toUpperCase().indexOf(l)>-1||i.start.toUpperCase().indexOf(l)>-1||i.verein.toUpperCase().indexOf(l)>-1||i.team.toUpperCase().indexOf(l)>-1||s.indexOf(l)>-1)return!0}).length===n.length}static \u0275fac=function(n){return new(n||o)};static \u0275cmp=t.VBU({type:o,selectors:[["app-search-athlet"]],standalone:!1,decls:16,vars:4,consts:[["slidingAthletItem",""],["slot","start"],["slot","icon-only","name","menu"],["no-padding",""],["slot","end"],["placeholder","Search","showCancelButton","never",3,"ngModelChange","ionInput","ionCancel","ngModel"],["label","Wettkampf","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel"],["label","Wettkampf","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModelChange","ngModel"],[3,"value"],[3,"click","teilnehmer","programm"],["side","end"],["color","primary",3,"click"],["name","arrow-forward-circle-outline","ios","md-arrow-forward-circle-outline"],["color","secondary",3,"click"]],template:function(n,i){1&n&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",1)(3,"ion-menu-toggle")(4,"ion-button"),t.nrm(5,"ion-icon",2),t.k0s()()(),t.j41(6,"ion-title")(7,"ion-grid",3)(8,"ion-row")(9,"ion-col")(10,"ion-label"),t.EFF(11,"Suche Turner/-in"),t.k0s()(),t.nVh(12,$,3,1,"ion-col"),t.k0s()()(),t.nVh(13,B,2,1,"ion-note",4),t.k0s(),t.j41(14,"ion-searchbar",5),t.mxI("ngModelChange",function(l){return t.DH7(i.sMyQuery,l)||(i.sMyQuery=l),l}),t.bIt("ionInput",function(l){return i.reloadList(l)})("ionCancel",function(l){return i.reloadList(l)}),t.k0s()(),t.nVh(15,L,6,3,"ion-content")),2&n&&(t.R7$(12),t.vxM(i.competition?-1:12),t.R7$(),t.vxM(i.competition?13:-1),t.R7$(),t.R50("ngModel",i.sMyQuery),t.R7$(),t.vxM(i.competition&&i.startlist&&i.startlist.programme?15:-1))},dependencies:[d.BC,d.vS,r.Jm,r.QW,r.hU,r.W9,r.lO,r.eU,r.iq,r.uz,r.Dg,r.LU,r.CE,r.A7,r.he,r.nf,r.cA,r.JI,r.ln,r.S1,r.Nm,r.Ip,r.w2,r.BC,r.ai,r.Je,r.Gw,I,u.Jj,u.vh],encapsulation:2})}return o})();var U=a(5079);const X=[{path:"",component:Q}];let G=(()=>{class o{static \u0275fac=function(n){return new(n||o)};static \u0275mod=t.$C({type:o});static \u0275inj=c.G2t({imports:[u.MD,d.YN,r.bv,g.iI.forChild(X),U.h]})}return o})()}}]);