"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6547],{6547:(y,h,o)=>{o.r(h),o.d(h,{AthletViewPageModule:()=>N});var c=o(6814),p=o(95),g=o(335),a=o(3582),m=o(2181),f=o(7398),v=o(76),u=o(2565),t=o(2029),x=o(4414),w=o(9253);function T(s,l){if(1&s){const e=t.EpF();t.TgZ(0,"ion-button",6),t.NdJ("click",function(){t.CHM(e);const n=t.oxw();return t.KtG(n.share())}),t._UZ(1,"ion-icon",7),t.qZA()}}function I(s,l){if(1&s&&(t.TgZ(0,"ion-col")(1,"ion-note"),t._uU(2),t.qZA(),t.TgZ(3,"ion-label")(4,"div",8),t._uU(5),t.qZA(),t.TgZ(6,"div",9),t._uU(7),t.qZA()()()),2&s){const e=t.oxw();t.xp6(2),t.hij(" ",e.competitionName()," "),t.xp6(3),t.Oqu(e.athlet.vorname+" "+e.athlet.name),t.xp6(2),t.Oqu(e.athlet.verein)}}const d=function(s){return{"gradient-border":s}};function A(s,l){if(1&s&&(t.TgZ(0,"ion-col",11)(1,"div",12),t._UZ(2,"result-display",13),t.qZA()()),2&s){const e=l.$implicit,i=t.oxw(2);t.uIk("size-xl",i.getMaxColumnSpec()),t.xp6(1),t.Q6J("ngClass",t.VKq(5,d,i.isNew(e))),t.xp6(1),t.Q6J("item",e)("title",i.getTitle(e))("groupedBy",i.groupBy.ATHLET)}}function Z(s,l){if(1&s&&(t.TgZ(0,"ion-row"),t.YNc(1,A,3,7,"ion-col",10),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.items)}}function S(s,l){if(1&s&&(t.TgZ(0,"ion-col",15)(1,"div",12),t._UZ(2,"result-display",13),t.qZA()()),2&s){const e=l.$implicit,i=t.oxw(2);t.uIk("size-xl",i.getMaxColumnSpec()),t.xp6(1),t.Q6J("ngClass",t.VKq(5,d,i.isNew(e))),t.xp6(1),t.Q6J("item",e)("title",i.getTitle(e))("groupedBy",i.groupBy.ATHLET)}}function b(s,l){if(1&s&&(t.TgZ(0,"ion-row"),t.YNc(1,S,3,7,"ion-col",14),t.qZA()),2&s){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.items)}}let k=(()=>{class s{navCtrl;route;backendService;groupBy=u.X;items=[];lastItems=[];geraete=[];athletId;wkId;constructor(e,i,n){this.navCtrl=e,this.route=i,this.backendService=n,this.backendService.competitions||this.backendService.getCompetitions()}makeItemHash(e){return e.id*this.geraete.length*200+100*e.geraet+(e.wertung.endnote||-1)}ngOnInit(){this.athletId=parseInt(this.route.snapshot.paramMap.get("athletId")),this.wkId=this.route.snapshot.paramMap.get("wkId"),this.backendService.loadAthletWertungen(this.wkId,this.athletId).pipe((0,m.h)(i=>!!i&&i.length>0)).subscribe(i=>{this.items=i,this.sortItems(this.athletId)}),this.backendService.geraeteSubject.subscribe(i=>{this.backendService.captionmode||(this.geraete=i)}),this.backendService.newLastResults.pipe((0,m.h)(i=>!!i),(0,f.U)(i=>i.results)).subscribe(i=>{this.lastItems=this.items.map(n=>this.makeItemHash(n)),this.items=this.items.map(n=>{const r=i[n.wertung.wettkampfdisziplinId];return r&&r.id===n.id?r:n})})}sortItems(e){this.items=this.items.sort((i,n)=>{let r=i.programm.localeCompare(n.programm);return 0===r&&(r=this.geraetOrder(i.geraet)-this.geraetOrder(n.geraet)),r})}isNew(e){const i=this.makeItemHash(e);return 0===this.lastItems.filter(n=>n===i).length}get stationFreezed(){return this.backendService.stationFreezed}get competition(){return this.backendService.competition||""}getCompetitions(){return this.backendService.competitions||[]}competitionContainer(){const e={titel:"",datum:new Date,auszeichnung:void 0,auszeichnungendnote:void 0,id:void 0,uuid:void 0,programmId:0};if(!this.backendService.competitions)return e;const i=this.backendService.competitions.filter(n=>n.uuid===this.backendService.competition);return 1===i.length?i[0]:e}competitionName(){const e=this.competitionContainer();return""===e.titel?"":e.titel+", am "+(e.datum+"T").split("T")[0].split("-").reverse().join("-")}get athlet(){return this.items&&this.items.length>0?this.items[0]:{}}getColumnSpec(){return this.geraete.length}getMaxColumnSpec(){return Math.min(12,Math.max(1,Math.floor(12/this.items.length+.5)))}geraetOrder(e){return this.geraete?this.geraete.findIndex(n=>n.id===e):0}geraetText(e){if(!this.geraete)return"";const i=this.geraete.filter(n=>n.id===e).map(n=>n.name);return 1===i.length?i[0]:""}getTitle(e){return e.programm+" - "+this.geraetText(e.geraet)}isShareAvailable(){return!!navigator&&!!navigator.share}share(){let e="GeTu";const n=this.competitionContainer();""!==n.titel&&(e={1:"Athletik",11:"KuTu",20:"GeTu",31:"KuTu"}[n.programmId]);let r=`${this.items[0].vorname} ${this.items[0].name}, ${this.items[0].verein} #${e}-${n.titel.replace(","," ").split(" ").join("_")}_${this.items[0].programm} #${this.items[0].verein.replace(","," ").split(" ").join("_")}`;r=new Date(n.datum).getTime()>Date.now()?"Hoffe das Beste f\xfcr "+r:"Geschafft! Wettkampf Resultate von "+r,this.isShareAvailable()&&navigator.share({title:this.competitionName(),text:r,url:`${v.AC}athlet-view/${this.wkId}/${this.athletId}`}).then(function(){console.log("Article shared")}).catch(function(P){console.log(P.message)})}static \u0275fac=function(i){return new(i||s)(t.Y36(x.SH),t.Y36(g.gz),t.Y36(w.v))};static \u0275cmp=t.Xpm({type:s,selectors:[["app-athlet-view"]],decls:19,vars:4,consts:[["slot","start"],["defaultHref","/"],["no-padding",""],["slot","end"],["slot","end",3,"click",4,"ngIf"],[4,"ngIf"],["slot","end",3,"click"],["name","share"],[2,"font-size","16pt"],[2,"font-size","10pt"],["class","align-self-start","size-xs","12","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["size-xs","12","size-md","6","size-lg","4",1,"align-self-start"],[3,"ngClass"],[3,"item","title","groupedBy"],["class","align-self-start","size-xs","12","size-md","6","size-lg","3",4,"ngFor","ngForOf"],["size-xs","12","size-md","6","size-lg","3",1,"align-self-start"]],template:function(i,n){1&i&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),t._UZ(3,"ion-back-button",1),t.qZA(),t.TgZ(4,"ion-title")(5,"ion-grid",2)(6,"ion-row")(7,"ion-col")(8,"ion-label"),t._uU(9,"Aktuelle Resultate"),t.qZA()()()()(),t.TgZ(10,"ion-buttons",3),t.YNc(11,T,2,0,"ion-button",4),t.qZA()(),t.TgZ(12,"ion-grid",2)(13,"ion-row"),t.YNc(14,I,8,3,"ion-col",5),t.qZA()()(),t.TgZ(15,"ion-content")(16,"ion-grid",2),t.YNc(17,Z,2,1,"ion-row",5),t.YNc(18,b,2,1,"ion-row",5),t.qZA()()),2&i&&(t.xp6(11),t.Q6J("ngIf",n.isShareAvailable()),t.xp6(3),t.Q6J("ngIf",n.competition),t.xp6(3),t.Q6J("ngIf",6===n.getColumnSpec()),t.xp6(1),t.Q6J("ngIf",6!==n.getColumnSpec()))},dependencies:[c.mk,c.sg,c.O5,a.YG,a.Sm,a.wI,a.W2,a.jY,a.Gu,a.gu,a.Q$,a.uN,a.Nd,a.wd,a.sr,a.oU,u.G]})}return s})();var z=o(3573);const C=[{path:"",component:k}];let N=(()=>{class s{static \u0275fac=function(i){return new(i||s)};static \u0275mod=t.oAB({type:s});static \u0275inj=t.cJS({imports:[c.ez,p.u5,a.Pc,g.Bz.forChild(C),z.K]})}return s})()}}]);