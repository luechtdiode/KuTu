"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[7852],{7852:(Pe,b,u)=>{u.r(b),u.d(b,{LastResultsPageModule:()=>Ge});var m=u(6396),p=u(4341),F=u(9355),c=u(7125),S=u(467),I=u(1413),x=u(4412),G=u(7673),f=u(6354),j=u(5964),$=u(152),C=u(3294),P=u(7647),A=u(5558),k=u(1158),E=u(8103),e=u(7241),a=u(8564),D=u(2872),L=u(2350),R=u(8325);function y(i,r){1&i&&(e.j41(0,"ion-avatar",4),e.nrm(1,"img",5),e.k0s())}function M(i,r){1&i&&(e.j41(0,"ion-avatar",4),e.nrm(1,"img",6),e.k0s())}function N(i,r){if(1&i&&(e.j41(0,"li")(1,"small")(2,"em"),e.EFF(3),e.k0s()()()),2&i){const t=r.$implicit;e.R7$(3),e.JRh(t)}}function X(i,r){if(1&i&&(e.j41(0,"ion-label"),e.EFF(1),e.nrm(2,"br"),e.EFF(3," \xa0\xa0\xa0\xa0\xa0\xa0"),e.j41(4,"small")(5,"em"),e.EFF(6),e.k0s()(),e.nrm(7,"br"),e.j41(8,"ul"),e.DNE(9,N,4,1,"li",7),e.k0s()()),2&i){const t=e.XpG();e.R7$(),e.Lme("",t.teilnehmer.Rang,". ",t.teilnehmer["Team/Athlet"]),e.R7$(5),e.JRh(t.teilnehmerSubResults),e.R7$(3),e.Y8G("ngForOf",t.teamTeilnehmerSubResults)}}function O(i,r){if(1&i&&(e.j41(0,"ion-label"),e.EFF(1),e.j41(2,"small"),e.EFF(3),e.k0s(),e.nrm(4,"br"),e.EFF(5," \xa0\xa0\xa0\xa0\xa0\xa0"),e.j41(6,"small")(7,"em"),e.EFF(8),e.k0s()()()),2&i){const t=e.XpG();e.R7$(),e.E5c("",t.teilnehmer.Rang,". ",t.teilnehmer.Athlet," (",t.teilnehmer.Jahrgang,")\xa0"),e.R7$(2),e.SpI(" - ",t.teilnehmer.Verein),e.R7$(5),e.JRh(t.teilnehmerSubResults)}}function Y(i,r){if(1&i&&(e.j41(0,"em"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.SpI("\xf8 Ger\xe4t ",t.teilnehmer["\xf8 Ger\xe4t"])}}function B(i,r){if(1&i&&(e.j41(0,"em"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Lme("Total D/E ",t.teilnehmer["Total D"],"/",t.teilnehmer["Total E"])}}function V(i,r){if(1&i&&(e.j41(0,"em"),e.EFF(1),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Lme("Total A/B ",t.teilnehmer["Total A"],"/",t.teilnehmer["Total B"])}}let U=(()=>{class i{teilnehmerSubResults="";teamTeilnehmerSubResults=[];teilnehmer;selected;constructor(){}ngOnInit(){this.teilnehmerSubResults=v(this.teilnehmer),this.teamTeilnehmerSubResults=0==this.teilnehmer.rows?.length?[]:this.teilnehmer.rows.map(H)}static \u0275fac=function(s){return new(s||i)};static \u0275cmp=e.VBU({type:i,selectors:[["scorelist-item"]],inputs:{teilnehmer:"teilnehmer"},outputs:{selected:"selected"},standalone:!1,decls:12,vars:8,consts:[[3,"click"],["slot","start",4,"ngIf"],[4,"ngIf"],["slot","end"],["slot","start"],["src","assets/imgs/athlete.png"],["src","assets/imgs/verein.png"],[4,"ngFor","ngForOf"]],template:function(s,n){1&s&&(e.j41(0,"ion-item",0),e.bIt("click",function(){return n.selected?n.selected.emit(n.teilnehmer):{}}),e.DNE(1,y,2,0,"ion-avatar",1)(2,M,2,0,"ion-avatar",1)(3,X,10,4,"ion-label",2)(4,O,9,5,"ion-label",2),e.j41(5,"ion-note",3)(6,"b"),e.EFF(7),e.k0s(),e.nrm(8,"br"),e.DNE(9,Y,2,1,"em",2)(10,B,2,2,"em",2)(11,V,2,2,"em",2),e.k0s()()),2&s&&(e.R7$(),e.Y8G("ngIf",n.teilnehmer.Athlet),e.R7$(),e.Y8G("ngIf",n.teamTeilnehmerSubResults.length>0),e.R7$(),e.Y8G("ngIf",n.teamTeilnehmerSubResults.length>0),e.R7$(),e.Y8G("ngIf",n.teilnehmer.Athlet),e.R7$(3),e.SpI("Total Punkte ",n.teilnehmer["Total Punkte"]),e.R7$(2),e.Y8G("ngIf",n.teilnehmer["\xf8 Ger\xe4t"]),e.R7$(),e.Y8G("ngIf",n.teilnehmer["Total D"]),e.R7$(),e.Y8G("ngIf",n.teilnehmer["Total A"]))},dependencies:[m.Sq,m.bT,c.mC,c.uz,c.he,c.JI],styles:["ion-note[_ngcontent-%COMP%]{text-align:end}"]})}return i})();const w=["athletID","rows","Rang","Athlet","Team","Team/Athlet","Jahrgang","Verein","K","\xf8 Ger\xe4t","Total D","Total E","Total A","Total B","Total Punkte"];function H(i){return`${i.Team} (${i.K}): ${v(i)}`}function v(i){return Object.keys(i).map(r=>`${r}`).filter(r=>w.indexOf(r)<0&&i[r].Endnote).map(r=>`${r}: ${function z(i){let r="",t="";return i["Endnote-styles"].indexOf("best")>=0&&(r="*"),i["Endnote-styles"].indexOf("stroke")>=0&&(t="!"),`${r}${i["Endnote-raw"].trim()}${t}`}(i[r])} (${i[r].Rang.trim()})`).join(", ")}const W=i=>({"gradient-border":i});function J(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-buttons")(1,"ion-button",9),e.bIt("click",function(){a.eBV(t);const n=e.XpG(2);return a.Njj(n.toggleOptions())}),e.nrm(2,"ion-icon",10),e.k0s()()}}function K(i,r){if(1&i&&(e.j41(0,"ion-note",11),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.competitionName()," ")}}function Q(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-searchbar",12),e.mxI("ngModelChange",function(n){a.eBV(t);const o=e.XpG(2);return e.DH7(o.sMyQuery,n)||(o.sMyQuery=n),a.Njj(n)}),e.bIt("ionInput",function(n){a.eBV(t);const o=e.XpG(2);return a.Njj(o.reloadList(n))})("ionCancel",function(n){a.eBV(t);const o=e.XpG(2);return a.Njj(o.reloadList(n))}),e.k0s()}if(2&i){const t=e.XpG(2);e.R50("ngModel",t.sMyQuery)}}function q(i,r){if(1&i&&(e.j41(0,"ion-select-option",20),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&i){const t=r.$implicit;e.Y8G("value",t.uuid),e.R7$(),e.SpI(" ",t.titel+" "+e.i5U(2,2,t.datum,"dd-MM-yy"))}}function Z(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-select",18),e.mxI("ngModelChange",function(n){a.eBV(t);const o=e.XpG(3);return e.DH7(o.competition,n)||(o.competition=n),a.Njj(n)}),e.DNE(1,q,3,5,"ion-select-option",19),e.k0s()}if(2&i){const t=e.XpG(3);e.R50("ngModel",t.competition),e.R7$(),e.Y8G("ngForOf",t.getCompetitions())}}function ee(i,r){if(1&i&&(e.j41(0,"em"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI("(atkiv) ",t)}}function te(i,r){if(1&i&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI("(inaktiv) ",t)}}function ie(i,r){if(1&i&&(e.j41(0,"ion-select-option",20),e.DNE(1,ee,2,1,"em",1)(2,te,2,1,"div",1),e.k0s()),2&i){const t=r.$implicit,s=e.XpG(4);e.Y8G("value",t),e.R7$(),e.Y8G("ngIf",s.isDurchgangActiv(t)),e.R7$(),e.Y8G("ngIf",!s.isDurchgangActiv(t))}}function ne(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-select",21),e.mxI("ngModelChange",function(n){a.eBV(t);const o=e.XpG(3);return e.DH7(o.durchgangFilter,n)||(o.durchgangFilter=n),a.Njj(n)}),e.j41(1,"ion-select-option",22),e.EFF(2,"Kein Durchgangfilter"),e.k0s(),e.DNE(3,ie,3,3,"ion-select-option",19),e.k0s()}if(2&i){const t=e.XpG(3);e.R50("ngModel",t.durchgangFilter),e.R7$(3),e.Y8G("ngForOf",t.getDurchgaenge())}}function se(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-list")(1,"ion-item"),e.DNE(2,Z,2,2,"ion-select",13),e.k0s(),e.j41(3,"ion-item"),e.DNE(4,ne,4,2,"ion-select",14),e.k0s(),e.j41(5,"ion-item")(6,"ion-select",15),e.mxI("ngModelChange",function(n){a.eBV(t);const o=e.XpG(2);return e.DH7(o.kategorieFilter,n)||(o.kategorieFilter=n),a.Njj(n)}),e.j41(7,"ion-select-option",16),e.EFF(8,"Kategorien getrennt"),e.k0s(),e.j41(9,"ion-select-option",17),e.EFF(10,"Kategorien gemischt"),e.k0s()()(),e.j41(11,"ion-item")(12,"ion-label"),e.EFF(13),e.k0s(),e.j41(14,"ion-button",9),e.bIt("click",function(){a.eBV(t);const n=e.XpG(2);return a.Njj(n.toggleHeader())}),e.EFF(15,"Umschalten"),e.k0s()()()}if(2&i){const t=e.XpG(2);e.R7$(2),e.Y8G("ngIf",t.getCompetitions().length>0),e.R7$(2),e.Y8G("ngIf",t.getDurchgaenge()&&t.getDurchgaenge().length>0),e.R7$(2),e.R50("ngModel",t.kategorieFilter),e.R7$(7),e.SpI("doppel-click wechselt die Position des Toolbars (",t.nextToolbarPosition,")")}}function oe(i,r){if(1&i&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",4)(3,"ion-menu-toggle")(4,"ion-button"),e.nrm(5,"ion-icon",5),e.k0s()(),e.DNE(6,J,3,0,"ion-buttons",1),e.k0s(),e.j41(7,"ion-title")(8,"ion-grid",6)(9,"ion-row")(10,"ion-col")(11,"ion-label"),e.EFF(12),e.k0s()()()()(),e.DNE(13,K,2,1,"ion-note",7),e.k0s(),e.DNE(14,Q,1,1,"ion-searchbar",8)(15,se,16,4,"ion-list",1),e.k0s()),2&i){const t=e.XpG();e.R7$(6),e.Y8G("ngIf",!t.scorelistAvailable()),e.R7$(6),e.JRh(t.title),e.R7$(),e.Y8G("ngIf",t.competition),e.R7$(),e.Y8G("ngIf",t.scorelistAvailable()),e.R7$(),e.Y8G("ngIf",t.optionsVisible&&t.isToolbarTop())}}function re(i,r){if(1&i&&(e.j41(0,"ion-col",25)(1,"div",26),e.nrm(2,"result-display",27),e.k0s()()),2&i){const t=r.$implicit,s=e.XpG(3);e.BMQ("size-xs",s.getColumnSpecs()[0])("size-sm",s.getColumnSpecs()[0])("size-md",s.getColumnSpecs()[2])("size-lg",s.getColumnSpecs()[3])("size-xl",s.getMaxColumnSpec()),e.R7$(),e.Y8G("ngClass",e.eq3(9,W,s.isNew(t))),e.R7$(),e.Y8G("item",t)("title",s.getTitle(t))("groupedBy",s.groupBy.PROGRAMM)}}function le(i,r){if(1&i&&(e.j41(0,"ion-row"),e.DNE(1,re,3,11,"ion-col",24),e.k0s()),2&i){const t=r.$implicit,s=e.XpG(2);e.R7$(),e.Y8G("ngForOf",s.getWertungen(t))}}function ae(i,r){if(1&i&&(e.j41(0,"ion-grid",6),e.DNE(1,le,2,1,"ion-row",23),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.getProgramme())}}function ce(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-item-option",31),e.bIt("click",function(){a.eBV(t);const n=e.XpG().$implicit,o=e.sdS(1),l=e.XpG(3);return a.Njj(l.followAthlet(n,o))}),e.nrm(1,"ion-icon",32),e.EFF(2),e.k0s()}if(2&i){const t=e.XpG().$implicit;e.R7$(2),e.SpI(" Detail-Wertungen ",t.Athlet," ")}}function ue(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-item-sliding",null,0)(2,"scorelist-item",28),e.bIt("click",function(){const n=a.eBV(t).$implicit,o=e.sdS(1),l=e.XpG(3);return a.Njj(l.scoreItemTapped(n,o))}),e.k0s(),e.j41(3,"ion-item-options",29),e.DNE(4,ce,3,1,"ion-item-option",30),e.k0s()()}if(2&i){const t=r.$implicit;e.R7$(2),e.Y8G("teilnehmer",t),e.R7$(2),e.Y8G("ngIf",t.athletID)}}function _e(i,r){if(1&i&&(e.j41(0,"div")(1,"ion-item-divider"),e.EFF(2),e.k0s(),e.DNE(3,ue,5,2,"ion-item-sliding",23),e.k0s()),2&i){const t=r.$implicit;e.R7$(2),e.JRh(t.title.text),e.R7$(),e.Y8G("ngForOf",t.rows)}}function ge(i,r){if(1&i&&(e.j41(0,"ion-list"),e.DNE(1,_e,4,2,"div",23),e.k0s()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.filteredScoreList)}}function me(i,r){if(1&i&&(e.j41(0,"ion-select-option",20),e.EFF(1),e.nI1(2,"date"),e.k0s()),2&i){const t=r.$implicit;e.Y8G("value",t.uuid),e.R7$(),e.SpI(" ",t.titel+" "+e.i5U(2,2,t.datum,"dd-MM-yy"))}}function he(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-select",18),e.mxI("ngModelChange",function(n){a.eBV(t);const o=e.XpG(3);return e.DH7(o.competition,n)||(o.competition=n),a.Njj(n)}),e.DNE(1,me,3,5,"ion-select-option",19),e.k0s()}if(2&i){const t=e.XpG(3);e.R50("ngModel",t.competition),e.R7$(),e.Y8G("ngForOf",t.getCompetitions())}}function de(i,r){if(1&i&&(e.j41(0,"em"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI("(atkiv) ",t)}}function pe(i,r){if(1&i&&(e.j41(0,"div"),e.EFF(1),e.k0s()),2&i){const t=e.XpG().$implicit;e.R7$(),e.SpI("(inaktiv) ",t)}}function fe(i,r){if(1&i&&(e.j41(0,"ion-select-option",20),e.DNE(1,de,2,1,"em",1)(2,pe,2,1,"div",1),e.k0s()),2&i){const t=r.$implicit,s=e.XpG(4);e.Y8G("value",t),e.R7$(),e.Y8G("ngIf",s.isDurchgangActiv(t)),e.R7$(),e.Y8G("ngIf",!s.isDurchgangActiv(t))}}function be(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-select",21),e.mxI("ngModelChange",function(n){a.eBV(t);const o=e.XpG(3);return e.DH7(o.durchgangFilter,n)||(o.durchgangFilter=n),a.Njj(n)}),e.j41(1,"ion-select-option",22),e.EFF(2,"Kein Durchgangfilter"),e.k0s(),e.DNE(3,fe,3,3,"ion-select-option",19),e.k0s()}if(2&i){const t=e.XpG(3);e.R50("ngModel",t.durchgangFilter),e.R7$(3),e.Y8G("ngForOf",t.getDurchgaenge())}}function ke(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-list")(1,"ion-item"),e.DNE(2,he,2,2,"ion-select",13),e.k0s(),e.j41(3,"ion-item"),e.DNE(4,be,4,2,"ion-select",14),e.k0s(),e.j41(5,"ion-item")(6,"ion-select",15),e.mxI("ngModelChange",function(n){a.eBV(t);const o=e.XpG(2);return e.DH7(o.kategorieFilter,n)||(o.kategorieFilter=n),a.Njj(n)}),e.j41(7,"ion-select-option",16),e.EFF(8,"Kategorien getrennt"),e.k0s(),e.j41(9,"ion-select-option",17),e.EFF(10,"Kategorien gemischt"),e.k0s()()(),e.j41(11,"ion-item")(12,"ion-label"),e.EFF(13),e.k0s(),e.j41(14,"ion-button",9),e.bIt("click",function(){a.eBV(t);const n=e.XpG(2);return a.Njj(n.toggleHeader())}),e.EFF(15,"Umschalten"),e.k0s()()()}if(2&i){const t=e.XpG(2);e.R7$(2),e.Y8G("ngIf",t.getCompetitions().length>0),e.R7$(2),e.Y8G("ngIf",t.getDurchgaenge()&&t.getDurchgaenge().length>0),e.R7$(2),e.R50("ngModel",t.kategorieFilter),e.R7$(7),e.SpI("doppel-click wechselt die Position des Toolbars (",t.nextToolbarPosition,")")}}function Re(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-buttons")(1,"ion-button",9),e.bIt("click",function(){a.eBV(t);const n=e.XpG(2);return a.Njj(n.toggleOptions())}),e.nrm(2,"ion-icon",10),e.k0s()()}}function ve(i,r){if(1&i&&(e.j41(0,"ion-note",11),e.EFF(1),e.k0s()),2&i){const t=e.XpG(2);e.R7$(),e.SpI(" ",t.competitionName()," ")}}function Te(i,r){if(1&i&&(e.j41(0,"ion-footer"),e.DNE(1,ke,16,4,"ion-list",1),e.j41(2,"ion-toolbar")(3,"ion-buttons",4)(4,"ion-menu-toggle")(5,"ion-button"),e.nrm(6,"ion-icon",5),e.k0s()(),e.DNE(7,Re,3,0,"ion-buttons",1),e.k0s(),e.j41(8,"ion-title")(9,"ion-grid",6)(10,"ion-row")(11,"ion-col")(12,"ion-label"),e.EFF(13),e.k0s()()()()(),e.DNE(14,ve,2,1,"ion-note",7),e.k0s()()),2&i){const t=e.XpG();e.R7$(),e.Y8G("ngIf",t.optionsVisible),e.R7$(6),e.Y8G("ngIf",!t.scorelistAvailable()),e.R7$(6),e.JRh(t.title),e.R7$(),e.Y8G("ngIf",t.competition)}}function Fe(i,r){if(1&i){const t=e.RV6();e.j41(0,"ion-footer")(1,"ion-toolbar")(2,"ion-button",33),e.bIt("click",function(){a.eBV(t);const n=e.XpG();return a.Njj(n.presentActionSheet())}),e.nrm(3,"ion-icon",34),e.k0s()()()}}let Se=(()=>{class i{navCtrl;backendService;route;router;actionSheetController;groupBy=k.R;items=[];mixeditems=[];lastItems;geraete=[];scorelinks=[];defaultPath=void 0;scoreblocks=[];sFilteredScoreList=[];sMyQuery;tMyQueryStream=new I.B;sFilterTask=void 0;busy=new x.t(!1);durchgangopen;subscriptions=[];constructor(t,s,n,o,l){this.navCtrl=t,this.backendService=s,this.route=n,this.router=o,this.actionSheetController=l,this.backendService.competitions||this.backendService.getCompetitions(),this.backendService.durchgangStarted.pipe((0,f.T)(_=>_.filter(g=>g.wettkampfUUID===this.backendService.competition).length>0)).subscribe(_=>{this.durchgangopen=_})}ngOnDestroy(){this.subscriptions.forEach(t=>t.unsubscribe())}ngOnInit(){this.competition=this.route.snapshot.queryParamMap.get("c")||this.backendService.competition,this.kategorieFilter=this.route.snapshot.queryParamMap.get("k")||"getrennt",this.durchgangFilter=this.route.snapshot.queryParamMap.get("d")||"undefined",this.subscriptions.push(this.backendService.competitionSubject.subscribe(t=>{this.subscriptions.push(this.backendService.newLastResults.subscribe(s=>{if(this.lastItems=this.items.map(n=>n.id*this.geraete.length+n.geraet),this.items=[],this.mixeditems=[],s&&s.resultsPerWkDisz){const n=Object.values(s.resultsPerWkDisz).map(l=>l.programm).filter(this.onlyUnique);(n.length>0?n:["\xa0"]).forEach(l=>{this.geraete.map(_=>Object.values(s.resultsPerWkDisz).find(g=>g.geraet===_.id&&g.wertung.endnote&&("\xa0"===l||g.programm===l))||{programm:l,geraet:_.id,id:0,vorname:"\xa0",name:"\xa0",geschlecht:void 0,verein:"\xa0",wertung:{noteE:0,noteD:0,endnote:0,wettkampfdisziplinId:0},isDNoteUsed:!0}).forEach(_=>{this.items.push(_)})}),this.mixeditems=this.geraete.map(l=>s.resultsPerDisz[l.id]??{programm:"\xa0",geraet:l.id,id:0,vorname:"\xa0",name:"\xa0",geschlecht:void 0,verein:"\xa0",wertung:{noteE:0,noteD:0,endnote:0,wettkampfdisziplinId:0},isDNoteUsed:!(this.items.length>0)||this.items[0].isDNoteUsed})}this.sortItems(),this.scorelistAvailable()?this.backendService.getScoreLists().subscribe(n=>{const o=this.competitionContainer();let l="";o.altersklassen&&o.altersklassen.trim().length>0?l=":Wettkampf%20Altersklassen":o.jahrgangsklassen&&o.jahrgangsklassen.trim().length>0&&(l=":Wettkampf%20JG-Altersklassen");const _=`/api/scores/${o.uuid}/query?groupby=Kategorie${l}:Geschlecht`;if(n){const h=Object.values(n).filter(d=>"Zwischenresultate"!=d.name).sort((d,Ce)=>d.name.localeCompare(Ce.name)),T={name:"Generische Rangliste",published:!0,"published-date":"","scores-href":_,"scores-query":_},je={name:"Generische Team-Rangliste",published:!0,"published-date":"","scores-href":`/api/scores/${o.uuid}/query?kind=Teamrangliste`,"scores-query":`/api/scores/${o.uuid}/query?kind=Teamrangliste`};this.scorelinks=this.teamsAllowed(o)?[...h,je,T]:[...h,T];const $e=this.scorelinks.filter(d=>""+d.published=="true");this.refreshScoreList($e[0])}}):this.title="Aktuelle Resultate"}))}))}_optionsVisible=!1;get optionsVisible(){return this._optionsVisible||!this.competition}set optionsVisible(t){this._optionsVisible=t}toggleOptions(){this._optionsVisible=!this._optionsVisible}teamsAllowed(t){return t.teamrule?.trim().length>0&&"Keine Teams"!==t.teamrule}_title="Aktuelle Resultate";get title(){return this._title}set title(t){this._title=t}refreshScoreList(t){let s=t["scores-href"];t.published||(s=t["scores-query"]),s.startsWith("/")&&(s=s.substring(1)),s=s.replace("html",""),this.title=t.name,this.defaultPath=s,this.backendService.getScoreList(this.defaultPath).pipe((0,f.T)(n=>n.title&&n.scoreblocks?n.scoreblocks:[])).subscribe(n=>{this.scoreblocks=n,this.sFilteredScoreList=n;const o=this.tMyQueryStream.pipe((0,j.p)(l=>!!l&&!!l.target&&!!l.target.value),(0,f.T)(l=>l.target.value),(0,$.B)(1e3),(0,C.F)(),(0,P.u)());o.subscribe(()=>{this.busy.next(!0)}),o.pipe((0,A.n)(this.runQuery(n))).subscribe(l=>{this.sFilteredScoreList=l,this.busy.next(!1)})})}sortItems(){const t=(s,n)=>{let o=s.programm.localeCompare(n.programm);return 0===o&&(o=this.geraetOrder(s.geraet)-this.geraetOrder(n.geraet)),o};this.items=this.items.sort(t),this.mixeditems=this.mixeditems.sort(t)}isNew(t){return 0===this.lastItems.filter(s=>s===t.id*this.geraete.length+t.geraet).length}get stationFreezed(){return this.backendService.stationFreezed}set competition(t){this.stationFreezed||(this.backendService.getDurchgaenge(t),this.router.navigate(["last-results"],{queryParams:{c:this.competition,k:this._kategorieFilter,d:this.backendService.durchgang},queryParamsHandling:"merge"}))}get competition(){return this.backendService.competition||""}getCompetitions(){return this.backendService.competitions||[]}competitionContainer(){const t={titel:"",datum:new Date,auszeichnung:void 0,auszeichnungendnote:void 0,id:void 0,uuid:void 0,programmId:0,teamrule:""};if(!this.backendService.competitions)return t;const s=this.backendService.competitions.filter(n=>n.uuid===this.backendService.competition);return 1===s.length?s[0]:t}competitionName(){const t=this.competitionContainer();return""===t.titel?"":t.titel+", am "+(t.datum+"T").split("T")[0].split("-").reverse().join("-")}geraetOrder(t){return this.geraete?this.geraete.findIndex(s=>s.id===t):0}geraetText(t){if(!this.geraete)return"";const s=this.geraete.filter(n=>n.id===t).map(n=>n.name);return 1===s.length?s[0]:""}getColumnSpec(){return this.geraete?.length||0}getColumnSpecs(){return 6===this.getColumnSpec()?[12,12,6,3,this.getMaxColumnSpec()]:[12,6,4,3,this.getMaxColumnSpec()]}getMaxColumnSpec(){return Math.min(12,Math.max(1,Math.floor(12/this.geraete.length+.5)))}getTitle(t){return t.programm+" - "+this.geraetText(t.geraet)}onlyUnique(t,s,n){return n.indexOf(t)===s}getProgramme(){return"getrennt"===this.kategorieFilter?this.items.map(t=>t.programm).filter(this.onlyUnique):[this.mixeditems.map(t=>t.programm)[0]]}getWertungen(t){return"getrennt"===this.kategorieFilter?this.items.filter(s=>s.programm===t):this.getMixedWertungen()}getMixedWertungen(){return this.mixeditems}_durchgang=void 0;getDurchgaenge(){return[...this.backendService.activeDurchgangList.map(t=>t.durchgang),...this.backendService.durchgaenge.filter(t=>!this.isDurchgangActiv(t))]}isDurchgangActiv(t){return void 0!==this.backendService.activeDurchgangList.find(s=>s.durchgang===t)}set durchgangFilter(t){"undefined"===t?(console.log("navigate to durchgang "+t),this.router.navigate(["last-results"],{queryParams:{c:this.competition,k:this._kategorieFilter,d:void 0},queryParamsHandling:"merge"}),this.backendService.getGeraete(this.backendService.competition,void 0).subscribe(s=>{this.geraete=s??[],this.sortItems()}),this.backendService.disconnectWS(!0),this.backendService.initWebsocket(),this._durchgang=void 0):(console.log("navigate to durchgang defined: "+t),this.router.navigate(["last-results"],{queryParams:{c:this.competition,k:this._kategorieFilter,d:t},queryParamsHandling:"merge"}),this.backendService.getGeraete(this.backendService.competition,t).subscribe(s=>{this.geraete=s??[],this.sortItems()}),this.backendService.disconnectWS(!0),this.backendService.initWebsocket(),this._durchgang=t)}get durchgangFilter(){return this._durchgang||"undefined"}hideHeader=0;toggleHeader(){this.scorelistAvailable()||(this.hideHeader=this.hideHeader+=1,this.hideHeader>2&&(this.hideHeader=0))}get nextToolbarPosition(){return 0===this.hideHeader?"von oben nach unten, und dann auf ausgeblendet":1===this.hideHeader?"von unten nach ausgeblendet":"oben"}isToolbarTop(){return 0===this.hideHeader||this.scorelistAvailable()}isToolbarBottom(){return 1===this.hideHeader}isFullscreen(){return 2===this.hideHeader}_kategorieFilter="getrennt";set kategorieFilter(t){this._kategorieFilter=t,this._kategorieFilter?.trim().length>0?this.router.navigate(["last-results"],{queryParams:{c:this.competition,k:t,d:this.backendService.durchgang},queryParamsHandling:"merge"}):this.router.navigate(["last-results"],{queryParams:{c:this.competition,d:this.backendService.durchgang},queryParamsHandling:"merge"})}get kategorieFilter(){return this._kategorieFilter}scorelistAvailable(){return!this.durchgangopen&&new Date(this.competitionContainer().datum).getTime()<new Date(Date.now()-864e5).getTime()}get filteredScoreList(){return this.sFilteredScoreList&&this.sFilteredScoreList.length>0?this.sFilteredScoreList:this.getScoreListItems()}get isBusy(){return this.busy}runQuery(t){return s=>{const n=s.trim();let o=[];return n&&t&&t.forEach(l=>{const _=this.filter(n),g=l.rows.filter(h=>_(h,l));if(g.length>0){const h={title:l.title,rows:g};o=[...o,h]}}),(0,G.of)(o)}}filter(t){const s=t.toUpperCase(),n=s.split(" ");return(o,l)=>l.title.text.toUpperCase().indexOf(s)>-1||n.filter(_=>[o,...o.rows].find(g=>{if(g.Athlet?.toUpperCase().indexOf(_)>-1||g["Team/Athlet"]?.toUpperCase().indexOf(_)>-1||g.Team?.toUpperCase().indexOf(_)>-1||g.Verein?.toUpperCase().indexOf(_)>-1||g.Jahrgang?.toUpperCase()===_||l.title.text.toUpperCase().replace("."," ").replace(","," ").split(" ").indexOf(_)>-1)return!0})).length===n.length}reloadList(t){this.tMyQueryStream.next(t)}makeGenericScoreListLink(){return`${E.EV}${this.defaultPath}&html`}getScoreListItems(){return this.scoreblocks}scoreItemTapped(t,s){s.getOpenAmount().then(n=>{n>0?s.close():s.open("end")})}followAthlet(t,s){s.close(),t.athletID&&this.navCtrl.navigateForward(`athlet-view/${this.backendService.competition}/${t.athletID}`)}open(){window.open(this.makeGenericScoreListLink(),"_blank")}isShareAvailable(){return!!navigator&&!!navigator.share}share(){let t="GeTu";const n=this.competitionContainer();""!==n.titel&&(t={1:"Athletik",11:"KuTu",20:"GeTu",31:"KuTu"}[n.programmId]);let o=`${this.competitionName()} #${t}-${n.titel.replace(","," ").split(" ").join("_")}`;this.isShareAvailable()&&navigator.share({title:`${t} Rangliste`,text:o,url:this.makeGenericScoreListLink()}).then(function(){console.log("Article shared")}).catch(function(l){console.log(l.message)})}presentActionSheet(){var t=this;return(0,S.A)(function*(){let s=[...t.scorelinks.map(l=>""+l.published=="true"?{text:`${l.name} anzeigen ...`,icon:"document",handler:()=>{t.refreshScoreList(l)}}:{text:`${l.name} (unver\xf6ffentlicht)`,icon:"today-outline",handler:()=>{t.refreshScoreList(l)}}),{text:"Rangliste \xf6ffnen ...",icon:"open",handler:()=>{t.open()}}];t.isShareAvailable()&&(s=[...s,{text:"Teilen / Share ...",icon:"share",handler:()=>{t.share()}}]);let n={header:"Aktionen",cssClass:"my-actionsheet-class",buttons:s};yield(yield t.actionSheetController.create(n)).present()})()}static \u0275fac=function(s){return new(s||i)(e.rXU(D.q9),e.rXU(L.m),e.rXU(R.nX),e.rXU(R.Ix),e.rXU(c.GD))};static \u0275cmp=e.VBU({type:i,selectors:[["app-last-results"]],standalone:!1,decls:6,vars:5,consts:[["slidingAthletScoreItem",""],[4,"ngIf"],[3,"dblclick","click"],["no-padding","",4,"ngIf"],["slot","start"],["slot","icon-only","name","menu"],["no-padding",""],["slot","end",4,"ngIf"],["placeholder","Search","showCancelButton","never",3,"ngModel","ngModelChange","ionInput","ionCancel",4,"ngIf"],[3,"click"],["slot","icon-only","name","options"],["slot","end"],["placeholder","Search","showCancelButton","never",3,"ngModelChange","ionInput","ionCancel","ngModel"],["label","Wettkampf","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange",4,"ngIf"],["label","Durchgang","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange",4,"ngIf"],["label","Kategorien","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModelChange","ngModel"],["value","getrennt"],["value","gemischt"],["label","Wettkampf","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModelChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["label","Durchgang","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModelChange","ngModel"],["value","undefined"],[4,"ngFor","ngForOf"],["class","align-self-start",4,"ngFor","ngForOf"],[1,"align-self-start"],[3,"ngClass"],[3,"item","title","groupedBy"],[3,"click","teilnehmer"],["side","end"],["color","primary",3,"click",4,"ngIf"],["color","primary",3,"click"],["name","arrow-forward-circle-outline","ios","md-arrow-forward-circle-outline"],["size","large","expand","block","color","primary",3,"click"],["slot","start","name","list"]],template:function(s,n){1&s&&(e.DNE(0,oe,16,5,"ion-header",1),e.j41(1,"ion-content",2),e.bIt("dblclick",function(){return n.toggleHeader()})("click",function(){return n.optionsVisible=!1}),e.DNE(2,ae,2,1,"ion-grid",3)(3,ge,2,1,"ion-list",1),e.k0s(),e.DNE(4,Te,15,4,"ion-footer",1)(5,Fe,4,0,"ion-footer",1)),2&s&&(e.Y8G("ngIf",n.isToolbarTop()),e.R7$(2),e.Y8G("ngIf",!n.scorelistAvailable()),e.R7$(),e.Y8G("ngIf",n.scorelistAvailable()),e.R7$(),e.Y8G("ngIf",!n.scorelistAvailable()&&n.isToolbarBottom()),e.R7$(),e.Y8G("ngIf",n.scorelistAvailable()))},dependencies:[m.YU,m.Sq,m.bT,p.BC,p.vS,c.Jm,c.QW,c.hU,c.W9,c.M0,c.lO,c.eU,c.iq,c.uz,c.Dg,c.LU,c.CE,c.A7,c.he,c.nf,c.cA,c.JI,c.ln,c.S1,c.Nm,c.Ip,c.BC,c.ai,c.Je,c.Gw,k.v,U,m.vh],encapsulation:2})}return i})();var Ie=u(5079);const xe=[{path:"",component:Se}];let Ge=(()=>{class i{static \u0275fac=function(s){return new(s||i)};static \u0275mod=e.$C({type:i});static \u0275inj=a.G2t({imports:[m.MD,p.YN,c.bv,F.iI.forChild(xe),Ie.h]})}return i})()}}]);