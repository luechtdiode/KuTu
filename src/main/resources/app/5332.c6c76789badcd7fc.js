"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5332],{5332:(y,p,a)=>{a.r(p),a.d(p,{LastTopResultsPageModule:()=>I});var l=a(6895),g=a(433),d=a(5472),s=a(502),h=a(9300),u=a(2997),t=a(8274),f=a(600);function _(o,n){if(1&o&&(t.TgZ(0,"ion-select-option",9),t._uU(1),t.ALo(2,"date"),t.qZA()),2&o){const e=n.$implicit;t.Q6J("value",e.uuid),t.xp6(1),t.hij(" ",e.titel+" "+t.xi3(2,2,e.datum,"dd-MM-yy"),"")}}function T(o,n){if(1&o){const e=t.EpF();t.TgZ(0,"ion-select",7),t.NdJ("ngModelChange",function(r){t.CHM(e);const c=t.oxw(2);return t.KtG(c.competition=r)}),t.YNc(1,_,3,5,"ion-select-option",8),t.qZA()}if(2&o){const e=t.oxw(2);t.Q6J("ngModel",e.competition),t.xp6(1),t.Q6J("ngForOf",e.getCompetitions())}}function x(o,n){if(1&o&&(t.TgZ(0,"ion-col")(1,"ion-item")(2,"ion-label"),t._uU(3,"Wettkampf"),t.qZA(),t.YNc(4,T,2,2,"ion-select",6),t.qZA()()),2&o){const e=t.oxw();t.xp6(4),t.Q6J("ngIf",e.getCompetitions().length>0)}}function v(o,n){if(1&o&&(t.TgZ(0,"ion-note",10),t._uU(1),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.hij(" ",e.competitionName()," ")}}function Z(o,n){if(1&o&&(t.TgZ(0,"ion-col",13),t._UZ(1,"result-display",14),t.qZA()),2&o){const e=n.$implicit,i=t.oxw(3);t.uIk("size-xl",i.getMaxColumnSpec()),t.xp6(1),t.Q6J("item",e)("title",i.getTitle(e))("groupedBy",i.groupBy.PROGRAMM)}}function b(o,n){if(1&o&&(t.TgZ(0,"ion-row"),t.YNc(1,Z,2,4,"ion-col",12),t.qZA()),2&o){const e=n.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",i.getWertungen(e))}}function R(o,n){if(1&o&&(t.TgZ(0,"ion-grid",2),t.YNc(1,b,2,1,"ion-row",11),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.getProgramme())}}function w(o,n){if(1&o&&(t.TgZ(0,"ion-col",16),t._UZ(1,"result-display",14),t.qZA()),2&o){const e=n.$implicit,i=t.oxw(3);t.uIk("size-xl",i.getMaxColumnSpec()),t.xp6(1),t.Q6J("item",e)("title",i.getTitle(e))("groupedBy",i.groupBy.PROGRAMM)}}function M(o,n){if(1&o&&(t.TgZ(0,"ion-row"),t.YNc(1,w,2,4,"ion-col",15),t.qZA()),2&o){const e=n.$implicit,i=t.oxw(2);t.xp6(1),t.Q6J("ngForOf",i.getWertungen(e))}}function z(o,n){if(1&o&&(t.TgZ(0,"ion-grid",2),t.YNc(1,M,2,1,"ion-row",11),t.qZA()),2&o){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.getProgramme())}}let P=(()=>{class o{constructor(e){this.backendService=e,this.groupBy=u.X,this.items=[],this.toptop={},this.geraete=[],this.backendService.competitions||this.backendService.getCompetitions()}ngOnInit(){this.backendService.competitionSubject.subscribe(e=>{this.backendService.activateNonCaptionMode(this.backendService.competition).subscribe(i=>{this.geraete=i||[],this.sortItems()}),this.backendService.newLastResults.pipe((0,h.h)(i=>!!i&&!!i.lastTopResults)).subscribe(i=>{this.items=[],this.toptop={},Object.keys(i.lastTopResults).forEach(r=>{const c=i.lastTopResults[r],m=this.toptop[c.wertung.wettkampfdisziplinId];m?m.wertung.endnote<c.wertung.endnote&&(this.toptop[c.wertung.wettkampfdisziplinId]=c):this.toptop[c.wertung.wettkampfdisziplinId]=c}),Object.keys(this.toptop).forEach(r=>{this.items.push(this.toptop[r])}),this.sortItems()})})}sortItems(){this.items=this.items.sort((e,i)=>{let r=e.programm.localeCompare(i.programm);return 0===r&&(r=this.geraetOrder(e.geraet)-this.geraetOrder(i.geraet)),r})}get stationFreezed(){return this.backendService.stationFreezed}set competition(e){this.stationFreezed||(this.backendService.getDurchgaenge(e),this.backendService.activateNonCaptionMode(this.backendService.competition).subscribe(i=>{this.geraete=i||[],this.sortItems()}))}get competition(){return this.backendService.competition||""}getCompetitions(){return this.backendService.competitions||[]}competitionName(){if(!this.backendService.competitions)return"";const e=this.backendService.competitions.filter(i=>i.uuid===this.backendService.competition).map(i=>i.titel+", am "+(i.datum+"T").split("T")[0].split("-").reverse().join("-"));return 1===e.length?e[0]:""}geraetOrder(e){return this.geraete?this.geraete.findIndex(r=>r.id===e):0}geraetText(e){if(!this.geraete)return"";const i=this.geraete.filter(r=>r.id===e).map(r=>r.name);return 1===i.length?i[0]:""}getColumnSpec(){return this.geraete?.length||0}getMaxColumnSpec(){return Math.min(12,Math.max(1,Math.floor(12/this.geraete.length+.5)))}getTitle(e){return e.programm+" - "+this.geraetText(e.geraet)}onlyUnique(e,i,r){return r.indexOf(e)===i}getProgramme(){return this.items.map(e=>e.programm).filter(this.onlyUnique)}getWertungen(e){return this.items.filter(i=>i.programm===e)}itemTapped(e,i){}}return o.\u0275fac=function(e){return new(e||o)(t.Y36(f.v))},o.\u0275cmp=t.Xpm({type:o,selectors:[["app-last-top-results"]],decls:17,vars:4,consts:[["slot","start"],["slot","icon-only","name","menu"],["no-padding",""],[4,"ngIf"],["slot","end",4,"ngIf"],["no-padding","",4,"ngIf"],["placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange",4,"ngIf"],["placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["slot","end"],[4,"ngFor","ngForOf"],["class","align-self-start","size-xs","12","size-md","6","size-lg","3",4,"ngFor","ngForOf"],["size-xs","12","size-md","6","size-lg","3",1,"align-self-start"],[3,"item","title","groupedBy"],["class","align-self-start","size-xs","12","size-sm","6","size-md","4","size-lg","3",4,"ngFor","ngForOf"],["size-xs","12","size-sm","6","size-md","4","size-lg","3",1,"align-self-start"]],template:function(e,i){1&e&&(t.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-menu-toggle")(4,"ion-button"),t._UZ(5,"ion-icon",1),t.qZA()()(),t.TgZ(6,"ion-title")(7,"ion-grid",2)(8,"ion-row")(9,"ion-col")(10,"ion-label"),t._uU(11,"Top Resultate"),t.qZA()(),t.YNc(12,x,5,1,"ion-col",3),t.qZA()()(),t.YNc(13,v,2,1,"ion-note",4),t.qZA()(),t.TgZ(14,"ion-content"),t.YNc(15,R,2,1,"ion-grid",5),t.YNc(16,z,2,1,"ion-grid",5),t.qZA()),2&e&&(t.xp6(12),t.Q6J("ngIf",!i.competition),t.xp6(1),t.Q6J("ngIf",i.competition),t.xp6(2),t.Q6J("ngIf",i.items.length>0&&6===i.getColumnSpec()),t.xp6(1),t.Q6J("ngIf",i.items.length>0&&6!==i.getColumnSpec()))},dependencies:[l.sg,l.O5,g.JJ,g.On,s.YG,s.Sm,s.wI,s.W2,s.jY,s.Gu,s.gu,s.Ie,s.Q$,s.zc,s.uN,s.Nd,s.t9,s.n0,s.wd,s.sr,s.QI,u.G,l.uU]}),o})();var S=a(5051);const k=[{path:"",component:P}];let I=(()=>{class o{}return o.\u0275fac=function(e){return new(e||o)},o.\u0275mod=t.oAB({type:o}),o.\u0275inj=t.cJS({imports:[l.ez,g.u5,s.Pc,d.Bz.forChild(k),S.K]}),o})()}}]);