(window.webpackJsonp=window.webpackJsonp||[]).push([[16],{"l2/Q":function(t,e,n){"use strict";n.r(e),n.d(e,"RegAthletlistPageModule",function(){return x});var i=n("ofXK"),o=n("3Pt+"),r=n("tyNb"),c=n("TEn/"),s=n("cygB"),a=n("2Vo4"),b=n("XNiG"),l=n("LRne"),u=n("IzEk"),g=n("pLZG"),p=n("lJxs"),d=n("Kj3r"),f=n("/uUt"),h=n("vkgz"),m=n("eIep"),y=n("w1tV"),v=n("fXoL"),k=(n("ppBR"),function(){function t(){this.selected=new v.o}return t.prototype.ngOnInit=function(){},t.prototype.getProgrammText=function(t){var e=this.programmlist.find(function(e){return e.id===t});return e?e.name:"..."},t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=v.Cb({type:t,selectors:[["app-reg-athlet-item"]],inputs:{athletregistration:"athletregistration",status:"status",programmlist:"programmlist"},outputs:{selected:"selected"},decls:13,vars:8,consts:[[3,"click"],["slot","start"],["src","assets/imgs/athlete.png"],["slot","end"]],template:function(t,e){1&t&&(v.Lb(0,"ion-item",0),v.Tb("click",function(){return e.selected?e.selected.emit(e.athletregistration):{}}),v.Lb(1,"ion-avatar",1),v.Jb(2,"img",2),v.Kb(),v.Lb(3,"ion-label"),v.lc(4),v.Jb(5,"br"),v.Lb(6,"small"),v.lc(7),v.Wb(8,"date"),v.Kb(),v.Kb(),v.Lb(9,"ion-note",3),v.lc(10," Programm/Kategorie"),v.Jb(11,"br"),v.lc(12),v.Kb(),v.Kb()),2&t&&(v.yb(4),v.pc("",e.athletregistration.name,", ",e.athletregistration.vorname," (",e.athletregistration.geschlecht,")"),v.yb(3),v.nc("(",v.Xb(8,6,e.athletregistration.gebdat),")"),v.yb(5),v.oc("",e.getProgrammText(e.athletregistration.programId),", ",e.status," "))},directives:[c.q,c.d,c.v,c.z],pipes:[i.e],styles:[""]}),t}());function L(t,e){if(1&t&&(v.Lb(0,"ion-select-option",10),v.lc(1),v.Wb(2,"date"),v.Kb()),2&t){var n=e.$implicit;v.bc("value",n.uuid),v.yb(1),v.nc(" ",n.titel+" "+v.Yb(2,2,n.datum,"dd-MM-yy"),"")}}function I(t,e){if(1&t){var n=v.Mb();v.Lb(0,"ion-select",8),v.Tb("ngModelChange",function(t){return v.fc(n),v.Vb(2).competition=t}),v.kc(1,L,3,5,"ion-select-option",9),v.Kb()}if(2&t){var i=v.Vb(2);v.bc("ngModel",i.competition),v.yb(1),v.bc("ngForOf",i.getCompetitions())}}function K(t,e){if(1&t&&(v.Lb(0,"ion-col"),v.Lb(1,"ion-item"),v.Lb(2,"ion-label"),v.lc(3,"Wettkampf"),v.Kb(),v.kc(4,I,2,2,"ion-select",7),v.Kb(),v.Kb()),2&t){var n=v.Vb();v.yb(4),v.bc("ngIf",n.getCompetitions().length>0)}}function S(t,e){if(1&t&&(v.Lb(0,"ion-note",11),v.lc(1),v.Kb()),2&t){var n=v.Vb();v.yb(1),v.nc(" ",n.competitionName()," ")}}function A(t,e){1&t&&(v.Lb(0,"ion-item"),v.Lb(1,"ion-label"),v.lc(2,"loading ..."),v.Kb(),v.Jb(3,"ion-spinner"),v.Kb())}function C(t,e){if(1&t){var n=v.Mb();v.Lb(0,"ion-item-option",19),v.Tb("click",function(){v.fc(n);var t=v.Vb().$implicit,e=v.ec(1);return v.Vb(2).delete(t,e)}),v.Jb(1,"ion-icon",17),v.lc(2," L\xf6schen "),v.Kb()}}function w(t,e){if(1&t){var n=v.Mb();v.Lb(0,"ion-item-sliding",null,13),v.Lb(2,"app-reg-athlet-item",14),v.Tb("click",function(){v.fc(n);var t=e.$implicit,i=v.ec(1);return v.Vb(2).itemTapped(t,i)}),v.Kb(),v.Lb(3,"ion-item-options",15),v.Lb(4,"ion-item-option",16),v.Tb("click",function(){v.fc(n);var t=e.$implicit,i=v.ec(1);return v.Vb(2).edit(t,i)}),v.Jb(5,"ion-icon",17),v.lc(6),v.Kb(),v.kc(7,C,3,0,"ion-item-option",18),v.Kb(),v.Kb()}if(2&t){var i=e.$implicit,o=v.Vb(2);v.yb(2),v.bc("athletregistration",i)("status",o.getStatus(i))("programmlist",o.wkPgms),v.yb(4),v.nc(" ",o.isLoggedInAsClub()?"Bearbeiten":o.isLoggedIn()?"Best\xe4tigen":"Anzeigen"," "),v.yb(1),v.bc("ngIf",o.isLoggedInAsClub())}}function R(t,e){if(1&t&&(v.Lb(0,"ion-content"),v.Lb(1,"ion-list"),v.kc(2,A,4,0,"ion-item",3),v.Wb(3,"async"),v.kc(4,w,8,5,"ion-item-sliding",12),v.Kb(),v.Kb()),2&t){var n=v.Vb();v.yb(2),v.bc("ngIf",v.Xb(3,2,n.isBusy)||!(n.competition&&n.currentRegistration&&n.sAthletRegistrationList)),v.yb(2),v.bc("ngForOf",n.filteredStartList)}}function O(t,e){if(1&t){var n=v.Mb();v.Lb(0,"ion-button",20),v.Tb("click",function(){return v.fc(n),v.Vb().createRegistration()}),v.Jb(1,"ion-icon",21),v.lc(2," Neue Anmeldung... "),v.Kb()}}var M=[{path:"",component:function(){function t(t,e,n,i){this.navCtrl=t,this.route=e,this.backendService=n,this.alertCtrl=i,this.busy=new a.a(!1),this.tMyQueryStream=new b.a,this.sFilterTask=void 0,this.sSyncActions=[],this.backendService.competitions||this.backendService.getCompetitions()}return t.prototype.ngOnInit=function(){this.busy.next(!0);var t=this.route.snapshot.paramMap.get("wkId");this.currentRegId=parseInt(this.route.snapshot.paramMap.get("regId")),t?this.competition=t:this.backendService.competition&&(this.competition=this.backendService.competition)},t.prototype.ionViewWillEnter=function(){this.refreshList()},t.prototype.getSyncActions=function(){var t=this;this.backendService.loadRegistrationSyncActions().pipe(Object(u.a)(1)).subscribe(function(e){t.sSyncActions=e})},t.prototype.getStatus=function(t){return this.sSyncActions?this.sSyncActions.find(function(e){return e.verein.id===t.vereinregistrationId&&e.caption.indexOf(t.name)>-1&&e.caption.indexOf(t.vorname)>-1})?"pending":"in sync":"n/a"},t.prototype.refreshList=function(){var t=this;this.busy.next(!0),this.currentRegistration=void 0,this.getSyncActions(),this.backendService.getClubRegistrations(this.competition).pipe(Object(g.a)(function(e){return!!e.find(function(e){return e.id===t.currentRegId})}),Object(u.a)(1)).subscribe(function(e){t.currentRegistration=e.find(function(e){return e.id===t.currentRegId}),console.log("ask athletes-list for registration"),t.backendService.loadAthletRegistrations(t.competition,t.currentRegId).subscribe(function(e){t.busy.next(!1),t.athletregistrations=e,t.tMyQueryStream.pipe(Object(g.a)(function(t){return!!t&&!!t.target}),Object(p.a)(function(t){return t.target.value||"*"}),Object(d.a)(300),Object(f.a)(),Object(h.a)(function(e){return t.busy.next(!0)}),Object(m.a)(t.runQuery(e)),Object(y.a)()).subscribe(function(e){t.sFilteredRegistrationList=e,t.busy.next(!1)})})})},Object.defineProperty(t.prototype,"competition",{get:function(){return this.backendService.competition||""},set:function(t){var e=this;this.currentRegistration&&t===this.backendService.competition||this.backendService.loadProgramsForCompetition(this.competition).subscribe(function(t){e.wkPgms=t})},enumerable:!1,configurable:!0}),t.prototype.getCompetitions=function(){return this.backendService.competitions||[]},t.prototype.competitionName=function(){return this.backendService.competitionName},t.prototype.runQuery=function(t){var e=this;return function(n){var i=n.trim(),o=[];return i&&t&&t.forEach(function(t){e.filter(i)(t)&&o.push(t)}),Object(l.a)(o)}},Object.defineProperty(t.prototype,"athletregistrations",{get:function(){return this.sAthletRegistrationList},set:function(t){this.sAthletRegistrationList=t,this.reloadList(this.sMyQuery)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"filteredStartList",{get:function(){return this.sFilteredRegistrationList||this.sAthletRegistrationList||[]},enumerable:!1,configurable:!0}),t.prototype.reloadList=function(t){this.tMyQueryStream.next(t)},t.prototype.itemTapped=function(t,e){e.getOpenAmount().then(function(t){t>0?e.close():e.open("end")})},t.prototype.isLoggedInAsClub=function(){return this.backendService.loggedIn&&this.backendService.authenticatedClubId===this.currentRegId+""},t.prototype.isLoggedInAsAdmin=function(){return this.backendService.loggedIn&&!!this.backendService.authenticatedClubId},t.prototype.filter=function(t){var e=this,n=t.toUpperCase().split(" ");return function(i){return"*"===t.trim()||n.filter(function(t){return i.name.toUpperCase().indexOf(t)>-1||i.vorname.toUpperCase().indexOf(t)>-1||!!e.wkPgms.find(function(e){return i.programId===e.id&&e.name===t})||i.gebdat.indexOf(t)>-1||void 0}).length===n.length}},t.prototype.createRegistration=function(){this.navCtrl.navigateForward("reg-athletlist/"+this.backendService.competition+"/"+this.currentRegId+"/0")},t.prototype.edit=function(t,e){this.navCtrl.navigateForward("reg-athletlist/"+this.backendService.competition+"/"+this.currentRegId+"/"+t.id),e.close()},t.prototype.delete=function(t,e){var n=this;e.close(),this.alertCtrl.create({header:"Achtung",subHeader:"L\xf6schen der Athlet-Anmeldung am Wettkampf",message:"Hiermit wird die Anmeldung von "+t.name+", "+t.vorname+" am Wettkampf gel\xf6scht.",buttons:[{text:"ABBRECHEN",role:"cancel",handler:function(){}},{text:"OKAY",handler:function(){n.backendService.deleteAthletRegistration(n.backendService.competition,n.currentRegId,t).subscribe(function(){n.refreshList()})}}]}).then(function(t){return t.present()})},t.\u0275fac=function(e){return new(e||t)(v.Ib(c.N),v.Ib(r.a),v.Ib(s.a),v.Ib(c.b))},t.\u0275cmp=v.Cb({type:t,selectors:[["app-reg-athletlist"]],decls:18,vars:5,consts:[["slot","start"],["defaultHref","/"],["no-padding",""],[4,"ngIf"],["slot","end",4,"ngIf"],["placeholder","Search","showCancelButton","never",3,"ngModel","ngModelChange","ionInput","ionCancel"],["size","large","expand","block","color","success",3,"click",4,"ngIf"],["placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange",4,"ngIf"],["placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["slot","end"],[4,"ngFor","ngForOf"],["slidingAthletRegistrationItem",""],[3,"athletregistration","status","programmlist","click"],["side","end"],["color","primary",3,"click"],["name","arrow-dropright-circle","ios","md-arrow-dropright-circle"],["color","danger",3,"click",4,"ngIf"],["color","danger",3,"click"],["size","large","expand","block","color","success",3,"click"],["slot","start","name","add"]],template:function(t,e){1&t&&(v.Lb(0,"ion-header"),v.Lb(1,"ion-toolbar"),v.Lb(2,"ion-buttons",0),v.Jb(3,"ion-back-button",1),v.Kb(),v.Lb(4,"ion-title"),v.Lb(5,"ion-grid",2),v.Lb(6,"ion-row"),v.Lb(7,"ion-col"),v.Lb(8,"ion-label"),v.lc(9,"Wettkampf-Anmeldungen"),v.Kb(),v.Kb(),v.kc(10,K,5,1,"ion-col",3),v.Kb(),v.Kb(),v.Kb(),v.kc(11,S,2,1,"ion-note",4),v.Kb(),v.Lb(12,"ion-searchbar",5),v.Tb("ngModelChange",function(t){return e.sMyQuery=t})("ionInput",function(t){return e.reloadList(t)})("ionCancel",function(t){return e.reloadList(t)}),v.Kb(),v.Kb(),v.kc(13,R,5,4,"ion-content",3),v.Lb(14,"ion-footer"),v.Lb(15,"ion-toolbar"),v.Lb(16,"ion-list"),v.kc(17,O,3,0,"ion-button",6),v.Kb(),v.Kb(),v.Kb()),2&t&&(v.yb(10),v.bc("ngIf",!e.competition),v.yb(1),v.bc("ngIf",e.competition),v.yb(1),v.bc("ngModel",e.sMyQuery),v.yb(1),v.bc("ngIf",e.wkPgms&&e.wkPgms.length>0),v.yb(4),v.bc("ngIf",e.isLoggedInAsClub()))},directives:[c.n,c.J,c.h,c.e,c.f,c.I,c.m,c.B,c.j,c.v,i.m,c.C,c.R,o.d,o.g,c.l,c.w,c.q,c.D,c.Q,i.l,c.E,c.z,c.k,c.F,c.u,k,c.t,c.s,c.o,c.g],pipes:[i.e,i.b],styles:[""]}),t}()}],x=function(){function t(){}return t.\u0275mod=v.Gb({type:t}),t.\u0275inj=v.Fb({factory:function(e){return new(e||t)},imports:[[i.c,o.a,c.K,r.i.forChild(M)]]}),t}()}}]);