(self.webpackChunkresultcatcher=self.webpackChunkresultcatcher||[]).push([[8634],{8634:(t,e,i)=>{"use strict";i.r(e),i.d(e,{RegAthletlistPageModule:()=>L});var n=i(8583),o=i(665),s=i(881),r=i(2859),c=i(6215),a=i(7709),l=i(5917),g=i(5257),d=i(5435),u=i(8002),h=i(4395),p=i(7519),m=i(3342),f=i(3190),b=i(8819),A=i(8186),Z=i(600);let k=(()=>{class t{constructor(){this.selected=new A.vpe}ngOnInit(){}getProgrammText(t){const e=this.programmlist.find(e=>e.id===t);return e?e.name:"..."}}return t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=A.Xpm({type:t,selectors:[["app-reg-athlet-item"]],inputs:{athletregistration:"athletregistration",status:"status",programmlist:"programmlist"},outputs:{selected:"selected"},decls:13,vars:8,consts:[[3,"click"],["slot","start"],["src","assets/imgs/athlete.png"],["slot","end"]],template:function(t,e){1&t&&(A.TgZ(0,"ion-item",0),A.NdJ("click",function(){return e.selected?e.selected.emit(e.athletregistration):{}}),A.TgZ(1,"ion-avatar",1),A._UZ(2,"img",2),A.qZA(),A.TgZ(3,"ion-label"),A._uU(4),A._UZ(5,"br"),A.TgZ(6,"small"),A._uU(7),A.ALo(8,"date"),A.qZA(),A.qZA(),A.TgZ(9,"ion-note",3),A._uU(10," Programm/Kategorie"),A._UZ(11,"br"),A._uU(12),A.qZA(),A.qZA()),2&t&&(A.xp6(4),A.lnq("",e.athletregistration.name,", ",e.athletregistration.vorname," (",e.athletregistration.geschlecht,")"),A.xp6(3),A.hij("(",A.lcZ(8,6,e.athletregistration.gebdat),")"),A.xp6(5),A.AsE("",e.getProgrammText(e.athletregistration.programId),", ",e.status," "))},directives:[r.Ie,r.BJ,r.Q$,r.uN],pipes:[n.uU],styles:[""]}),t})();function x(t,e){if(1&t&&(A.TgZ(0,"ion-select-option",10),A._uU(1),A.ALo(2,"date"),A.qZA()),2&t){const t=e.$implicit;A.Q6J("value",t.uuid),A.xp6(1),A.hij(" ",t.titel+" "+A.xi3(2,2,t.datum,"dd-MM-yy"),"")}}function v(t,e){if(1&t){const t=A.EpF();A.TgZ(0,"ion-select",8),A.NdJ("ngModelChange",function(e){return A.CHM(t),A.oxw(2).competition=e}),A.YNc(1,x,3,5,"ion-select-option",9),A.qZA()}if(2&t){const t=A.oxw(2);A.Q6J("ngModel",t.competition),A.xp6(1),A.Q6J("ngForOf",t.getCompetitions())}}function I(t,e){if(1&t&&(A.TgZ(0,"ion-col"),A.TgZ(1,"ion-item"),A.TgZ(2,"ion-label"),A._uU(3,"Wettkampf"),A.qZA(),A.YNc(4,v,2,2,"ion-select",7),A.qZA(),A.qZA()),2&t){const t=A.oxw();A.xp6(4),A.Q6J("ngIf",t.getCompetitions().length>0)}}function T(t,e){if(1&t&&(A.TgZ(0,"ion-note",11),A._uU(1),A.qZA()),2&t){const t=A.oxw();A.xp6(1),A.hij(" ",t.competitionName()," ")}}function y(t,e){1&t&&(A.TgZ(0,"ion-item"),A.TgZ(1,"ion-label"),A._uU(2,"loading ..."),A.qZA(),A._UZ(3,"ion-spinner"),A.qZA())}function S(t,e){if(1&t){const t=A.EpF();A.TgZ(0,"ion-item-option",19),A.NdJ("click",function(){A.CHM(t);const e=A.oxw().$implicit,i=A.MAs(1);return A.oxw(2).delete(e,i)}),A._UZ(1,"ion-icon",17),A._uU(2," L\xf6schen "),A.qZA()}}function w(t,e){if(1&t){const t=A.EpF();A.TgZ(0,"ion-item-sliding",null,13),A.TgZ(2,"app-reg-athlet-item",14),A.NdJ("click",function(){const e=A.CHM(t).$implicit,i=A.MAs(1);return A.oxw(2).itemTapped(e,i)}),A.qZA(),A.TgZ(3,"ion-item-options",15),A.TgZ(4,"ion-item-option",16),A.NdJ("click",function(){const e=A.CHM(t).$implicit,i=A.MAs(1);return A.oxw(2).edit(e,i)}),A._UZ(5,"ion-icon",17),A._uU(6),A.qZA(),A.YNc(7,S,3,0,"ion-item-option",18),A.qZA(),A.qZA()}if(2&t){const t=e.$implicit,i=A.oxw(2);A.xp6(2),A.Q6J("athletregistration",t)("status",i.getStatus(t))("programmlist",i.wkPgms),A.xp6(4),A.hij(" ",i.isLoggedInAsClub()?"Bearbeiten":i.isLoggedIn()?"Best\xe4tigen":"Anzeigen"," "),A.xp6(1),A.Q6J("ngIf",i.isLoggedInAsClub())}}function q(t,e){if(1&t&&(A.TgZ(0,"ion-content"),A.TgZ(1,"ion-list"),A.YNc(2,y,4,0,"ion-item",3),A.ALo(3,"async"),A.YNc(4,w,8,5,"ion-item-sliding",12),A.qZA(),A.qZA()),2&t){const t=A.oxw();A.xp6(2),A.Q6J("ngIf",A.lcZ(3,2,t.busy)||!(t.competition&&t.currentRegistration&&t.sAthletRegistrationList)),A.xp6(2),A.Q6J("ngForOf",t.filteredStartList)}}function C(t,e){if(1&t){const t=A.EpF();A.TgZ(0,"ion-button",20),A.NdJ("click",function(){return A.CHM(t),A.oxw().createRegistration()}),A._UZ(1,"ion-icon",21),A._uU(2," Neue Anmeldung... "),A.qZA()}}const M=[{path:"",component:(()=>{class t{constructor(t,e,i,n){this.navCtrl=t,this.route=e,this.backendService=i,this.alertCtrl=n,this.busy=new c.X(!1),this.tMyQueryStream=new a.xQ,this.sFilterTask=void 0,this.sSyncActions=[],this.backendService.competitions||this.backendService.getCompetitions()}ngOnInit(){this.busy.next(!0);const t=this.route.snapshot.paramMap.get("wkId");this.currentRegId=parseInt(this.route.snapshot.paramMap.get("regId")),t?this.competition=t:this.backendService.competition&&(this.competition=this.backendService.competition)}ionViewWillEnter(){this.refreshList()}getSyncActions(){this.backendService.loadRegistrationSyncActions().pipe((0,g.q)(1)).subscribe(t=>{this.sSyncActions=t})}getStatus(t){return this.sSyncActions?this.sSyncActions.find(e=>e.verein.id===t.vereinregistrationId&&e.caption.indexOf(t.name)>-1&&e.caption.indexOf(t.vorname)>-1)?"pending":"in sync":"n/a"}refreshList(){this.busy.next(!0),this.currentRegistration=void 0,this.getSyncActions(),this.backendService.getClubRegistrations(this.competition).pipe((0,d.h)(t=>!!t.find(t=>t.id===this.currentRegId)),(0,g.q)(1)).subscribe(t=>{this.currentRegistration=t.find(t=>t.id===this.currentRegId),console.log("ask athletes-list for registration"),this.backendService.loadAthletRegistrations(this.competition,this.currentRegId).subscribe(t=>{this.busy.next(!1),this.athletregistrations=t,this.tMyQueryStream.pipe((0,d.h)(t=>!!t&&!!t.target),(0,u.U)(t=>t.target.value||"*"),(0,h.b)(300),(0,p.x)(),(0,m.b)(t=>this.busy.next(!0)),(0,f.w)(this.runQuery(t)),(0,b.B)()).subscribe(t=>{this.sFilteredRegistrationList=t,this.busy.next(!1)})})})}set competition(t){this.currentRegistration&&t===this.backendService.competition||this.backendService.loadProgramsForCompetition(this.competition).subscribe(t=>{this.wkPgms=t})}get competition(){return this.backendService.competition||""}getCompetitions(){return this.backendService.competitions||[]}competitionName(){return this.backendService.competitionName}runQuery(t){return e=>{const i=e.trim(),n=[];return i&&t&&t.forEach(t=>{this.filter(i)(t)&&n.push(t)}),(0,l.of)(n)}}set athletregistrations(t){this.sAthletRegistrationList=t,this.reloadList(this.sMyQuery)}get athletregistrations(){return this.sAthletRegistrationList}get filteredStartList(){return this.sFilteredRegistrationList||this.sAthletRegistrationList||[]}reloadList(t){this.tMyQueryStream.next(t)}itemTapped(t,e){e.getOpenAmount().then(t=>{t>0?e.close():e.open("end")})}isLoggedInAsClub(){return this.backendService.loggedIn&&this.backendService.authenticatedClubId===this.currentRegId+""}isLoggedInAsAdmin(){return this.backendService.loggedIn&&!!this.backendService.authenticatedClubId}isLoggedIn(){return this.backendService.loggedIn}filter(t){const e=t.toUpperCase().split(" ");return i=>"*"===t.trim()||e.filter(t=>i.name.toUpperCase().indexOf(t)>-1||i.vorname.toUpperCase().indexOf(t)>-1||!!this.wkPgms.find(e=>i.programId===e.id&&e.name===t)||i.gebdat.indexOf(t)>-1||void 0).length===e.length}createRegistration(){this.navCtrl.navigateForward(`reg-athletlist/${this.backendService.competition}/${this.currentRegId}/0`)}edit(t,e){this.navCtrl.navigateForward(`reg-athletlist/${this.backendService.competition}/${this.currentRegId}/${t.id}`),e.close()}delete(t,e){e.close(),this.alertCtrl.create({header:"Achtung",subHeader:"L\xf6schen der Athlet-Anmeldung am Wettkampf",message:"Hiermit wird die Anmeldung von "+t.name+", "+t.vorname+" am Wettkampf gel\xf6scht.",buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"OKAY",handler:()=>{this.backendService.deleteAthletRegistration(this.backendService.competition,this.currentRegId,t).subscribe(()=>{this.refreshList()})}}]}).then(t=>t.present())}}return t.\u0275fac=function(e){return new(e||t)(A.Y36(r.SH),A.Y36(s.gz),A.Y36(Z.v),A.Y36(r.Br))},t.\u0275cmp=A.Xpm({type:t,selectors:[["app-reg-athletlist"]],decls:18,vars:5,consts:[["slot","start"],["defaultHref","/"],["no-padding",""],[4,"ngIf"],["slot","end",4,"ngIf"],["placeholder","Search","showCancelButton","never",3,"ngModel","ngModelChange","ionInput","ionCancel"],["size","large","expand","block","color","success",3,"click",4,"ngIf"],["placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange",4,"ngIf"],["placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],[3,"value"],["slot","end"],[4,"ngFor","ngForOf"],["slidingAthletRegistrationItem",""],[3,"athletregistration","status","programmlist","click"],["side","end"],["color","primary",3,"click"],["name","arrow-dropright-circle","ios","md-arrow-dropright-circle"],["color","danger",3,"click",4,"ngIf"],["color","danger",3,"click"],["size","large","expand","block","color","success",3,"click"],["slot","start","name","add"]],template:function(t,e){1&t&&(A.TgZ(0,"ion-header"),A.TgZ(1,"ion-toolbar"),A.TgZ(2,"ion-buttons",0),A._UZ(3,"ion-back-button",1),A.qZA(),A.TgZ(4,"ion-title"),A.TgZ(5,"ion-grid",2),A.TgZ(6,"ion-row"),A.TgZ(7,"ion-col"),A.TgZ(8,"ion-label"),A._uU(9,"Angemeldete Athleten/Athletinnen"),A.qZA(),A.qZA(),A.YNc(10,I,5,1,"ion-col",3),A.qZA(),A.qZA(),A.qZA(),A.YNc(11,T,2,1,"ion-note",4),A.qZA(),A.TgZ(12,"ion-searchbar",5),A.NdJ("ngModelChange",function(t){return e.sMyQuery=t})("ionInput",function(t){return e.reloadList(t)})("ionCancel",function(t){return e.reloadList(t)}),A.qZA(),A.qZA(),A.YNc(13,q,5,4,"ion-content",3),A.TgZ(14,"ion-footer"),A.TgZ(15,"ion-toolbar"),A.TgZ(16,"ion-list"),A.YNc(17,C,3,0,"ion-button",6),A.qZA(),A.qZA(),A.qZA()),2&t&&(A.xp6(10),A.Q6J("ngIf",!e.competition),A.xp6(1),A.Q6J("ngIf",e.competition),A.xp6(1),A.Q6J("ngModel",e.sMyQuery),A.xp6(1),A.Q6J("ngIf",e.wkPgms&&e.wkPgms.length>0),A.xp6(4),A.Q6J("ngIf",e.isLoggedInAsClub()))},directives:[r.Gu,r.sr,r.Sm,r.oU,r.cs,r.wd,r.jY,r.Nd,r.wI,r.Q$,n.O5,r.VI,r.j9,o.JJ,o.On,r.fr,r.q_,r.Ie,r.t9,r.QI,n.sg,r.n0,r.uN,r.W2,r.PQ,r.td,k,r.IK,r.u8,r.gu,r.YG],pipes:[n.uU,n.Ov],styles:[""]}),t})()}];let L=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=A.oAB({type:t}),t.\u0275inj=A.cJS({imports:[[n.ez,o.u5,r.Pc,s.Bz.forChild(M)]]}),t})()}}]);