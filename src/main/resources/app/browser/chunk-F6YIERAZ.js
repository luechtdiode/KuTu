import{a as Y,b as Z,h as ee}from"./chunk-5JK2MF46.js";import{B as r,Ba as V,Bb as X,C as a,D as p,E as C,G as T,H as c,Ja as B,Ka as $,Ma as O,Na as j,O as u,P as v,Pa as H,Q as y,Qa as R,Ra as D,X as I,Ya as G,aa as A,ab as L,ba as z,ca as M,d as _,db as K,e as g,ga as E,kb as W,lb as U,m as w,ma as F,nb as q,o as x,p as b,qa as N,t as o,u as h,ub as J,v as S,vb as Q,w as k,x as d,y as f,z as l,za as P}from"./chunk-KMY4ZES7.js";import"./chunk-6IQPZO6F.js";import"./chunk-JSAAGAZE.js";import"./chunk-5XVA5RR2.js";import"./chunk-LOHYXAXQ.js";import"./chunk-P5VFIEEE.js";import"./chunk-HC6MZPB3.js";import"./chunk-J5OMF6R4.js";import"./chunk-KWW2H4SN.js";import"./chunk-7HA5TF5T.js";import"./chunk-ZOBGMWXG.js";import"./chunk-426OJ4HC.js";import"./chunk-RPQZFOYD.js";import"./chunk-GIGBYVJT.js";import"./chunk-MM5QLNJM.js";import"./chunk-H3GX5QFY.js";import"./chunk-7D6K5XYM.js";import"./chunk-OBXDPQ3V.js";import"./chunk-G2DZN4YG.js";import"./chunk-MCRJI3T3.js";import"./chunk-TI7J2N3O.js";import"./chunk-TTFYQ64X.js";import"./chunk-2R6CW7ES.js";var te=n=>({"gradient-border":n});function re(n,m){if(n&1){let e=C();r(0,"ion-button",6),T("click",function(){x(e);let i=c();return b(i.share())}),p(1,"ion-icon",7),a()}}function ae(n,m){if(n&1&&(r(0,"ion-col")(1,"ion-note"),u(2),a(),r(3,"ion-label")(4,"div",8),u(5),a(),r(6,"div",9),u(7),a()()()),n&2){let e=c();o(2),y(" ",e.competitionName()," "),o(3),v(e.athlet.vorname+" "+e.athlet.name),o(2),v(e.athlet.verein)}}function se(n,m){if(n&1&&(r(0,"ion-col",11)(1,"div",12),p(2,"result-display",13),a()()),n&2){let e=m.$implicit,t=c(2);f("size-xl",t.getMaxColumnSpec()),o(),l("ngClass",I(5,te,t.isNew(e))),o(),l("item",e)("title",t.getTitle(e))("groupedBy",t.groupBy.ATHLET)}}function le(n,m){if(n&1&&(r(0,"ion-row"),d(1,se,3,7,"ion-col",10),a()),n&2){let e=c();o(),l("ngForOf",e.items)}}function me(n,m){if(n&1&&(r(0,"ion-col",15)(1,"div",12),p(2,"result-display",13),a()()),n&2){let e=m.$implicit,t=c(2);f("size-xl",t.getMaxColumnSpec()),o(),l("ngClass",I(5,te,t.isNew(e))),o(),l("item",e)("title",t.getTitle(e))("groupedBy",t.groupBy.ATHLET)}}function ce(n,m){if(n&1&&(r(0,"ion-row"),d(1,me,3,7,"ion-col",14),a()),n&2){let e=c();o(),l("ngForOf",e.items)}}var ie=(()=>{class n{navCtrl;route;backendService;groupBy=Y;items=[];lastItems=[];geraete=[];athletId;wkId;constructor(e,t,i){this.navCtrl=e,this.route=t,this.backendService=i,this.backendService.competitions||this.backendService.getCompetitions()}makeItemHash(e){return e.id*this.geraete.length*200+e.geraet*100+(e.wertung.endnote||-1)}ngOnInit(){this.athletId=parseInt(this.route.snapshot.paramMap.get("athletId")),this.wkId=this.route.snapshot.paramMap.get("wkId"),this.backendService.loadAthletWertungen(this.wkId,this.athletId).pipe(g(t=>!!t&&t.length>0)).subscribe(t=>{this.items=t,this.sortItems(this.athletId)}),this.backendService.geraeteSubject.subscribe(t=>{this.backendService.captionmode||(this.geraete=t)});let e=t=>{this.lastItems=this.items.map(i=>this.makeItemHash(i)),this.items=this.items.map(i=>{let s=t[i.wertung.wettkampfdisziplinId];return s&&s.id===i.id?s:i})};this.backendService.newLastResults.pipe(g(t=>!!t),_(t=>t.results)).subscribe(e)}sortItems(e){this.items=this.items.sort((t,i)=>{let s=t.programm.localeCompare(i.programm);return s===0&&(s=this.geraetOrder(t.geraet)-this.geraetOrder(i.geraet)),s})}isNew(e){let t=this.makeItemHash(e);return this.lastItems.filter(i=>i===t).length===0}get stationFreezed(){return this.backendService.stationFreezed}get competition(){return this.backendService.competition||""}getCompetitions(){return this.backendService.competitions||[]}competitionContainer(){let e={titel:"",datum:new Date,auszeichnung:void 0,auszeichnungendnote:void 0,id:void 0,uuid:void 0,programmId:0};if(!this.backendService.competitions)return e;let t=this.backendService.competitions.filter(i=>i.uuid===this.backendService.competition);return t.length===1?t[0]:e}competitionName(){let e=this.competitionContainer();return e.titel===""?"":e.titel+", am "+(e.datum+"T").split("T")[0].split("-").reverse().join("-")}get athlet(){return this.items&&this.items.length>0?this.items[0]:{}}getColumnSpec(){return this.geraete.length}getMaxColumnSpec(){return Math.min(12,Math.max(1,Math.floor(12/this.items.length+.5)))}geraetOrder(e){return this.geraete?this.geraete.findIndex(i=>i.id===e):0}geraetText(e){if(!this.geraete)return"";let t=this.geraete.filter(i=>i.id===e).map(i=>i.name);return t.length===1?t[0]:""}getTitle(e){return e.programm+" - "+this.geraetText(e.geraet)}isShareAvailable(){return!!navigator&&!!navigator.share}share(){let e="GeTu",t={1:"Athletik",11:"KuTu",20:"GeTu",31:"KuTu"},i=this.competitionContainer();i.titel!==""&&(e=t[i.programmId]);let s=`${this.items[0].vorname} ${this.items[0].name}, ${this.items[0].verein} #${e}-${i.titel.replace(","," ").split(" ").join("_")}_${this.items[0].programm} #${this.items[0].verein.replace(","," ").split(" ").join("_")}`;new Date(i.datum).getTime()>Date.now()?s="Hoffe das Beste f\xFCr "+s:s="Geschafft! Wettkampf Resultate von "+s,this.isShareAvailable()&&navigator.share({title:this.competitionName(),text:s,url:`${Q}athlet-view/${this.wkId}/${this.athletId}`}).then(function(){console.log("Article shared")}).catch(function(ne){console.log(ne.message)})}static \u0275fac=function(t){return new(t||n)(h(V),h(F),h(X))};static \u0275cmp=S({type:n,selectors:[["app-athlet-view"]],standalone:!1,decls:19,vars:4,consts:[["slot","start"],["defaultHref","/"],["no-padding",""],["slot","end"],["slot","end",3,"click",4,"ngIf"],[4,"ngIf"],["slot","end",3,"click"],["name","share"],[2,"font-size","16pt"],[2,"font-size","10pt"],["class","align-self-start","size-xs","12","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["size-xs","12","size-md","6","size-lg","4",1,"align-self-start"],[3,"ngClass"],[3,"item","title","groupedBy"],["class","align-self-start","size-xs","12","size-md","6","size-lg","3",4,"ngFor","ngForOf"],["size-xs","12","size-md","6","size-lg","3",1,"align-self-start"]],template:function(t,i){t&1&&(r(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),p(3,"ion-back-button",1),a(),r(4,"ion-title")(5,"ion-grid",2)(6,"ion-row")(7,"ion-col")(8,"ion-label"),u(9,"Aktuelle Resultate"),a()()()()(),r(10,"ion-buttons",3),d(11,re,2,0,"ion-button",4),a()(),r(12,"ion-grid",2)(13,"ion-row"),d(14,ae,8,3,"ion-col",5),a()()(),r(15,"ion-content")(16,"ion-grid",2),d(17,le,2,1,"ion-row",5)(18,ce,2,1,"ion-row",5),a()()),t&2&&(o(11),l("ngIf",i.isShareAvailable()),o(3),l("ngIf",i.competition),o(3),l("ngIf",i.getColumnSpec()===6),o(),l("ngIf",i.getColumnSpec()!==6))},dependencies:[A,z,M,B,$,O,j,H,R,D,G,L,K,W,U,q,Z],encapsulation:2})}return n})();var de=[{path:"",component:ie}],ye=(()=>{class n{static \u0275fac=function(t){return new(t||n)};static \u0275mod=k({type:n});static \u0275inj=w({imports:[E,P,J,N.forChild(de),ee]})}return n})();export{ye as AthletViewPageModule};
