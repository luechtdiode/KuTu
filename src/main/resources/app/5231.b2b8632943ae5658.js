"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[5231],{5231:(C,h,l)=>{l.r(h),l.d(h,{RegAthletEditorPageModule:()=>I});var c=l(6895),g=l(433),u=l(5472),r=l(502),_=l(7225),e=l(8274),m=l(600);function p(i,s){if(1&i&&(e.TgZ(0,"ion-select-option",15)(1,"ion-avatar",2),e._UZ(2,"img",8),e.qZA(),e.TgZ(3,"ion-label"),e._uU(4),e._UZ(5,"br"),e.TgZ(6,"small"),e._uU(7),e.ALo(8,"date"),e.qZA()()()),2&i){const t=s.$implicit;e.Q6J("value",t.athletId),e.xp6(4),e.lnq("",t.name,", ",t.vorname," (",t.geschlecht,")"),e.xp6(3),e.hij("(",e.lcZ(8,5,t.gebdat),")")}}function b(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-select",22),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw(2);return e.KtG(a.selectedClubAthletId=o)}),e.YNc(1,p,9,7,"ion-select-option",18),e.qZA()}if(2&i){const t=e.oxw(2);e.Q6J("ngModel",t.selectedClubAthletId),e.xp6(1),e.Q6J("ngForOf",t.clubAthletList)}}function A(i,s){if(1&i&&(e.TgZ(0,"ion-select-option",15),e._uU(1),e.qZA()),2&i){const t=s.$implicit;e.Q6J("value",t.id),e.xp6(1),e.Oqu(t.name)}}function f(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-content")(1,"form",6,7),e.NdJ("ngSubmit",function(){e.CHM(t);const o=e.MAs(2),a=e.oxw();return e.KtG(a.save(o))})("keyup.enter",function(){e.CHM(t);const o=e.MAs(2),a=e.oxw();return e.KtG(a.save(o))}),e.TgZ(3,"ion-list")(4,"ion-item-divider")(5,"ion-avatar",0),e._UZ(6,"img",8),e.qZA(),e.TgZ(7,"ion-label"),e._uU(8,"Athlet / Athletin"),e.qZA(),e.YNc(9,b,2,2,"ion-select",9),e.qZA(),e.TgZ(10,"ion-item")(11,"ion-avatar",0),e._uU(12," \xa0 "),e.qZA(),e.TgZ(13,"ion-input",10),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.registration.name=o)}),e.qZA(),e.TgZ(14,"ion-input",11),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.registration.vorname=o)}),e.qZA()(),e.TgZ(15,"ion-item")(16,"ion-avatar",0),e._uU(17," \xa0 "),e.qZA(),e.TgZ(18,"ion-label",12),e._uU(19,"Geburtsdatum"),e.qZA(),e.TgZ(20,"ion-input",13),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.registration.gebdat=o)}),e.qZA()(),e.TgZ(21,"ion-item")(22,"ion-avatar",0),e._uU(23," \xa0 "),e.qZA(),e.TgZ(24,"ion-label",12),e._uU(25,"Geschlecht"),e.qZA(),e.TgZ(26,"ion-select",14),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.registration.geschlecht=o)}),e.TgZ(27,"ion-select-option",15),e._uU(28,"weiblich"),e.qZA(),e.TgZ(29,"ion-select-option",15),e._uU(30,"m\xe4nnlich"),e.qZA()()(),e.TgZ(31,"ion-item-divider")(32,"ion-avatar",0),e._UZ(33,"img",16),e.qZA(),e.TgZ(34,"ion-label"),e._uU(35,"Einteilung"),e.qZA()(),e.TgZ(36,"ion-item")(37,"ion-avatar",0),e._uU(38," \xa0 "),e.qZA(),e.TgZ(39,"ion-label",12),e._uU(40,"Programm/Kategorie"),e.qZA(),e.TgZ(41,"ion-select",17),e.NdJ("ngModelChange",function(o){e.CHM(t);const a=e.oxw();return e.KtG(a.registration.programId=o)}),e.YNc(42,A,2,2,"ion-select-option",18),e.qZA()()(),e.TgZ(43,"ion-list")(44,"ion-button",19,20),e._UZ(46,"ion-icon",21),e._uU(47,"Speichern"),e.qZA()()()()}if(2&i){const t=e.MAs(2),n=e.oxw();e.xp6(9),e.Q6J("ngIf",0===n.registration.id&&n.clubAthletList.length>0),e.xp6(4),e.Q6J("disabled",!1)("ngModel",n.registration.name),e.xp6(1),e.Q6J("disabled",!1)("ngModel",n.registration.vorname),e.xp6(6),e.Q6J("disabled",!1)("ngModel",n.registration.gebdat),e.xp6(6),e.Q6J("ngModel",n.registration.geschlecht),e.xp6(1),e.Q6J("value","W"),e.xp6(2),e.Q6J("value","M"),e.xp6(12),e.Q6J("ngModel",n.registration.programId),e.xp6(1),e.Q6J("ngForOf",n.wkPgms),e.xp6(2),e.Q6J("disabled",n.waiting||!n.isFormValid()||!t.valid||t.untouched)}}function v(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"ion-button",23,24),e.NdJ("click",function(){e.CHM(t);const o=e.oxw();return e.KtG(o.delete())}),e._UZ(2,"ion-icon",25),e._uU(3,"Anmeldung l\xf6schen"),e.qZA()}if(2&i){const t=e.oxw();e.Q6J("disabled",t.waiting)}}const Z=[{path:"",component:(()=>{class i{constructor(t,n,o,a,d){this.navCtrl=t,this.route=n,this.backendService=o,this.alertCtrl=a,this.zone=d,this.waiting=!1}ngOnInit(){this.waiting=!0,this.wkId=this.route.snapshot.paramMap.get("wkId"),this.regId=parseInt(this.route.snapshot.paramMap.get("regId")),this.athletId=parseInt(this.route.snapshot.paramMap.get("athletId")),this.backendService.getCompetitions().subscribe(t=>{const n=t.find(o=>o.uuid===this.wkId);this.wettkampfId=parseInt(n.id),this.backendService.loadProgramsForCompetition(n.uuid).subscribe(o=>{this.wkPgms=o,this.backendService.loadAthletListForClub(this.wkId,this.regId).subscribe(a=>{this.clubAthletList=a,this.athletId?this.backendService.loadAthletRegistrations(this.wkId,this.regId).subscribe(d=>{this.clubAthletListCurrent=d,this.updateUI(d.find(x=>x.id===this.athletId))}):this.updateUI({id:0,vereinregistrationId:this.regId,name:"",vorname:"",geschlecht:"W",gebdat:void 0,programId:void 0,registrationTime:0})})})})}get selectedClubAthletId(){return this._selectedClubAthletId}set selectedClubAthletId(t){this._selectedClubAthletId=t,this.registration=this.clubAthletList.find(n=>n.athletId===t)}editable(){return this.backendService.loggedIn}updateUI(t){this.zone.run(()=>{this.waiting=!1,this.wettkampf=this.backendService.competitionName,this.registration=Object.assign({},t),this.registration.gebdat=(0,_.tC)(this.registration.gebdat)})}isFormValid(){return!!this.registration.gebdat&&!!this.registration.geschlecht&&this.registration.geschlecht.length>0&&!!this.registration.name&&this.registration.name.length>0&&!!this.registration.vorname&&this.registration.vorname.length>0&&!!this.registration.programId&&this.registration.programId>0}checkPersonOverride(t){if(t.athletId){const n=[...this.clubAthletListCurrent,...this.clubAthletList].find(o=>o.athletId===t.athletId);if(n.geschlecht!==t.geschlecht||new Date((0,_.tC)(n.gebdat)).toJSON()!==new Date(t.gebdat).toJSON()||n.name!==t.name||n.vorname!==t.vorname)return!0}return!1}save(t){if(!t.valid)return;const n=Object.assign({},this.registration,{gebdat:new Date(t.value.gebdat).toJSON()});0===this.athletId||0===n.id?this.backendService.createAthletRegistration(this.wkId,this.regId,n).subscribe(()=>{this.navCtrl.pop()}):this.checkPersonOverride(n)?this.alertCtrl.create({header:"Achtung",subHeader:"Person \xfcberschreiben vs korrigieren",message:"Es wurden \xc4nderungen an den Personen-Feldern vorgenommen. Diese sind ausschliesslich f\xfcr Korrekturen zul\xe4ssig. Die Identit\xe4t der Person darf dadurch nicht ge\xe4ndert werden!",buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"Korektur durchf\xfchren",handler:()=>{this.backendService.saveAthletRegistration(this.wkId,this.regId,n).subscribe(()=>{this.navCtrl.pop()})}}]}).then(d=>d.present()):this.backendService.saveAthletRegistration(this.wkId,this.regId,n).subscribe(()=>{this.navCtrl.pop()})}delete(){this.alertCtrl.create({header:"Achtung",subHeader:"L\xf6schen der Athlet-Anmeldung am Wettkampf",message:"Hiermit wird die Anmeldung von "+this.registration.name+", "+this.registration.vorname+" am Wettkampf gel\xf6scht.",buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"OKAY",handler:()=>{this.backendService.deleteAthletRegistration(this.wkId,this.regId,this.registration).subscribe(()=>{this.navCtrl.pop()})}}]}).then(n=>n.present())}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(r.SH),e.Y36(u.gz),e.Y36(m.v),e.Y36(r.Br),e.Y36(e.R0b))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-reg-athlet-editor"]],decls:14,vars:3,consts:[["slot","start"],["defaultHref","/"],["slot","end"],[1,"athlet"],[4,"ngIf"],["size","large","expand","block","color","danger",3,"disabled","click",4,"ngIf"],[3,"ngSubmit","keyup.enter"],["athletRegistrationForm","ngForm"],["src","assets/imgs/athlete.png"],["placeholder","Auswahl aus Liste","name","clubAthletid","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange",4,"ngIf"],["required","","placeholder","Name","type","text","name","name","required","",3,"disabled","ngModel","ngModelChange"],["required","","placeholder","Vorname","type","text","name","vorname","required","",3,"disabled","ngModel","ngModelChange"],["color","primary"],["required","","placeholder","Geburtsdatum","type","date","display-timezone","utc","name","gebdat","required","",3,"disabled","ngModel","ngModelChange"],["required","","placeholder","Geschlecht","name","geschlecht","okText","Okay","cancelText","Abbrechen","required","",3,"ngModel","ngModelChange"],[3,"value"],["src","assets/imgs/wettkampf.png"],["required","","placeholder","Programm/Kategorie","name","programId","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["size","large","expand","block","type","submit","color","success",3,"disabled"],["btnSaveNext",""],["slot","start","name",""],["placeholder","Auswahl aus Liste","name","clubAthletid","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange"],["size","large","expand","block","color","danger",3,"disabled","click"],["btnDelete",""],["slot","start","name","trash"]],template:function(t,n){1&t&&(e.TgZ(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e._UZ(3,"ion-back-button",1),e.qZA(),e.TgZ(4,"ion-title"),e._uU(5,"Anmeldung Athlet/Athletin"),e.qZA(),e.TgZ(6,"ion-note",2)(7,"div",3),e._uU(8),e.qZA()()()(),e.YNc(9,f,48,13,"ion-content",4),e.TgZ(10,"ion-footer")(11,"ion-toolbar")(12,"ion-list"),e.YNc(13,v,4,1,"ion-button",5),e.qZA()()()),2&t&&(e.xp6(8),e.hij("f\xfcr ",n.wettkampf,""),e.xp6(1),e.Q6J("ngIf",n.registration),e.xp6(4),e.Q6J("ngIf",n.athletId>0))},dependencies:[c.sg,c.O5,g._Y,g.JJ,g.JL,g.Q7,g.On,g.F,r.BJ,r.oU,r.YG,r.Sm,r.W2,r.fr,r.Gu,r.gu,r.pK,r.Ie,r.rH,r.Q$,r.q_,r.uN,r.t9,r.n0,r.wd,r.sr,r.QI,r.j9,r.cs,c.uU]}),i})()}];let I=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[c.ez,g.u5,r.Pc,u.Bz.forChild(Z)]}),i})()}}]);