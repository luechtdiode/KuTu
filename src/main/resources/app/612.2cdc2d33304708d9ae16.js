(self.webpackChunkresultcatcher=self.webpackChunkresultcatcher||[]).push([[612],{612:(e,t,i)=>{"use strict";i.r(t),i.d(t,{RegAthletEditorPageModule:()=>m});var n=i(8583),r=i(665),s=i(881),a=i(2859),o=i(7225),l=i(8186),d=i(600);function g(e,t){if(1&e&&(l.TgZ(0,"ion-select-option",15),l.TgZ(1,"ion-avatar",2),l._UZ(2,"img",8),l.qZA(),l.TgZ(3,"ion-label"),l._uU(4),l._UZ(5,"br"),l.TgZ(6,"small"),l._uU(7),l.ALo(8,"date"),l.qZA(),l.qZA(),l.qZA()),2&e){const e=t.$implicit;l.Q6J("value",e.athletId),l.xp6(4),l.lnq("",e.name,", ",e.vorname," (",e.geschlecht,")"),l.xp6(3),l.hij("(",l.lcZ(8,5,e.gebdat),")")}}function h(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"ion-select",22),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw(2).selectedClubAthletId=t}),l.YNc(1,g,9,7,"ion-select-option",18),l.qZA()}if(2&e){const e=l.oxw(2);l.Q6J("ngModel",e.selectedClubAthletId),l.xp6(1),l.Q6J("ngForOf",e.clubAthletList)}}function c(e,t){if(1&e&&(l.TgZ(0,"ion-select-option",15),l._uU(1),l.qZA()),2&e){const e=t.$implicit;l.Q6J("value",e.id),l.xp6(1),l.Oqu(e.name)}}function u(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"ion-content"),l.TgZ(1,"form",6,7),l.NdJ("ngSubmit",function(){l.CHM(e);const t=l.MAs(2);return l.oxw().save(t.value)})("keyup.enter",function(){l.CHM(e);const t=l.MAs(2);return l.oxw().save(t.value)}),l.TgZ(3,"ion-list"),l.TgZ(4,"ion-item-divider"),l.TgZ(5,"ion-avatar",0),l._UZ(6,"img",8),l.qZA(),l.TgZ(7,"ion-label"),l._uU(8,"Athlet / Athletin"),l.qZA(),l.YNc(9,h,2,2,"ion-select",9),l.qZA(),l.TgZ(10,"ion-item"),l.TgZ(11,"ion-avatar",0),l._uU(12," \xa0 "),l.qZA(),l.TgZ(13,"ion-input",10),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw().registration.name=t}),l.qZA(),l.TgZ(14,"ion-input",11),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw().registration.vorname=t}),l.qZA(),l.qZA(),l.TgZ(15,"ion-item"),l.TgZ(16,"ion-avatar",0),l._uU(17," \xa0 "),l.qZA(),l.TgZ(18,"ion-label",12),l._uU(19,"Geburtsdatum"),l.qZA(),l.TgZ(20,"ion-input",13),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw().registration.gebdat=t}),l.qZA(),l.qZA(),l.TgZ(21,"ion-item"),l.TgZ(22,"ion-avatar",0),l._uU(23," \xa0 "),l.qZA(),l.TgZ(24,"ion-label",12),l._uU(25,"Geschlecht"),l.qZA(),l.TgZ(26,"ion-select",14),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw().registration.geschlecht=t}),l.TgZ(27,"ion-select-option",15),l._uU(28,"weiblich"),l.qZA(),l.TgZ(29,"ion-select-option",15),l._uU(30,"m\xe4nnlich"),l.qZA(),l.qZA(),l.qZA(),l.TgZ(31,"ion-item-divider"),l.TgZ(32,"ion-avatar",0),l._UZ(33,"img",16),l.qZA(),l.TgZ(34,"ion-label"),l._uU(35,"Einteilung"),l.qZA(),l.qZA(),l.TgZ(36,"ion-item"),l.TgZ(37,"ion-avatar",0),l._uU(38," \xa0 "),l.qZA(),l.TgZ(39,"ion-label",12),l._uU(40,"Programm/Kategorie"),l.qZA(),l.TgZ(41,"ion-select",17),l.NdJ("ngModelChange",function(t){return l.CHM(e),l.oxw().registration.programId=t}),l.YNc(42,c,2,2,"ion-select-option",18),l.qZA(),l.qZA(),l.qZA(),l.TgZ(43,"ion-list"),l.TgZ(44,"ion-button",19,20),l._UZ(46,"ion-icon",21),l._uU(47,"Speichern"),l.qZA(),l.qZA(),l.qZA(),l.qZA()}if(2&e){const e=l.MAs(2),t=l.oxw();l.xp6(9),l.Q6J("ngIf",0===t.registration.id&&t.clubAthletList.length>0),l.xp6(4),l.Q6J("disabled",!1)("ngModel",t.registration.name),l.xp6(1),l.Q6J("disabled",!1)("ngModel",t.registration.vorname),l.xp6(6),l.Q6J("disabled",!1)("ngModel",t.registration.gebdat),l.xp6(6),l.Q6J("ngModel",t.registration.geschlecht),l.xp6(1),l.Q6J("value","W"),l.xp6(2),l.Q6J("value","M"),l.xp6(12),l.Q6J("ngModel",t.registration.programId),l.xp6(1),l.Q6J("ngForOf",t.wkPgms),l.xp6(2),l.Q6J("disabled",t.waiting||!t.isFormValid()||!e.valid||e.untouched)}}function b(e,t){if(1&e){const e=l.EpF();l.TgZ(0,"ion-button",23,24),l.NdJ("click",function(){return l.CHM(e),l.oxw().delete()}),l._UZ(2,"ion-icon",25),l._uU(3,"Anmeldung l\xf6schen"),l.qZA()}if(2&e){const e=l.oxw();l.Q6J("disabled",e.waiting)}}const p=[{path:"",component:(()=>{class e{constructor(e,t,i,n,r){this.navCtrl=e,this.route=t,this.backendService=i,this.alertCtrl=n,this.zone=r,this.waiting=!1}ngOnInit(){this.waiting=!0,this.wkId=this.route.snapshot.paramMap.get("wkId"),this.regId=parseInt(this.route.snapshot.paramMap.get("regId")),this.athletId=parseInt(this.route.snapshot.paramMap.get("athletId")),this.backendService.getCompetitions().subscribe(e=>{const t=e.find(e=>e.uuid===this.wkId);this.wettkampfId=parseInt(t.id),this.backendService.loadProgramsForCompetition(t.uuid).subscribe(e=>{this.wkPgms=e,this.backendService.loadAthletListForClub(this.wkId,this.regId).subscribe(e=>{this.clubAthletList=e,this.athletId?this.backendService.loadAthletRegistrations(this.wkId,this.regId).subscribe(e=>{this.clubAthletListCurrent=e,this.updateUI(e.find(e=>e.id===this.athletId))}):this.updateUI({id:0,vereinregistrationId:this.regId,name:"",vorname:"",geschlecht:"W",gebdat:void 0,programId:void 0,registrationTime:0})})})})}get selectedClubAthletId(){return this._selectedClubAthletId}set selectedClubAthletId(e){this._selectedClubAthletId=e,this.registration=this.clubAthletList.find(t=>t.athletId===e)}editable(){return this.backendService.loggedIn}updateUI(e){this.zone.run(()=>{this.waiting=!1,this.wettkampf=this.backendService.competitionName,this.registration=Object.assign({},e),this.registration.gebdat=(0,o.tC)(this.registration.gebdat)})}isFormValid(){return!!this.registration.gebdat&&!!this.registration.geschlecht&&this.registration.geschlecht.length>0&&!!this.registration.name&&this.registration.name.length>0&&!!this.registration.vorname&&this.registration.vorname.length>0&&!!this.registration.programId&&this.registration.programId>0}checkPersonOverride(e){if(e.athletId){const t=[...this.clubAthletListCurrent,...this.clubAthletList].find(t=>t.athletId===e.athletId);if(t.geschlecht!==e.geschlecht||new Date((0,o.tC)(t.gebdat)).toJSON()!==new Date(e.gebdat).toJSON()||t.name!==e.name||t.vorname!==e.vorname)return!0}return!1}save(e){const t=Object.assign({},this.registration,{gebdat:new Date(e.gebdat).toJSON()});0===this.athletId||0===t.id?this.backendService.createAthletRegistration(this.wkId,this.regId,t).subscribe(()=>{this.navCtrl.pop()}):this.checkPersonOverride(t)?this.alertCtrl.create({header:"Achtung",subHeader:"Person \xfcberschreiben vs korrigieren",message:"Es wurden \xc4nderungen an den Personen-Feldern vorgenommen. Diese sind ausschliesslich f\xfcr Korrekturen zul\xe4ssig. Die Identit\xe4t der Person darf dadurch nicht ge\xe4ndert werden!",buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"Korektur durchf\xfchren",handler:()=>{this.backendService.saveAthletRegistration(this.wkId,this.regId,t).subscribe(()=>{this.navCtrl.pop()})}}]}).then(e=>e.present()):this.backendService.saveAthletRegistration(this.wkId,this.regId,t).subscribe(()=>{this.navCtrl.pop()})}delete(){this.alertCtrl.create({header:"Achtung",subHeader:"L\xf6schen der Athlet-Anmeldung am Wettkampf",message:"Hiermit wird die Anmeldung von "+this.registration.name+", "+this.registration.vorname+" am Wettkampf gel\xf6scht.",buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"OKAY",handler:()=>{this.backendService.deleteAthletRegistration(this.wkId,this.regId,this.registration).subscribe(()=>{this.navCtrl.pop()})}}]}).then(e=>e.present())}}return e.\u0275fac=function(t){return new(t||e)(l.Y36(a.SH),l.Y36(s.gz),l.Y36(d.v),l.Y36(a.Br),l.Y36(l.R0b))},e.\u0275cmp=l.Xpm({type:e,selectors:[["app-reg-athlet-editor"]],decls:14,vars:3,consts:[["slot","start"],["defaultHref","/"],["slot","end"],[1,"athlet"],[4,"ngIf"],["size","large","expand","block","color","danger",3,"disabled","click",4,"ngIf"],[3,"ngSubmit","keyup.enter"],["athletRegistrationForm","ngForm"],["src","assets/imgs/athlete.png"],["placeholder","Auswahl aus Liste","name","clubAthletid","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange",4,"ngIf"],["required","","placeholder","Name","type","text","name","name","required","",3,"disabled","ngModel","ngModelChange"],["required","","placeholder","Vorname","type","text","name","vorname","required","",3,"disabled","ngModel","ngModelChange"],["color","primary"],["required","","placeholder","Geburtsdatum","type","date","display-timezone","utc","name","gebdat","required","",3,"disabled","ngModel","ngModelChange"],["required","","placeholder","Geschlecht","name","geschlecht","okText","Okay","cancelText","Abbrechen","required","",3,"ngModel","ngModelChange"],[3,"value"],["src","assets/imgs/wettkampf.png"],["required","","placeholder","Programm/Kategorie","name","programId","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange"],[3,"value",4,"ngFor","ngForOf"],["size","large","expand","block","type","submit","color","success",3,"disabled"],["btnSaveNext",""],["slot","start","name",""],["placeholder","Auswahl aus Liste","name","clubAthletid","okText","Okay","cancelText","Abbrechen",3,"ngModel","ngModelChange"],["size","large","expand","block","color","danger",3,"disabled","click"],["btnDelete",""],["slot","start","name","trash"]],template:function(e,t){1&e&&(l.TgZ(0,"ion-header"),l.TgZ(1,"ion-toolbar"),l.TgZ(2,"ion-buttons",0),l._UZ(3,"ion-back-button",1),l.qZA(),l.TgZ(4,"ion-title"),l._uU(5,"Anmeldung Athlet/Athletin"),l.qZA(),l.TgZ(6,"ion-note",2),l.TgZ(7,"div",3),l._uU(8),l.qZA(),l.qZA(),l.qZA(),l.qZA(),l.YNc(9,u,48,13,"ion-content",4),l.TgZ(10,"ion-footer"),l.TgZ(11,"ion-toolbar"),l.TgZ(12,"ion-list"),l.YNc(13,b,4,1,"ion-button",5),l.qZA(),l.qZA(),l.qZA()),2&e&&(l.xp6(8),l.hij("f\xfcr ",t.wettkampf,""),l.xp6(1),l.Q6J("ngIf",t.registration),l.xp6(4),l.Q6J("ngIf",t.athletId>0))},directives:[a.Gu,a.sr,a.Sm,a.oU,a.cs,a.wd,a.uN,n.O5,a.fr,a.q_,a.W2,r._Y,r.JL,r.F,a.rH,a.BJ,a.Q$,a.Ie,a.pK,a.j9,r.Q7,r.JJ,r.On,a.t9,a.QI,a.n0,n.sg,a.YG,a.gu],pipes:[n.uU],styles:[""]}),e})()}];let m=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=l.oAB({type:e}),e.\u0275inj=l.cJS({imports:[[n.ez,r.u5,a.Pc,s.Bz.forChild(p)]]}),e})()}}]);