"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4688],{4688:(D,h,o)=>{o.r(h),o.d(h,{AthletViewPageModule:()=>x});var c=o(6396),p=o(4341),f=o(9355),r=o(7125),d=o(5964),v=o(6354),I=o(8103),g=o(1158),e=o(7241),m=o(8564),w=o(2872),k=o(8325),T=o(2350);const u=s=>({"gradient-border":s});function b(s,l){if(1&s){const t=e.RV6();e.j41(0,"ion-button",8),e.bIt("click",function(){m.eBV(t);const n=e.XpG();return m.Njj(n.share())}),e.nrm(1,"ion-icon",9),e.k0s()}}function S(s,l){if(1&s&&(e.j41(0,"ion-col")(1,"ion-note"),e.EFF(2),e.k0s(),e.j41(3,"ion-label")(4,"div",10),e.EFF(5),e.k0s(),e.j41(6,"div",11),e.EFF(7),e.k0s()()()),2&s){const t=e.XpG();e.R7$(2),e.SpI(" ",t.competitionName()," "),e.R7$(3),e.JRh(t.athlet.vorname+" "+t.athlet.name),e.R7$(2),e.JRh(t.athlet.verein)}}function z(s,l){if(1&s&&(e.j41(0,"ion-col",13)(1,"div",14),e.nrm(2,"result-display",7),e.k0s()()),2&s){const t=l.$implicit,i=e.XpG(2);e.BMQ("size-xl",i.getMaxColumnSpec()),e.R7$(),e.Y8G("ngClass",e.eq3(5,u,i.isNew(t))),e.R7$(),e.Y8G("item",t)("title",i.getTitle(t))("groupedBy",i.groupBy.ATHLET)}}function $(s,l){if(1&s&&(e.j41(0,"ion-row"),e.DNE(1,z,3,7,"ion-col",12),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.items)}}function A(s,l){if(1&s&&(e.j41(0,"ion-col",16)(1,"div",14),e.nrm(2,"result-display",7),e.k0s()()),2&s){const t=l.$implicit,i=e.XpG(2);e.BMQ("size-xl",i.getMaxColumnSpec()),e.R7$(),e.Y8G("ngClass",e.eq3(5,u,i.isNew(t))),e.R7$(),e.Y8G("item",t)("title",i.getTitle(t))("groupedBy",i.groupBy.ATHLET)}}function C(s,l){if(1&s&&(e.j41(0,"ion-row"),e.DNE(1,A,3,7,"ion-col",15),e.k0s()),2&s){const t=e.XpG();e.R7$(),e.Y8G("ngForOf",t.items)}}let G=(()=>{class s{navCtrl;route;backendService;groupBy=g.R;items=[];lastItems=[];geraete=[];athletId;wkId;constructor(t,i,n){this.navCtrl=t,this.route=i,this.backendService=n,this.backendService.competitions||this.backendService.getCompetitions()}makeItemHash(t){return t.id*this.geraete.length*200+100*t.geraet+(t.wertung.endnote||-1)}ngOnInit(){this.athletId=parseInt(this.route.snapshot.paramMap.get("athletId")),this.wkId=this.route.snapshot.paramMap.get("wkId"),this.backendService.loadAthletWertungen(this.wkId,this.athletId).pipe((0,d.p)(i=>!!i&&i.length>0)).subscribe(i=>{this.items=i,this.sortItems(this.athletId)}),this.backendService.geraeteSubject.subscribe(i=>{this.backendService.captionmode||(this.geraete=i)}),this.backendService.newLastResults.pipe((0,d.p)(i=>!!i),(0,v.T)(i=>i.results)).subscribe(i=>{this.lastItems=this.items.map(n=>this.makeItemHash(n)),this.items=this.items.map(n=>{const a=i[n.wertung.wettkampfdisziplinId];return a&&a.id===n.id?a:n})})}sortItems(t){this.items.sort((i,n)=>{let a=i.programm.localeCompare(n.programm);return 0===a&&(a=this.geraetOrder(i.geraet)-this.geraetOrder(n.geraet)),a})}isNew(t){const i=this.makeItemHash(t);return 0===this.lastItems.filter(n=>n===i).length}get total(){const t=this.items&&this.items.length>0?{programm:"",geraet:0,id:0,vorname:this.items[0].vorname,name:this.items[0].name,geschlecht:this.items[0].geschlecht,verein:this.items[0].verein,wertung:{noteE:0,noteD:0,endnote:0,wettkampfdisziplinId:0},isDNoteUsed:this.items[0].isDNoteUsed}:{vorname:"",name:"",geschlecht:"",verein:"",programm:"",geraet:0,id:0,wertung:{noteE:0,noteD:0,endnote:0,wettkampfdisziplinId:0},isDNoteUsed:!1};return this.items&&this.items.length>0?this.items.reduce((i,n)=>(t.wertung.noteE+=n.wertung.noteE||0,t.wertung.noteD+=n.wertung.noteD||0,t.wertung.endnote+=n.wertung.endnote||0,t),t):t}get stationFreezed(){return this.backendService.stationFreezed}get competition(){return this.backendService.competition||""}getCompetitions(){return this.backendService.competitions||[]}competitionContainer(){const t={titel:"",datum:new Date,auszeichnung:void 0,auszeichnungendnote:void 0,id:void 0,uuid:void 0,programmId:0};if(!this.backendService.competitions)return t;const i=this.backendService.competitions.filter(n=>n.uuid===this.backendService.competition);return 1===i.length?i[0]:t}competitionName(){const t=this.competitionContainer();return""===t.titel?"":t.titel+", am "+(t.datum+"T").split("T")[0].split("-").reverse().join("-")}get athlet(){return this.items&&this.items.length>0?this.items[0]:{}}getColumnSpec(){return this.geraete.length}getMaxColumnSpec(){return Math.min(12,Math.max(1,Math.floor(12/this.items.length+.5)))}geraetOrder(t){return this.geraete?this.geraete.findIndex(n=>n.id===t):0}geraetText(t){if(!this.geraete)return"";const i=this.geraete.filter(n=>n.id===t).map(n=>n.name);return 1===i.length?i[0]:""}getTitle(t){return t?t.programm+" - "+this.geraetText(t.geraet):"Total Punkte"}isShareAvailable(){return!!navigator&&!!navigator.share}share(){let t="GeTu";const n=this.competitionContainer();""!==n.titel&&(t={1:"Athletik",11:"KuTu",20:"GeTu",31:"KuTu"}[n.programmId]);let a=`${this.items[0].vorname} ${this.items[0].name}, ${this.items[0].verein} #${t}-${n.titel.replace(","," ").split(" ").join("_")}_${this.items[0].programm} #${this.items[0].verein.replace(","," ").split(" ").join("_")}`;a=new Date(n.datum).getTime()>Date.now()?"Hoffe das Beste f\xfcr "+a:"Geschafft! Wettkampf Resultate von "+a,this.isShareAvailable()&&navigator.share({title:this.competitionName(),text:a,url:`${I.EV}athlet-view/${this.wkId}/${this.athletId}`}).then(function(){console.log("Article shared")}).catch(function(F){console.log(F.message)})}static \u0275fac=function(i){return new(i||s)(e.rXU(w.q9),e.rXU(k.nX),e.rXU(T.m))};static \u0275cmp=e.VBU({type:s,selectors:[["app-athlet-view"]],standalone:!1,decls:22,vars:7,consts:[["slot","start"],["defaultHref","/"],["no-padding",""],["slot","end"],["slot","end",3,"click",4,"ngIf"],[4,"ngIf"],["size-xs","12","size-md","12","size-lg","12","size-xl","12",1,"align-self-start"],[3,"item","title","groupedBy"],["slot","end",3,"click"],["name","share"],[2,"font-size","16pt"],[2,"font-size","10pt"],["class","align-self-start","size-xs","12","size-md","6","size-lg","4",4,"ngFor","ngForOf"],["size-xs","12","size-md","6","size-lg","4",1,"align-self-start"],[3,"ngClass"],["class","align-self-start","size-xs","12","size-md","6","size-lg","3",4,"ngFor","ngForOf"],["size-xs","12","size-md","6","size-lg","3",1,"align-self-start"]],template:function(i,n){1&i&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0),e.nrm(3,"ion-back-button",1),e.k0s(),e.j41(4,"ion-title")(5,"ion-grid",2)(6,"ion-row")(7,"ion-col")(8,"ion-label"),e.EFF(9,"Aktuelle Resultate"),e.k0s()()()()(),e.j41(10,"ion-buttons",3),e.DNE(11,b,2,0,"ion-button",4),e.k0s()(),e.j41(12,"ion-grid",2)(13,"ion-row"),e.DNE(14,S,8,3,"ion-col",5),e.k0s()()(),e.j41(15,"ion-content")(16,"ion-grid",2),e.DNE(17,$,2,1,"ion-row",5)(18,C,2,1,"ion-row",5),e.j41(19,"ion-row")(20,"ion-col",6),e.nrm(21,"result-display",7),e.k0s()()()()),2&i&&(e.R7$(11),e.Y8G("ngIf",n.isShareAvailable()),e.R7$(3),e.Y8G("ngIf",n.competition),e.R7$(3),e.Y8G("ngIf",6===n.getColumnSpec()),e.R7$(),e.Y8G("ngIf",6!==n.getColumnSpec()),e.R7$(3),e.Y8G("item",n.total)("title",n.getTitle(void 0))("groupedBy",n.groupBy.ATHLET))},dependencies:[c.YU,c.Sq,c.bT,r.Jm,r.QW,r.hU,r.W9,r.lO,r.eU,r.iq,r.he,r.JI,r.ln,r.BC,r.ai,r.el,g.v],encapsulation:2})}return s})();var R=o(5079);const j=[{path:"",component:G}];let x=(()=>{class s{static \u0275fac=function(i){return new(i||s)};static \u0275mod=e.$C({type:s});static \u0275inj=m.G2t({imports:[c.MD,p.YN,r.bv,f.iI.forChild(j),R.h]})}return s})()}}]);