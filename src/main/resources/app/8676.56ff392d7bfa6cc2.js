"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8676],{8676:(Y,u,o)=>{o.r(u),o.d(u,{ClubregEditorPageModule:()=>x});var m=o(6396),c=o(4341),p=o(9355),r=o(7125),b=o(467),f=o(6697),_=o(8103),e=o(7241),l=o(8564),C=o(2872),k=o(8325),v=o(2350);function I(s,g){if(1&s&&(e.j41(0,"ion-item")(1,"ion-radio",7),e.EFF(2),e.k0s()()),2&s){const t=g.$implicit;e.R7$(),e.Y8G("value",t),e.R7$(),e.JRh(t.text)}}let w=(()=>{class s{items=[];selectedItem;title="Select Items";selectionCancel=new e.bkB;selectionChange=new e.bkB;filteredItems=[];workingSelectedValue=void 0;ngOnInit(){this.filteredItems=[...this.items],this.workingSelectedValue={item:this.selectedItem,text:this.items.find(t=>t.item===this.selectedItem)?.text}}cancelChanges(){this.selectionCancel.emit()}confirmChanges(){this.selectionChange.emit(this.workingSelectedValue?.item)}searchbarInput(t){this.filterList(t.target.value)}filterList(t){if(void 0===t)this.filteredItems=[...this.items];else{const n=t.toLowerCase();this.filteredItems=this.items.filter(i=>i.text.toLowerCase().includes(n))}}get selected(){return this.workingSelectedValue}set selected(t){this.workingSelectedValue=t}static \u0275fac=function(n){return new(n||s)};static \u0275cmp=e.VBU({type:s,selectors:[["app-typeahead"]],inputs:{items:"items",selectedItem:"selectedItem",title:"title"},outputs:{selectionCancel:"selectionCancel",selectionChange:"selectionChange"},standalone:!1,decls:18,vars:4,consts:[[3,"ionInput","ngModel"],["color","light",1,"ion-padding"],[3,"ngModelChange","ngModel"],[4,"ngFor","ngForOf"],["slot","start"],[3,"click"],["slot","end"],[1,"alert-radio-label","sc-ion-alert-md",3,"value"]],template:function(n,i){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-title"),e.EFF(3),e.k0s()(),e.j41(4,"ion-toolbar")(5,"ion-searchbar",0),e.bIt("ionInput",function(d){return i.searchbarInput(d)}),e.k0s()()(),e.j41(6,"ion-content",1)(7,"ion-radio-group",2),e.mxI("ngModelChange",function(d){return e.DH7(i.selected,d)||(i.selected=d),d}),e.j41(8,"ion-list"),e.DNE(9,I,3,2,"ion-item",3),e.k0s()()(),e.j41(10,"ion-footer")(11,"ion-toolbar")(12,"ion-buttons",4)(13,"ion-button",5),e.bIt("click",function(){return i.cancelChanges()}),e.EFF(14,"Abbrechen"),e.k0s()(),e.j41(15,"ion-buttons",6)(16,"ion-button",5),e.bIt("click",function(){return i.confirmChanges()}),e.EFF(17,"Okay"),e.k0s()()()()),2&n&&(e.R7$(3),e.JRh(i.title),e.R7$(2),e.Y8G("ngModel",null==i.selected?null:i.selected.text),e.R7$(2),e.R50("ngModel",i.selected),e.R7$(2),e.Y8G("ngForOf",i.filteredItems))},dependencies:[m.Sq,c.BC,c.vS,r.Jm,r.QW,r.W9,r.M0,r.eU,r.uz,r.nf,r.KO,r.f0,r.S1,r.BC,r.ai,r.Je,r.Gw],encapsulation:2})}return s})();function y(s,g){1&s&&(e.j41(0,"ion-button",27),e.nrm(1,"ion-icon",28),e.EFF(2,"\xa0\xa0 Verein aus liste ausw\xe4hlen ..."),e.k0s())}function R(s,g){if(1&s){const t=e.RV6();e.j41(0,"app-typeahead",30),e.bIt("selectionChange",function(i){l.eBV(t),e.XpG();const a=e.sdS(1);return e.XpG(2).setVereinSelected(i),l.Njj(a.dismiss())})("selectionCancel",function(){l.eBV(t),e.XpG();const i=e.sdS(1);return l.Njj(i.dismiss())}),e.k0s()}if(2&s){const t=e.XpG(3);e.Y8G("items",t.clublist)("selectedItem",t.getVereinSelected)}}function S(s,g){1&s&&(e.j41(0,"ion-modal",29,2),e.DNE(2,R,1,2,"ng-template"),e.k0s())}function P(s,g){if(1&s&&(e.j41(0,"ion-item")(1,"ion-avatar",4),e.nrm(2,"img",31),e.k0s(),e.nrm(3,"ion-input",32)(4,"ion-input",33),e.k0s()),2&s){const t=e.XpG(2);e.R7$(3),e.Y8G("readonly",!1)("disabled",!1)("ngModel",t.newRegistration.secret),e.R7$(),e.Y8G("readonly",!1)("disabled",!1)("ngModel",t.newRegistration.verification)}}function E(s,g){if(1&s){const t=e.RV6();e.j41(0,"ion-item")(1,"ion-avatar",4),e.nrm(2,"img",31),e.k0s(),e.j41(3,"ion-input",34),e.mxI("ngModelChange",function(i){l.eBV(t);const a=e.XpG(2);return e.DH7(a.changePassword.secret,i)||(a.changePassword.secret=i),l.Njj(i)}),e.k0s(),e.j41(4,"ion-input",35),e.mxI("ngModelChange",function(i){l.eBV(t);const a=e.XpG(2);return e.DH7(a.changePassword.verification,i)||(a.changePassword.verification=i),l.Njj(i)}),e.k0s()()}if(2&s){const t=e.XpG(2);e.R7$(3),e.Y8G("readonly",!1)("disabled",!1),e.R50("ngModel",t.changePassword.secret),e.R7$(),e.Y8G("readonly",!1)("disabled",!1),e.R50("ngModel",t.changePassword.verification)}}function F(s,g){if(1&s){const t=e.RV6();e.j41(0,"ion-item")(1,"ion-avatar",4),e.EFF(2," \xa0 "),e.k0s(),e.j41(3,"ion-button",36,3),e.bIt("click",function(){l.eBV(t);const i=e.XpG(2);return l.Njj(i.savePWChange())}),e.nrm(5,"ion-icon",25),e.EFF(6,"Passwort \xe4ndern "),e.k0s()()}if(2&s){const t=e.XpG(2);e.R7$(3),e.Y8G("disabled",t.waiting||!t.changePassword.secret||t.changePassword.secret!==t.changePassword.verification)}}function A(s,g){if(1&s&&(e.j41(0,"ion-item"),e.EFF(1),e.k0s()),2&s){const t=g.$implicit;e.R7$(),e.SpI(" ",t," ")}}function j(s,g){if(1&s){const t=e.RV6();e.j41(0,"ion-content"),e.DNE(1,y,3,0,"ion-button",11)(2,S,3,0,"ion-modal",12),e.j41(3,"form",13,0),e.bIt("ngSubmit",function(){l.eBV(t);const i=e.sdS(4),a=e.XpG();return l.Njj(a.save(i))})("keyup.enter",function(){l.eBV(t);const i=e.sdS(4),a=e.XpG();return l.Njj(a.save(i))}),e.j41(5,"ion-list")(6,"ion-item-divider",14),e.EFF(7,"Verein"),e.k0s(),e.j41(8,"ion-item")(9,"ion-avatar",4),e.nrm(10,"img",15),e.k0s(),e.nrm(11,"ion-input",16)(12,"ion-input",17),e.k0s(),e.j41(13,"ion-item-divider",14),e.EFF(14,"Verantwortliche Person"),e.k0s(),e.j41(15,"ion-item")(16,"ion-avatar",4),e.nrm(17,"img",18),e.k0s(),e.nrm(18,"ion-input",19)(19,"ion-input",20),e.k0s(),e.DNE(20,P,5,6,"ion-item",8)(21,E,5,6,"ion-item",8)(22,F,7,1,"ion-item",8),e.j41(23,"ion-item-divider",14),e.EFF(24,"Kontakt"),e.k0s(),e.j41(25,"ion-item")(26,"ion-avatar",4),e.nrm(27,"img",21),e.k0s(),e.nrm(28,"ion-input",22)(29,"ion-input",23),e.k0s()(),e.j41(30,"ion-button",24,1),e.nrm(32,"ion-icon",25),e.EFF(33,"Speichern "),e.k0s()(),e.j41(34,"ion-list")(35,"ion-item-divider",14),e.EFF(36),e.k0s(),e.DNE(37,A,2,1,"ion-item",26),e.k0s()()}if(2&s){const t=e.sdS(4),n=e.XpG();e.R7$(),e.Y8G("ngIf",0===n.regId),e.R7$(),e.Y8G("ngIf",0===n.regId),e.R7$(9),e.Y8G("readonly",!1)("autofocus",!0)("disabled",!1)("ngModel",n.registration.vereinname),e.R7$(),e.Y8G("readonly",!1)("disabled",!1)("ngModel",n.registration.verband),e.R7$(6),e.Y8G("readonly",!1)("disabled",!1)("ngModel",n.registration.respVorname),e.R7$(),e.Y8G("readonly",!1)("disabled",!1)("ngModel",n.registration.respName),e.R7$(),e.Y8G("ngIf",0===n.regId),e.R7$(),e.Y8G("ngIf",n.regId>0),e.R7$(),e.Y8G("ngIf",n.regId>0),e.R7$(6),e.Y8G("readonly",!1)("disabled",!1)("ngModel",n.registration.mail),e.R7$(),e.Y8G("readonly",!1)("disabled",!1)("ngModel",n.registration.mobilephone),e.R7$(),e.Y8G("disabled",n.waiting||!t.valid||t.untouched),e.R7$(6),e.SpI("Pendente Verarbeitungen (",n.sSyncActions.length,")"),e.R7$(),e.Y8G("ngForOf",n.sSyncActions)}}let V=(()=>{class s{navCtrl;route;backendService;alertCtrl;actionSheetController;zone;constructor(t,n,i,a,d,T){this.navCtrl=t,this.route=n,this.backendService=i,this.alertCtrl=a,this.actionSheetController=d,this.zone=T,this.backendService.competitions||this.backendService.getCompetitions(),this.backendService.getClubList().subscribe($=>{this.clublist=$.map(h=>({item:h,text:h.name+" ("+h.verband+")"}))})}_selectedVerein;get getVereinSelected(){return this._selectedVerein}setVereinSelected(t){this._selectedVerein=t,this.newRegistration.vereinname=t.name,this.newRegistration.verband=t.verband}waiting=!1;registration;newRegistration;changePassword;sSyncActions=[];clublist=[];wettkampf;regId;wkId;wettkampfId;ngOnInit(){this.waiting=!0,this.wkId=this.route.snapshot.paramMap.get("wkId"),this.regId=parseInt(this.route.snapshot.paramMap.get("regId")),this.backendService.getCompetitions().subscribe(t=>{this.wettkampfId=parseInt(t.find(n=>n.uuid===this.wkId).id),this.regId?this.backendService.getClubRegistrations(this.wkId).subscribe(n=>{n&&n.length>0&&this.updateUI(n.find(i=>i.id===this.regId))}):this.updateUI({mobilephone:"+417"})})}filter(t){const n=t.toUpperCase().split(" ");return i=>"*"===t.trim()||n.filter(a=>{if(i.name.toUpperCase().indexOf(a)>-1||i.verband.toUpperCase().indexOf(a)>-1)return!0}).length===n.length}presentActionSheet(){var t=this;return(0,b.A)(function*(){let n={};n=t.registration.vereinId?{header:"Anmeldungen",cssClass:"my-actionsheet-class",buttons:[{text:"Athlet & Athletinnen",icon:"list",handler:()=>{t.editAthletRegistrations()}},{text:"Wertungsrichter",icon:"glasses",handler:()=>{t.editJudgeRegistrations()}},{text:"Kopieren aus anderem Wettkampf",icon:"share",handler:()=>{t.copyFromOthers()}},{text:"Registrierung l\xf6schen",role:"destructive",icon:"trash",handler:()=>{t.delete()}},{text:"Abbrechen",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]}:{header:"Anmeldungen",cssClass:"my-actionsheet-class",buttons:[{text:"Athlet & Athletinnen",icon:"list",handler:()=>{t.editAthletRegistrations()}},{text:"Wertungsrichter",icon:"glasses",handler:()=>{t.editJudgeRegistrations()}},{text:"Registrierung l\xf6schen",role:"destructive",icon:"trash",handler:()=>{t.delete()}},{text:"Abbrechen",icon:"close",role:"cancel",handler:()=>{console.log("Cancel clicked")}}]},yield(yield t.actionSheetController.create(n)).present()})()}editable(){return this.backendService.loggedIn}ionViewWillEnter(){this.getSyncActions()}getSyncActions(){this.regId>0&&this.backendService.loadRegistrationSyncActions().pipe((0,f.s)(1)).subscribe(t=>{this.sSyncActions=t.filter(n=>n.verein.id===this.registration.id).map(n=>n.caption)})}updateUI(t){this.zone.run(()=>{this.waiting=!1,this.wettkampf=this.backendService.competitionName,this.registration=t,t&&(0===this.regId?this.newRegistration=t:this.changePassword={id:this.regId,wettkampfId:t.wettkampfId||this.wettkampfId,secret:"",verification:""},this.registration.mail&&this.registration.mail.length>1&&(this.backendService.currentUserName=this.registration.mail))})}savePWChange(){this.changePassword&&this.changePassword.secret&&this.changePassword.secret===this.changePassword.verification&&this.backendService.saveClubRegistrationPW(this.wkId,this.changePassword)}save(t){if(!t.valid)return;const n=t.value;if(0===this.regId){const i=n;i.secret!==i.verification?this.alertCtrl.create({header:"Achtung",subHeader:"Passwort-Verifikation",message:"Das Passwort stimmt nicht mit der Verifikation \xfcberein. Beide m\xfcssen genau gleich erfasst sein.",buttons:[{text:"OKAY",role:"cancel",handler:()=>{}}]}).then(d=>d.present()):this.backendService.createClubRegistration(this.wkId,{mail:i.mail,mobilephone:i.mobilephone,respName:i.respName,respVorname:i.respVorname,verband:i.verband,vereinname:i.vereinname,wettkampfId:i.wettkampfId||this.wettkampfId,secret:i.secret}).subscribe(d=>{this.regId=d.id,this.registration=d,this.backendService.currentUserName=d.mail,this.presentActionSheet()})}else this.backendService.saveClubRegistration(this.wkId,{id:this.registration.id,registrationTime:this.registration.registrationTime,vereinId:this.registration.vereinId,mail:n.mail,mobilephone:n.mobilephone,respName:n.respName,respVorname:n.respVorname,verband:n.verband,vereinname:n.vereinname,wettkampfId:n.wettkampfId||this.wettkampfId})}delete(){this.alertCtrl.create({header:"Achtung",subHeader:"L\xf6schen der Vereins-Registrierung und dessen Anmeldungen am Wettkampf",message:"Hiermit wird die Vereinsanmeldung am Wettkampf komplett gel\xf6scht.",buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"OKAY",handler:()=>{this.backendService.deleteClubRegistration(this.wkId,this.regId).subscribe(()=>{this.navCtrl.pop()})}}]}).then(n=>n.present())}editAthletRegistrations(){this.navCtrl.navigateForward(`reg-athletlist/${this.backendService.competition}/${this.regId}`)}editJudgeRegistrations(){this.navCtrl.navigateForward(`reg-judgelist/${this.backendService.competition}/${this.regId}`)}copyFromOthers(){this.backendService.findCompetitionsByVerein(this.registration.vereinId).subscribe(t=>{const n=t.map(i=>({type:"radio",label:i.titel+" ("+(0,_.HN)(i.datum)+")",value:i}));this.alertCtrl.create({header:"Anmeldungen kopieren",cssClass:"my-optionselection-class",message:"Aus welchem Wettkampf sollen die Anmeldungen kopiert werden?",inputs:n,buttons:[{text:"ABBRECHEN",role:"cancel",handler:()=>{}},{text:"OKAY",handler:i=>{this.backendService.copyClubRegsFromCompetition(i,this.backendService.competition,this.registration.id).subscribe(()=>{this.getSyncActions(),this.alertCtrl.create({header:"Anmeldungen kopieren",message:"Alle nicht bereits erfassten Anmeldungen wurden \xfcbernommen.",buttons:[{text:"OKAY",role:"cancel",handler:()=>{}},{text:"> Athlet-Anmeldungen",handler:()=>{this.editAthletRegistrations()}},{text:"> WR Anmeldungen",handler:()=>{this.editJudgeRegistrations()}}]}).then(a=>a.present())})}}]}).then(i=>i.present())})}static \u0275fac=function(n){return new(n||s)(e.rXU(C.q9),e.rXU(k.nX),e.rXU(v.m),e.rXU(r.hG),e.rXU(r.GD),e.rXU(e.SKi))};static \u0275cmp=e.VBU({type:s,selectors:[["app-clubreg-editor"]],standalone:!1,decls:15,vars:3,consts:[["clubRegistrationform","ngForm"],["btnSaveNext",""],["modal",""],["btnChangePassword",""],["slot","start"],["defaultHref","/"],["slot","end"],[1,"athlet"],[4,"ngIf"],["size","large","expand","block","color","primary",3,"click","disabled"],["slot","start","name","list"],["id","searchClubPresets","size","large","expand","block",4,"ngIf"],["trigger","searchClubPresets",4,"ngIf"],[3,"ngSubmit","keyup.enter"],["color","primary"],["src","assets/imgs/verein.png"],["placeholder","Vereinsname","autocomplete","true","type","text","name","vereinname","required","",3,"readonly","autofocus","disabled","ngModel"],["placeholder","Verband","autocomplete","true","type","text","name","verband","required","",3,"readonly","disabled","ngModel"],["src","assets/imgs/chief.png"],["placeholder","Vorname","type","text","autocomplete","given-name","name","respVorname","required","",3,"readonly","disabled","ngModel"],["placeholder","Nachname","type","text","autocomplete","name","name","respName","required","",3,"readonly","disabled","ngModel"],["src","assets/imgs/atmail.png"],["placeholder","Mail","type","email","autocomplete","email","pattern","^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*(\\.[a-z]{2,5})$","name","mail","required","",3,"readonly","disabled","ngModel"],["placeholder","Mobile/SMS (+4179...)","type","tel","autocomplete","on","pattern","[+]{1}[0-9]{11,14}","name","mobilephone","required","",3,"readonly","disabled","ngModel"],["size","large","expand","block","type","submit","color","success",3,"disabled"],["slot","start","name","save"],[4,"ngFor","ngForOf"],["id","searchClubPresets","size","large","expand","block"],["name","search-outline","ios","md-search-outline"],["trigger","searchClubPresets"],["title","Vorbelegen mit",1,"ion-page",3,"selectionChange","selectionCancel","items","selectedItem"],["src","assets/imgs/password.png"],["placeholder","Passwort","type","password","name","secret","required","",3,"readonly","disabled","ngModel"],["placeholder","Passwort best\xe4tigen","type","password","name","verification","required","",3,"readonly","disabled","ngModel"],["placeholder","Passwort","type","password","name","secret",3,"ngModelChange","readonly","disabled","ngModel"],["placeholder","Passwort best\xe4tigen","type","password","name","verification",3,"ngModelChange","readonly","disabled","ngModel"],["size","small","color","danger",3,"click","disabled"]],template:function(n,i){1&n&&(e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",4),e.nrm(3,"ion-back-button",5),e.k0s(),e.j41(4,"ion-title"),e.EFF(5,"Vereins-Registrierung"),e.k0s(),e.j41(6,"ion-note",6)(7,"div",7),e.EFF(8),e.k0s()()()(),e.DNE(9,j,38,27,"ion-content",8),e.j41(10,"ion-footer")(11,"ion-toolbar")(12,"ion-button",9),e.bIt("click",function(){return i.presentActionSheet()}),e.nrm(13,"ion-icon",10),e.EFF(14,"Anmeldungen... "),e.k0s()()()),2&n&&(e.R7$(8),e.SpI("f\xfcr ",i.wettkampf),e.R7$(),e.Y8G("ngIf",i.registration),e.R7$(3),e.Y8G("disabled",i.waiting||0===i.regId))},dependencies:[m.Sq,m.bT,c.qT,c.BC,c.cb,c.YS,c.R_,c.vS,c.cV,r.mC,r.Jm,r.QW,r.W9,r.M0,r.eU,r.iq,r.$w,r.uz,r.Dg,r.nf,r.JI,r.BC,r.ai,r.Sb,r.Gw,r.el,w],encapsulation:2})}return s})();var G=o(5079);const M=[{path:"",component:V}];let x=(()=>{class s{static \u0275fac=function(n){return new(n||s)};static \u0275mod=e.$C({type:s});static \u0275inj=l.G2t({imports:[m.MD,c.YN,r.bv,p.iI.forChild(M),G.h]})}return s})()}}]);