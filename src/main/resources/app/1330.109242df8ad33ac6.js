"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[1330],{1330:(M,h,d)=>{d.r(h),d.d(h,{WertungEditorPageModule:()=>de});var _=d(2200),u=d(4341),b=d(8132),s=d(9893),m=d(467),r=d(2615),e=d(3664),g=d(7705),v=d(1413),p=d(5035),w=d(2350),k=d(1266),I=d(5083),x=d(8103),E=d(6354),V=d(5964),j=d(8141),S=d(152),T=d(7647),C=d(3537);const B=["noteInput"];function R(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-input",6,0),e.mxI("ngModelChange",function(n){r.eBV(t);const o=e.XpG();return e.DH7(o.singleValueContainer,n)||(o.singleValueContainer=n),r.Njj(n)}),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("label",t.title)("disabled",t.waiting()||t.disabled),e.R50("ngModel",t.singleValueContainer)}}function P(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-button",7),e.bIt("click",function(){r.eBV(t);const n=e.XpG();return r.Njj(n.add())}),e.nrm(1,"ion-icon",8),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("disabled",t.waiting()||t.disabled)}}function N(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-button",9),e.bIt("click",function(){r.eBV(t);const n=e.XpG();return r.Njj(n.remove(0))}),e.nrm(1,"ion-icon",10),e.k0s()}if(2&a){const t=e.XpG();e.Y8G("disabled",t.waiting()||t.disabled)}}function F(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-input",30,0),e.bIt("ionChange",function(n){r.eBV(t);const o=e.XpG().$implicit,l=e.XpG(2);return r.Njj(l.onItemChange(n,o))})("input",function(n){r.eBV(t);const o=e.XpG().$implicit,l=e.XpG(2);return r.Njj(l.onItemChange(n,o))})("ionBlur",function(n){r.eBV(t);const o=e.XpG().$implicit,l=e.XpG(2);return r.Njj(l.onBlur(n,o))}),e.k0s()}if(2&a){const t=e.XpG(),i=t.$implicit,n=t.$index,o=e.XpG(2);e.Y8G("name",e.ai1("",o.valueTitle(),"",n))("disabled",o.waiting()||o.disabled)("ngModel",i.value)}}function W(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-input",30),e.bIt("ionChange",function(n){r.eBV(t);const o=e.XpG().$implicit,l=e.XpG(2);return r.Njj(l.onItemChange(n,o))})("input",function(n){r.eBV(t);const o=e.XpG().$implicit,l=e.XpG(2);return r.Njj(l.onItemChange(n,o))})("ionBlur",function(n){r.eBV(t);const o=e.XpG().$implicit,l=e.XpG(2);return r.Njj(l.onBlur(n,o))}),e.k0s()}if(2&a){const t=e.XpG(),i=t.$implicit,n=t.$index,o=e.XpG(2);e.Y8G("name",e.ai1("",o.valueTitle(),"",n))("disabled",o.waiting()||o.disabled)("ngModel",i.value)}}function y(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-row",23)(1,"ion-col",25),e.EFF(2),e.k0s(),e.j41(3,"ion-col",26),e.nrm(4,"div",27),e.nVh(5,F,2,5,"ion-input",28),e.nVh(6,W,1,5,"ion-input",28),e.k0s(),e.j41(7,"ion-col",29)(8,"ion-button",9),e.bIt("click",function(){const n=r.eBV(t).$index,o=e.XpG(2);return r.Njj(o.remove(n))}),e.nrm(9,"ion-icon",10),e.k0s()()()}if(2&a){const t=c.$index,i=e.XpG(2);e.R7$(2),e.SpI("",t+1,". Wertung"),e.R7$(3),e.vxM(0===t?5:-1),e.R7$(),e.vxM(t>0?6:-1),e.R7$(2),e.Y8G("disabled",i.waiting()||i.disabled)}}function D(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-row",24)(1,"ion-col")(2,"ion-button",31),e.bIt("click",function(){r.eBV(t);const n=e.XpG(2);return r.Njj(n.add())}),e.nrm(3,"ion-icon",8),e.EFF(4,"Weitere Wertung hinzuf\xfcgen"),e.k0s()()()}if(2&a){const t=e.XpG(2);e.R7$(2),e.Y8G("disabled",t.waiting()||t.disabled)}}function A(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-grid",5)(1,"ion-row")(2,"ion-col",11),e.EFF(3),e.k0s(),e.j41(4,"ion-col",12)(5,"ion-radio-group",13),e.mxI("ngModelChange",function(n){r.eBV(t);const o=e.XpG();return e.DH7(o.compMethod,n)||(o.compMethod=n),r.Njj(n)}),e.j41(6,"ion-item")(7,"ion-radio",14),e.EFF(8,"Durchschnitt"),e.k0s()(),e.j41(9,"ion-item")(10,"ion-radio",15),e.EFF(11,"Summe"),e.k0s()()()(),e.j41(12,"ion-col",16)(13,"ion-item",17)(14,"ion-button",18),e.bIt("click",function(){r.eBV(t);const n=e.XpG();return r.Njj(n.removeKomma())}),e.nrm(15,"ion-icon",19),e.k0s(),e.j41(16,"div",20),e.EFF(17),e.k0s(),e.j41(18,"ion-button",21),e.bIt("click",function(){r.eBV(t);const n=e.XpG();return r.Njj(n.addKomma())}),e.nrm(19,"ion-icon",22),e.k0s()()()(),e.Z7z(20,y,10,4,"ion-row",23,e.fX1),e.nVh(22,D,5,1,"ion-row",24),e.k0s()}if(2&a){const t=e.XpG();e.R7$(3),e.E5c("",t.title," ",t.methodSymbol," ",t.avgValue),e.R7$(2),e.R50("ngModel",t.compMethod),e.R7$(9),e.Y8G("disabled",t.waiting()||t.disabled||t.fixed<=0),e.R7$(3),e.SpI("Kommastellen: ",t.fixed),e.R7$(),e.Y8G("disabled",t.waiting()||t.disabled||t.fixed>=3),e.R7$(2),e.Dyx(t.singleValues),e.R7$(2),e.vxM(t.disabled?-1:22)}}let G=(()=>{class a{static nextId=0;id="avg-calc-input-"+a.nextId++;hidden=(0,g.hFB)(void 0);readonly=(0,g.hFB)(void 0);waiting=(0,g.hFB)(void 0);valueTitle=(0,g.hFB)(void 0);valueDescription=(0,g.hFB)(void 0);_fixed;get fixed(){return this._fixed=Number(localStorage.getItem(`avg-calc-decimals-${this.valueTitle()}${localStorage.getItem("current_competition")}`))||this._fixed,this._fixed}set fixed(t){this._fixed=t}_compMethod="avg";avgValue;singleValues=[];get title(){return this.valueTitle()}get methodSymbol(){return"avg"===this._compMethod?"\xd8":"\u03a3"}get singleValueContainer(){return this.singleValues[0]?.value||this.avgValue}set singleValueContainer(t){this.singleValues=[{value:t}],this.calcAvg(),this.markAsTouched()}get compMethod(){return this._compMethod=localStorage.getItem(`comp-method-${this.valueTitle()}${localStorage.getItem("current_competition")}`)||this._compMethod,this._compMethod}set compMethod(t){this._compMethod=t,localStorage.setItem(`comp-method-${this.valueTitle()}${localStorage.getItem("current_competition")}`,t),this.calcAvg(),this.markAsTouched()}addKomma(){this._fixed<3&&(this._fixed+=1,localStorage.setItem(`avg-calc-decimals-${this.valueTitle()}${localStorage.getItem("current_competition")}`,""+this._fixed),this.calcAvg(),this.markAsTouched())}removeKomma(){this._fixed>0&&(this._fixed-=1,localStorage.setItem(`avg-calc-decimals-${this.valueTitle()}${localStorage.getItem("current_competition")}`,""+this._fixed),this.calcAvg(),this.markAsTouched())}add(){this.disabled||(this.singleValues=[...this.singleValues,{value:0}],1===this.singleValues.length&&(this.singleValues=[...this.singleValues,{value:0}]),this.markAsTouched())}remove(t){!this.disabled&&t>-1&&(this.singleValues.splice(t,1),this.calcAvg(),this.markAsTouched())}calcAvg(){const t=this.singleValues.filter(o=>!!o.value).map(o=>Number(o.value)).filter(o=>!isNaN(o)).filter(o=>o>0);if(0===t.length)return this.avgValue=void 0,void this.onChange(void 0);console.log("compMethod: "+this.compMethod);const i="avg"===this.compMethod?t.length:1;console.log("divider: "+i);const n=Number((t.reduce((o,l)=>o+l,0)/i).toFixed(this.fixed));return!this.disabled&&this.avgValue!==n&&!isNaN(n)&&(this.avgValue=n,this.onChange(n)),n}onTouched=()=>{};onChange=t=>{};onItemChange(t,i){i.value=t.target.value,this.calcAvg(),this.markAsTouched()}onBlur(t,i){i.value=Number(t.target.value).toFixed(this.fixed),this.calcAvg(),this.markAsTouched()}touched=!1;disabled=!1;writeValue(t){this.avgValue=t,this.singleValues=[{value:t}]}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}markAsTouched(){this.touched||(this.onTouched(),this.touched=!0)}setDisabledState(t){this.disabled=t}noteInput=(0,g.ebz)("noteInput");focused=!1;setFocus(){this.noteInput().setFocus()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-wertung-avg-calc"]],viewQuery:function(i,n){1&i&&e.wEZ(n.noteInput,B,5),2&i&&e.NyB()},hostVars:1,hostBindings:function(i,n){2&i&&e.Avn("id",n.id)},inputs:{hidden:[1,"hidden"],readonly:[1,"readonly"],waiting:[1,"waiting"],valueTitle:[1,"valueTitle"],valueDescription:[1,"valueDescription"],fixed:"fixed"},standalone:!1,features:[e.Jv_([{provide:u.kq,multi:!0,useExisting:a}])],decls:5,vars:5,consts:[["noteInput",""],[3,"hidden"],["autofocus","","placeholder","Notenwert im Format ##.## (2-3 Nachkommastellen mit Dezimalpunkt)","name","noteInput","type","number","step","0.05","min","0.00","max","100.00","required","",3,"label","disabled","ngModel"],["slot","end","expand","block","color","secondary",3,"disabled"],["color","danger",3,"disabled"],["no-padding","",1,"table"],["autofocus","","placeholder","Notenwert im Format ##.## (2-3 Nachkommastellen mit Dezimalpunkt)","name","noteInput","type","number","step","0.05","min","0.00","max","100.00","required","",3,"ngModelChange","label","disabled","ngModel"],["slot","end","expand","block","color","secondary",3,"click","disabled"],["name","add-circle-outline"],["color","danger",3,"click","disabled"],["name","trash-outline"],["size-xs","12","size-md","4",1,"table-header"],["size-xs","12","size-md","4",1,"table-action"],[3,"ngModelChange","ngModel"],["value","avg","labelPlacement","start","alignment","center"],["value","sum","labelPlacement","start","alignment","center"],["size-xs","12","size-md","4","no-padding","",1,"number"],["lines","full"],["slot","start","color","secondary",1,"table-action",3,"click","disabled"],["name","remove-outline"],[1,"decimals"],["slot","end","color","secondary",1,"table-action",3,"click","disabled"],["name","add-outline"],[1,"table-row"],[1,"table-header"],[1,"number"],["id","input-group","no-padding",""],["id","validity"],["placeholder","Notenwert im Format ##.## (2-3 Nachkommastellen mit Dezimalpunkt)","type","number","step","0.05","min","0.00","max","100.00","required","",3,"name","disabled","ngModel"],[1,"table-action"],["placeholder","Notenwert im Format ##.## (2-3 Nachkommastellen mit Dezimalpunkt)","type","number","step","0.05","min","0.00","max","100.00","required","",3,"ionChange","input","ionBlur","name","disabled","ngModel"],["expand","block","color","secondary",3,"click","disabled"]],template:function(i,n){1&i&&(e.j41(0,"ion-item",1),e.nVh(1,R,2,3,"ion-input",2),e.nVh(2,P,2,1,"ion-button",3),e.nVh(3,N,2,1,"ion-button",4),e.nVh(4,A,23,8,"ion-grid",5),e.k0s()),2&i&&(e.Y8G("hidden",n.hidden()),e.R7$(),e.vxM(n.singleValues.length<2?1:-1),e.R7$(),e.vxM(n.singleValues.length<2?2:-1),e.R7$(),e.vxM(n.singleValues.length<2?3:-1),e.R7$(),e.vxM(n.singleValues.length>1?4:-1))},dependencies:[u.BC,u.YS,u.vS,s.Jm,s.hU,s.lO,s.iq,s.$w,s.uz,s.KO,s.f0,s.ln,s.su,s.Je,s.T6,s.jL],styles:[".table[_ngcontent-%COMP%]{background-color:var(--ion-background-color);height:100%;overflow:hidden;overflow-y:auto}.table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%]{font-weight:700;font-size:2rem}.table[_ngcontent-%COMP%]   .table-header[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   .table-subject[_ngcontent-%COMP%]{color:var(--ion-color-primary);font-weight:700}.table[_ngcontent-%COMP%]   ion-row.table-row[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;flex-wrap:nowrap}.table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col[_ngcontent-%COMP%]   ion-radio[_ngcontent-%COMP%]{height:unset}.table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col.decimals[_ngcontent-%COMP%]{flex:0 0 6em;width:100%;outline:none;text-align:center;border:1px solid #a9a9a9}.table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col.table-action[_ngcontent-%COMP%]{flex:0 0 1.5em}.table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]   ion-col.number[_ngcontent-%COMP%]{flex:0 0 6em;letter-spacing:.5px}@media all and (min-height: 720px){.table[_ngcontent-%COMP%]   ion-row[_ngcontent-%COMP%]{margin:10px}}#decimals-group[_ngcontent-%COMP%]{height:70%;overflow:hidden}#decimals-group[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{height:100%;outline:none;text-align:right;border:1px solid #a9a9a9}#input-group[_ngcontent-%COMP%]{height:70%;overflow:hidden}#input-group[_ngcontent-%COMP%]   #validity[_ngcontent-%COMP%]{width:0;height:0;position:absolute;top:0%;right:0%;border-left:15px solid transparent;border-top:15px solid transparent}#input-group[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{height:100%;width:100%;outline:none;text-align:right;border:1px solid #a9a9a9}#input-group.valid[_ngcontent-%COMP%]   #validity[_ngcontent-%COMP%]{border-left:15px solid transparent;border-top:15px solid var(--ion-color-success)}#input-group.valid[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border:1px solid var(--ion-color-success)}#input-group.invalid[_ngcontent-%COMP%]   #validity[_ngcontent-%COMP%]{border-left:15px solid transparent;border-top:15px solid var(--ion-color-danger)}#input-group.invalid[_ngcontent-%COMP%]   ion-input[_ngcontent-%COMP%]{border:1px solid var(--ion-color-danger)}"]})}return a})();const O=["wertungsform"],$=["enote"],X=["dnote"];function z(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-item"),e.nrm(1,"ion-icon",13),e.j41(2,"ion-button",14),e.bIt("click",function(){r.eBV(t);const n=e.XpG();return r.Njj(n.currentMediaAction())}),e.nrm(3,"ion-icon",7),e.EFF(4),e.k0s(),e.j41(5,"ion-button",15),e.bIt("click",function(){r.eBV(t);const n=e.XpG();return r.Njj(n.releaseMusic())}),e.nrm(6,"ion-icon",16),e.k0s()(),e.j41(7,"ion-item"),e.nrm(8,"ion-avatar",7),e.j41(9,"ion-note"),e.EFF(10),e.k0s()()}if(2&a){const t=e.XpG();e.R7$(2),e.Y8G("disabled",t.waiting||t.mediaButtonDisabled||t.currentMediaButtonDisabled),e.R7$(),e.BMQ("name",t.currentMediaButtonIcon),e.R7$(),e.JRh(t.currentMediaButtonText),e.R7$(),e.Y8G("disabled",t.waiting||t.mediaButtonDisabled||t.currentMediaReleaseButtonDisabled),e.R7$(5),e.SpI(" ",t.currentMediaState," ")}}function U(a,c){if(1&a){const t=e.RV6();e.j41(0,"app-wertung-avg-calc",18),e.bIt("ngModelChange",function(n){const o=r.eBV(t).$implicit,l=e.XpG(2);return r.Njj(l.updateVariable(n,o))}),e.k0s()}if(2&a){const t=c.$implicit,i=e.XpG(2);e.Y8G("name",t.name+t.index)("waiting",i.waiting)("valueTitle",t.name)("fixed",t.scale)("ngModel",t.value)("disabled",!i.editable())}}function Y(a,c){if(1&a&&(e.j41(0,"ion-list")(1,"ion-item-divider")(2,"h2"),e.EFF(3),e.k0s()(),e.Z7z(4,U,1,6,"app-wertung-avg-calc",17,e.fX1),e.k0s()),2&a){const t=c.$implicit,i=c.$index;e.R7$(3),e.SpI("",i+1,". \xdcbung"),e.R7$(),e.Dyx(t)}}function K(a,c){if(1&a&&(e.j41(0,"ion-item"),e.nrm(1,"ion-input",22),e.k0s()),2&a){const t=e.XpG(2);e.R7$(),e.Y8G("label",t.dNoteLabel)("ngModel",t.wertung.noteD)("disabled",!t.editable())}}function L(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-button",23,2),e.bIt("click",function(){r.eBV(t);const n=e.XpG(2),o=e.sdS(14);return r.Njj(n.validate(o))}),e.nrm(2,"ion-icon",24),e.EFF(3,"Endnote berechnen"),e.k0s()}if(2&a){const t=e.XpG(2),i=e.sdS(14);e.Y8G("disabled",t.waiting||!i.valid)}}function Q(a,c){if(1&a&&(e.j41(0,"ion-list")(1,"ion-item-divider")(2,"h2"),e.EFF(3,"Endnote"),e.k0s()(),e.nVh(4,K,2,3,"ion-item"),e.j41(5,"ion-item"),e.nrm(6,"ion-input",19,1),e.k0s(),e.j41(8,"ion-item"),e.nrm(9,"ion-input",20,1),e.k0s(),e.nVh(11,L,4,1,"ion-button",21),e.k0s()),2&a){const t=e.XpG();e.R7$(4),e.vxM(t.isDNoteUsed?4:-1),e.R7$(2),e.Y8G("label",t.eNoteLabel)("ngModel",t.wertung.noteE)("disabled",!t.editable()),e.R7$(3),e.Y8G("ngModel",t.wertung.endnote)("disabled",!t.editable()),e.R7$(2),e.vxM(t.editable()?11:-1)}}function J(a,c){if(1&a){const t=e.RV6();e.j41(0,"app-wertung-avg-calc",27,4),e.mxI("ngModelChange",function(n){r.eBV(t);const o=e.XpG(2);return e.DH7(o.dNote,n)||(o.dNote=n),r.Njj(n)}),e.k0s()}if(2&a){const t=e.XpG(2);e.Y8G("waiting",t.waiting)("valueTitle",t.dNoteLabel)("fixed",1),e.R50("ngModel",t.dNote),e.Y8G("disabled",!t.editable())}}function Z(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-button",23,2),e.bIt("click",function(){r.eBV(t);const n=e.XpG(2),o=e.sdS(14);return r.Njj(n.validate(o))}),e.nrm(2,"ion-icon",28),e.EFF(3,"Endnote berechnen"),e.k0s()}if(2&a){const t=e.XpG(2),i=e.sdS(14);e.Y8G("disabled",t.waiting||!i.valid)}}function H(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-list"),e.nVh(1,J,2,5,"app-wertung-avg-calc",25),e.j41(2,"app-wertung-avg-calc",26,3),e.mxI("ngModelChange",function(n){r.eBV(t);const o=e.XpG();return e.DH7(o.eNote,n)||(o.eNote=n),r.Njj(n)}),e.k0s(),e.j41(4,"ion-item"),e.nrm(5,"ion-input",20,1),e.k0s(),e.nVh(7,Z,4,1,"ion-button",21),e.k0s()}if(2&a){const t=e.XpG();e.R7$(),e.vxM(t.isDNoteUsed?1:-1),e.R7$(),e.Y8G("waiting",t.waiting)("valueTitle",t.eNoteLabel)("fixed",3),e.R50("ngModel",t.eNote),e.Y8G("disabled",!t.editable()),e.R7$(3),e.Y8G("ngModel",t.wertung.endnote)("disabled",!t.editable()),e.R7$(2),e.vxM(t.editable()?7:-1)}}function q(a,c){1&a&&(e.j41(0,"ion-item"),e.EFF(1," Ung\xfcltige Eingabe. Die Werte m\xfcssen im Format ##.## (2-3 Nachkommastellen mit Dezimalpunkt) eingegeben werden. "),e.k0s())}function ee(a,c){if(1&a&&(e.j41(0,"ion-item"),e.EFF(1),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.SpI(" An diesem Ger\xe4t macht ",t.item.vorname+" "+t.item.name," Pause. Es k\xf6nnen keine Resultate erfasst werden. ")}}function te(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-button",29,5),e.nrm(2,"ion-icon",30),e.EFF(3,"Speichern & Weiter"),e.k0s(),e.j41(4,"ion-button",23),e.bIt("click",function(){r.eBV(t);const n=e.XpG(),o=e.sdS(14);return r.Njj(n.saveClose(o))}),e.nrm(5,"ion-icon",31),e.EFF(6,"Speichern"),e.k0s()}if(2&a){const t=e.XpG(),i=e.sdS(14);e.Y8G("disabled",t.waiting||!i.valid),e.R7$(4),e.Y8G("disabled",t.waiting||!i.valid)}}function ne(a,c){1&a&&(e.j41(0,"ion-item-divider"),e.EFF(1,"N\xe4chster Turner"),e.k0s())}function ie(a,c){1&a&&(e.j41(0,"ion-item-divider"),e.EFF(1,"N\xe4chste Turnerin"),e.k0s())}function oe(a,c){if(1&a){const t=e.RV6();e.j41(0,"ion-item-sliding",null,6)(2,"ion-item",32),e.bIt("click",function(){r.eBV(t);const n=e.sdS(1),o=e.XpG(2);return r.Njj(o.itemTapped(n))}),e.j41(3,"ion-toolbar")(4,"ion-note",9)(5,"div",10),e.EFF(6),e.k0s(),e.j41(7,"div",11),e.EFF(8),e.k0s()()(),e.nrm(9,"ion-icon",33),e.k0s(),e.j41(10,"ion-item-options",34)(11,"ion-item-option",35),e.bIt("click",function(){r.eBV(t);const n=e.sdS(1),o=e.XpG(2),l=e.sdS(14);return r.Njj(o.next(l,n))}),e.nrm(12,"ion-icon",36),e.EFF(13),e.k0s()()()}if(2&a){const t=e.XpG(2);e.R7$(6),e.JRh(t.nextItem.vorname+" "+t.nextItem.name),e.R7$(2),e.JRh(t.nextItem.wertung.riege),e.R7$(5),e.SpI(" ",t.nextItem.vorname+" "+t.nextItem.name," ")}}function ae(a,c){if(1&a&&(e.j41(0,"ion-list"),e.nVh(1,ne,2,0,"ion-item-divider"),e.nVh(2,ie,2,0,"ion-item-divider"),e.nVh(3,oe,14,3,"ion-item-sliding"),e.k0s()),2&a){const t=e.XpG();e.R7$(),e.vxM(t.nextItem&&"Turner"===t.nextItem.geschlecht?1:-1),e.R7$(),e.vxM(t.nextItem&&"Turnerin"===t.nextItem.geschlecht?2:-1),e.R7$(),e.vxM(t.nextItem?3:-1)}}let re=(()=>{class a{navCtrl=(0,r.WQX)(p.q9);route=(0,r.WQX)(k.nX);alertCtrl=(0,r.WQX)(s.hG);toastController=(0,r.WQX)(s.K_);backendService=(0,r.WQX)(w.m);platform=(0,r.WQX)(p.OD);zone=(0,r.WQX)(e.SKi);constructor(){const t=this.backendService;this.durchgang=t.durchgang,this.step=t.step,this.geraetId=t.geraet;const i=parseInt(this.route.snapshot.paramMap.get("itemId"));this.updateUI(t.wertungen.find(n=>n.id===i)),this.installLazyAction(),this.backendService.durchgangStarted.pipe((0,E.T)(n=>n.filter(o=>(0,C.MB)(o.durchgang)===(0,C.MB)(this.durchgang)&&o.wettkampfUUID===this.backendService.competition).length>0)).subscribe(n=>{this.durchgangopen=n,this.mediaButtonDisabled=!this.backendService.isWebsocketConnected()||!n})}itemOriginal;durchgangopen=!1;form=(0,g.ebz)("wertungsform");enote=(0,g.ebz)("enote");dnote=(0,g.ebz)("dnote");subscription;mediasubscription;wertungChanged=new v.B;item;_wertung;lastValidatedWertung;nextItem;exercices;currentMediaState="unbekannt";currentMediaButtonText="Musik laden";currentMediaButtonIcon="play-circle-outline";currentMediaButtonDisabled=!0;currentMediaReleaseButtonDisabled=!0;currentMediaAction=()=>{};geraetId;step;durchgang;waiting=!1;isDNoteUsed=!0;get wertung(){return this._wertung}set wertung(t){this._wertung=t,this.updateExercices()}mediaButtonDisabled=!0;durchgangstate(){return this.backendService.isWebsocketConnected()?this.durchgangopen?"gestartet":"gesperrt":"offline"}get connected(){return this.backendService.isWebsocketConnected()}get isNetworkMediaPlayerAvailable(){return this.backendService.mediaPlayerAvailable.value}groupBy=(t,i)=>t.reduce((n,o)=>((n[i(o)]||=[]).push(o),n),{});flatten(t){return[].concat(...t)}updateVariable(t,i){const n=this.flatten(this.exercices);this.wertung.variables&&(n.filter(o=>"A"===o.prefix||"D"===o.prefix).forEach(o=>{o.prefix===i.prefix&&o.name==i.name&&o.index===i.index&&(o.value=t||0)}),n.filter(o=>"B"===o.prefix||"E"===o.prefix).forEach(o=>{o.prefix===i.prefix&&o.name==i.name&&o.index===i.index&&(o.value=t||0)}),n.filter(o=>"P"===o.prefix).forEach(o=>{o.prefix===i.prefix&&o.name==i.name&&o.index===i.index&&(o.value=t||0)}))}get dNoteLabel(){return this.item.isDNoteUsed&&x.Ir.indexOf(this.item.programm)>-1?"A-Note":"D-Note"}get eNoteLabel(){return this.item.isDNoteUsed&&x.Ir.indexOf(this.item.programm)>-1?"B-Note":"E-Note"}get dNote(){return this.wertung.noteD}set dNote(t){this.wertung.noteD=t,this.wertungChanged.next(this.wertung)}get eNote(){return this.wertung.noteE}set eNote(t){this.wertung.noteE=t,this.wertungChanged.next(this.wertung)}installLazyAction(){this.wertungChanged.pipe((0,V.p)(t=>!!this.wertung.variables||(0==(t.noteD||0)&&0==(t.noteE||0)||(t.noteE||0)>0)),(0,j.M)(t=>{this.zone.run(()=>{this.wertung.variables&&(this.wertung.noteD=null,this.wertung.noteE=null),this.wertung.endnote=null})}),(0,S.B)(1500),(0,T.u)()).subscribe(t=>{this.zone.run(()=>{this.calculateEndnote(t)})})}calculateEndnote(t){let i=Object.assign({},t,{noteD:t.variables?null:t.noteD,noteE:t.variables?null:t.noteE,variables:t.variables,mediafile:t.mediafile});(i.variables||i.noteD!==this.lastValidatedWertung?.noteD||i.noteE!==this.lastValidatedWertung?.noteE)&&(this.wertung.variables&&(this.wertung.noteD=null,this.wertung.noteE=null),this.wertung.endnote=null,this.backendService.validateWertung(i).subscribe({next:n=>{this.zone.run(()=>{this.lastValidatedWertung=i,this.wertung.noteD=n.noteD,this.wertung.noteE=n.noteE,this.wertung.endnote=n.endnote})},error:n=>{console.log(n)}}))}ionViewWillLeave(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0),this.mediasubscription&&(this.mediasubscription.unsubscribe(),this.mediasubscription=void 0)}ionViewWillEnter(){this.subscription&&(this.subscription.unsubscribe(),this.subscription=void 0),this.mediasubscription&&(this.mediasubscription.unsubscribe(),this.mediasubscription=void 0),this.mediasubscription=this.backendService.mediaStateChanged.subscribe(t=>{this.zone.run(()=>{this.mediaStateChanged(t)})}),this.subscription=this.backendService.wertungUpdated.subscribe(t=>{this.zone.run(()=>{t.wertung.athletId===this.wertung.athletId&&t.wertung.wettkampfdisziplinId===this.wertung.wettkampfdisziplinId&&t.wertung.endnote!==this.wertung.endnote&&(this.item.wertung=Object.assign({},t.wertung),this.itemOriginal.wertung=Object.assign({},t.wertung),this.wertung=Object.assign({noteD:0,noteE:0,endnote:0},this.item.wertung))})}),this.editable()&&this.backendService.ensurWebsocketConnection(),this.platform.ready().then(()=>{setTimeout(()=>{let t;"web"!==I.Ii.getPlatform()&&t.show&&(t.show(),console.log("keyboard called"));const i=this.dnote(),n=this.enote();this.isDNoteUsed&&i?(i.setFocus(),console.log("dnote focused")):n&&(n.setFocus(),console.log("enote focused"))},400)})}editable(){return this.backendService.loggedIn&&this.wertung.wettkampfdisziplinId>0}updateExercices(){const t=this.groupBy([...this.wertung.variables?.dVariables||[],...this.wertung.variables?.eVariables||[],...this.wertung.variables?.pVariables||[]],i=>i.index);this.exercices=Object.keys(t).map(i=>t[i]).sort((i,n)=>i[0].index-n[0].index)}updateUI(t){this.zone.run(()=>{this.mediaStateChanged(this.backendService.mediaStateChanged.value),this.waiting=!1,this.item=Object.assign({},t),this.isDNoteUsed=this.item.isDNoteUsed,this.itemOriginal=Object.assign({},t),this.wertung=Object.assign({noteD:0,noteE:0,endnote:0},this.itemOriginal.wertung);const i=this.backendService.wertungen.findIndex(o=>o.wertung.id===t.wertung.id);this.nextItem=i<0||i>=this.backendService.wertungen.length-1?void 0:this.backendService.wertungen[i+1],this.ionViewWillEnter()})}ensureInitialValues(t){return Object.assign(this.wertung,t)}mediaStateChanged(t){if(null===this.wertung?.mediafile||"Boden"!==this.geraetName())this.currentMediaState="keine Musik zugeordnet",this.currentMediaButtonDisabled=!0,this.currentMediaReleaseButtonDisabled=!0,this.currentMediaButtonText="";else if("AthletMediaIsFree"===t.type)this.currentMediaState="Musik Player ist frei",this.currentMediaButtonText="Musik laden",this.currentMediaButtonIcon="recording-outline",this.currentMediaAction=this.loadMusic,this.currentMediaButtonDisabled=!1,this.currentMediaReleaseButtonDisabled=!0;else if(t.media?.id===this.wertung?.mediafile?.id)switch(this.currentMediaReleaseButtonDisabled=!1,t.type){case"AthletMediaIsAtStart":this.currentMediaState="Musik ist bereit f\xfcr "+t.context,this.currentMediaButtonText="Musik abspielen",this.currentMediaButtonIcon="play-circle-outline",this.currentMediaAction=this.playMusic,this.currentMediaButtonDisabled=!1;break;case"AthletMediaIsRunning":this.currentMediaState="Musik l\xe4uft f\xfcr "+t.context,this.currentMediaButtonText="Musik stoppen",this.currentMediaButtonIcon="stop-circle-outline",this.currentMediaAction=this.playMusic,this.currentMediaButtonDisabled=!1;break;case"AthletMediaIsPaused":this.currentMediaState="Musik ist pausiert f\xfcr "+t.context,this.currentMediaButtonText="Musik abspielen",this.currentMediaButtonIcon="play-circle-outline",this.currentMediaAction=this.playMusic,this.currentMediaButtonDisabled=!1;break;case"AthletMediaIsFree":this.currentMediaState="Musik Player ist frei",this.currentMediaButtonText="Musik abspielen",this.currentMediaButtonIcon="play-circle-outline",this.currentMediaAction=this.playMusic,this.currentMediaButtonDisabled=!1}else this.currentMediaState="Musik Player ist belegt f\xfcr "+t.context,this.currentMediaButtonText="Musik laden",this.currentMediaButtonIcon="recording-outline",this.currentMediaAction=()=>{},this.currentMediaButtonDisabled=!0,this.currentMediaReleaseButtonDisabled=!0}loadMusic(){this.backendService.aquireMusic(this.ensureInitialValues(this.wertung))}releaseMusic(){this.backendService.releaseMusic(this.ensureInitialValues(this.wertung))}playMusic(){const t=this.backendService.mediaStateChanged.value;switch(t.type){case"AthletMediaIsAtStart":case"AthletMediaIsPaused":t.media.id===this.wertung.mediafile?.id&&this.backendService.playMusic(this.ensureInitialValues(this.wertung));break;case"AthletMediaIsRunning":t.media.id===this.wertung.mediafile?.id&&this.backendService.stopMusic(this.ensureInitialValues(this.wertung));break;case"AthletMediaIsFree":this.backendService.aquireMusic(this.ensureInitialValues(this.wertung)),this.backendService.playMusic(this.ensureInitialValues(this.wertung))}}validate(t){this.calculateEndnote(this.ensureInitialValues(t.value))}saveClose(t){t.valid&&(this.waiting=!0,this.backendService.updateWertung(this.durchgang,this.step,this.geraetId,this.ensureInitialValues(t.value)).subscribe({next:i=>{this.updateUI(i),this.navCtrl.pop()},error:i=>{this.waiting=!1,console.log(i)}}))}save(t){t.valid&&(this.waiting=!0,this.backendService.updateWertung(this.durchgang,this.step,this.geraetId,this.ensureInitialValues(t.value)).subscribe({next:i=>{this.updateUI(i)},error:i=>{this.waiting=!1,console.log(i)}}))}saveNext(t){t.valid&&(this.waiting=!0,this.backendService.updateWertung(this.durchgang,this.step,this.geraetId,this.ensureInitialValues(t.value)).subscribe({next:i=>{this.waiting=!1;const n=this.backendService.wertungen.findIndex(l=>l.wertung.id===i.wertung.id);n<0&&console.log("unexpected wertung - id matches not with current wertung: "+i.wertung.id);let o=n+1;if(n<0)o=0;else if(n>=this.backendService.wertungen.length-1){if(0===this.backendService.wertungen.filter(l=>void 0===l.wertung.endnote).length)return this.navCtrl.pop(),void this.toastSuggestCompletnessCheck();o=this.backendService.wertungen.findIndex(l=>void 0===l.wertung.endnote),this.toastMissingResult(t,this.backendService.wertungen[o].vorname+" "+this.backendService.wertungen[o].name)}this.updateUI(this.backendService.wertungen[o])},error:i=>{this.waiting=!1,console.log(i)}}))}itemTapped(t){t.getOpenAmount().then(i=>{i>10||i<-10?t.close():t.open("end")})}next(t,i){i.close();const n=this.backendService.wertungen.findIndex(l=>l.wertung.id===this.wertung.id);n<0&&console.log("unexpected wertung - id matches not with current wertung: "+this.wertung.id);let o=n+1;if(n<0)o=0;else if(n>=this.backendService.wertungen.length-1){if(0===this.backendService.wertungen.filter(l=>void 0===l.wertung.endnote).length)return this.navCtrl.pop(),void this.toastSuggestCompletnessCheck();o=this.backendService.wertungen.findIndex(l=>void 0===l.wertung.endnote),this.toastMissingResult(t,this.backendService.wertungen[o].vorname+" "+this.backendService.wertungen[o].name)}this.updateUI(this.backendService.wertungen[o])}nextEmptyOrFinish(t){const i=this.backendService.wertungen.findIndex(n=>n.wertung.id===this.wertung.id);if(0===this.backendService.wertungen.filter((n,o)=>o>i&&void 0===n.wertung.endnote).length)return this.navCtrl.pop(),void this.toastSuggestCompletnessCheck();{const n=this.backendService.wertungen.findIndex((o,l)=>l>i&&void 0===o.wertung.endnote);this.toastMissingResult(t,this.backendService.wertungen[n].vorname+" "+this.backendService.wertungen[n].name),this.updateUI(this.backendService.wertungen[n])}}geraetName(){return this.backendService.geraete?this.backendService.geraete.find(t=>t.id===this.geraetId).name:""}toastSuggestCompletnessCheck(){var t=this;return(0,m.A)(function*(){(yield t.toastController.create({header:"Qualit\xe4tskontrolle",message:"Es sind jetzt alle Resultate erfasst. Bitte ZU ZWEIT die Resultate pr\xfcfen und abschliessen!",animated:!0,position:"middle",buttons:[{text:"OK, gelesen.",icon:"checkmark-circle",role:"cancel",handler:()=>{console.log("OK, gelesen. clicked")}}]})).present()})()}toastMissingResult(t,i){var n=this;return(0,m.A)(function*(){(yield n.alertCtrl.create({header:"Achtung",subHeader:"Fehlendes Resultat!",message:"Nach der Erfassung der letzten Wertung in dieser Riege scheint es noch leere Wertungen zu geben. Bitte pr\xfcfen, ob "+i.toUpperCase()+" geturnt hat.",buttons:[{text:"Nicht geturnt",role:"edit",handler:()=>{n.nextEmptyOrFinish(t)}},{text:"Korrigieren",role:"cancel",handler:()=>{console.log("Korrigieren clicked")}}]})).present()})()}static \u0275fac=function(i){return new(i||a)};static \u0275cmp=e.VBU({type:a,selectors:[["app-wertung-editor"]],viewQuery:function(i,n){1&i&&(e.wEZ(n.form,O,5),e.wEZ(n.enote,$,5),e.wEZ(n.dnote,X,5)),2&i&&e.NyB(3)},standalone:!1,decls:24,vars:9,consts:[["wertungsform","ngForm"],["endnote",""],["btnValidate",""],["enote",""],["dnote",""],["btnSaveNext",""],["slidingAthletItem",""],["slot","start"],["defaultHref","/"],["slot","end"],[1,"athlet"],[1,"riege"],[3,"ngSubmit","keyup.enter"],["slot","start","name","musical-notes-outline"],["size","large","color","primary",3,"click","disabled"],["slot","end","size","large","color","danger",3,"click","disabled"],["name","power-outline"],[3,"name","waiting","valueTitle","fixed","ngModel","disabled"],[3,"ngModelChange","name","waiting","valueTitle","fixed","ngModel","disabled"],["type","number","readonly","","name","eEndnote",3,"label","ngModel","disabled"],["label","Endnote","type","number","readonly","","name","endnote",3,"ngModel","disabled"],["size","large","expand","block","color","secondary",3,"disabled"],["type","number","readonly","","name","dEndnote",3,"label","ngModel","disabled"],["size","large","expand","block","color","secondary",3,"click","disabled"],["slot","start","name","acalculator-outline"],["name","noteD",3,"waiting","valueTitle","fixed","ngModel","disabled"],["name","noteE",3,"ngModelChange","waiting","valueTitle","fixed","ngModel","disabled"],["name","noteD",3,"ngModelChange","waiting","valueTitle","fixed","ngModel","disabled"],["slot","start","name","calculator-outline"],["size","large","expand","block","type","submit","color","success",3,"disabled"],["slot","start","name","arrow-forward-circle-outline"],["slot","start","name","checkmark-circle"],[3,"click"],["slot","end","name","arrow-forward-circle-outline"],["side","end"],["color","primary",3,"click"],["name","arrow-forward-circle-outline","ios","md-arrow-forward-circle-outline"]],template:function(i,n){if(1&i){const o=e.RV6();e.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",7),e.nrm(3,"ion-back-button",8),e.k0s(),e.j41(4,"ion-title"),e.EFF(5),e.k0s(),e.j41(6,"ion-note",9)(7,"div",10),e.EFF(8),e.k0s(),e.j41(9,"div",11),e.EFF(10),e.k0s()()()(),e.j41(11,"ion-content"),e.nVh(12,z,11,5),e.j41(13,"form",12,0),e.bIt("ngSubmit",function(){r.eBV(o);const f=e.sdS(14);return r.Njj(n.saveNext(f))})("keyup.enter",function(){r.eBV(o);const f=e.sdS(14);return r.Njj(n.saveNext(f))}),e.Z7z(15,Y,6,1,"ion-list",null,e.fX1),e.nVh(17,Q,12,7,"ion-list"),e.nVh(18,H,8,9,"ion-list"),e.j41(19,"ion-list"),e.nVh(20,q,2,0,"ion-item"),e.nVh(21,ee,2,1,"ion-item")(22,te,7,2),e.k0s(),e.nVh(23,ae,4,3,"ion-list"),e.k0s()()}if(2&i){const o=e.sdS(14);e.R7$(5),e.JRh(n.geraetName()),e.R7$(3),e.JRh(n.item.vorname+" "+n.item.name),e.R7$(2),e.JRh(n.wertung.riege),e.R7$(2),e.vxM(n.isNetworkMediaPlayerAvailable&&null!=n.item.wertung&&n.item.wertung.mediafile?12:-1),e.R7$(3),e.Dyx(n.exercices),e.R7$(2),e.vxM(n.exercices.length>0?17:-1),e.R7$(),e.vxM(0==n.exercices.length?18:-1),e.R7$(2),e.vxM(!o.valid&&n.editable()?20:-1),e.R7$(),e.vxM(n.editable()?22:21),e.R7$(2),e.vxM(n.nextItem?23:-1)}},dependencies:[u.qT,u.BC,u.cb,u.vS,u.cV,s.mC,s.Jm,s.QW,s.W9,s.eU,s.iq,s.$w,s.uz,s.Dg,s.LU,s.CE,s.A7,s.nf,s.JI,s.BC,s.ai,s.su,s.el,G],styles:[".riege[_ngcontent-%COMP%]{font-size:small;padding-right:16px;color:var(--ion-color-medium)}.athlet[_ngcontent-%COMP%]{font-size:larger;padding-right:16px;font-weight:bolder;color:var(--ion-color-primary)}"]})}return a})();var se=d(5079);const le=[{path:"",component:re}];let de=(()=>{class a{static \u0275fac=function(i){return new(i||a)};static \u0275mod=e.$C({type:a});static \u0275inj=r.G2t({imports:[_.MD,u.YN,s.bv,b.iI.forChild(le),se.h]})}return a})()},5079:(M,h,d)=>{d.d(h,{h:()=>r});var _=d(2200),u=d(4341),b=d(9893),s=d(2615),m=d(3664);let r=(()=>{class e{static \u0275fac=function(p){return new(p||e)};static \u0275mod=m.$C({type:e});static \u0275inj=s.G2t({imports:[_.MD,u.YN,b.bv]})}return e})()}}]);