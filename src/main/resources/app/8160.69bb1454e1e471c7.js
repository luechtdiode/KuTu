"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[8160],{8160:($,m,r)=>{r.r(m),r.d(m,{LastTopResultsPageModule:()=>F});var u=r(2200),p=r(4341),h=r(8132),s=r(7343),c=r(2615),f=r(2350),T=r(5964),g=r(1158),t=r(3664);function v(o,a){if(1&o&&(t.j41(0,"ion-select-option",6),t.EFF(1),t.nI1(2,"date"),t.k0s()),2&o){const e=a.$implicit;t.Y8G("value",e.uuid),t.R7$(),t.SpI(" ",e.titel+" "+t.i5U(2,2,e.datum,"dd-MM-yy"))}}function R(o,a){if(1&o){const e=t.RV6();t.j41(0,"ion-select",5),t.mxI("ngModelChange",function(n){c.eBV(e);const l=t.XpG(2);return t.DH7(l.competition,n)||(l.competition=n),c.Njj(n)}),t.Z7z(1,v,3,5,"ion-select-option",6,t.fX1),t.k0s()}if(2&o){const e=t.XpG(2);t.R50("ngModel",e.competition),t.R7$(),t.Dyx(e.getCompetitions())}}function k(o,a){if(1&o&&(t.j41(0,"ion-col")(1,"ion-item"),t.nVh(2,R,3,1,"ion-select",4),t.k0s()()),2&o){const e=t.XpG();t.R7$(2),t.vxM(e.getCompetitions().length>0?2:-1)}}function x(o,a){if(1&o&&(t.j41(0,"ion-note",3),t.EFF(1),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.SpI(" ",e.competitionName()," ")}}function C(o,a){if(1&o&&(t.j41(0,"ion-col",7),t.nrm(1,"result-display",8),t.k0s()),2&o){const e=a.$implicit,i=t.XpG(3);t.BMQ("size-xl",i.getMaxColumnSpec()),t.R7$(),t.Y8G("item",e)("title",i.getTitle(e))("groupedBy",i.groupBy.PROGRAMM)}}function b(o,a){if(1&o&&(t.j41(0,"ion-row"),t.Z7z(1,C,2,4,"ion-col",7,t.fX1),t.k0s()),2&o){const e=a.$implicit,i=t.XpG(2);t.R7$(),t.Dyx(i.getWertungen(e))}}function M(o,a){if(1&o&&(t.j41(0,"ion-grid",2),t.Z7z(1,b,3,0,"ion-row",null,t.fX1),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Dyx(e.getProgramme())}}function _(o,a){if(1&o&&(t.j41(0,"ion-col",9),t.nrm(1,"result-display",8),t.k0s()),2&o){const e=a.$implicit,i=t.XpG(3);t.BMQ("size-xl",i.getMaxColumnSpec()),t.R7$(),t.Y8G("item",e)("title",i.getTitle(e))("groupedBy",i.groupBy.PROGRAMM)}}function y(o,a){if(1&o&&(t.j41(0,"ion-row"),t.Z7z(1,_,2,4,"ion-col",9,t.fX1),t.k0s()),2&o){const e=a.$implicit,i=t.XpG(2);t.R7$(),t.Dyx(i.getWertungen(e))}}function S(o,a){if(1&o&&(t.j41(0,"ion-grid",2),t.Z7z(1,y,3,0,"ion-row",null,t.fX1),t.k0s()),2&o){const e=t.XpG();t.R7$(),t.Dyx(e.getProgramme())}}let z=(()=>{class o{backendService=(0,c.WQX)(f.m);groupBy=g.R;items=[];toptop={};geraete=[];ngOnInit(){this.backendService.competitionSubject.subscribe(e=>{this.backendService.activateNonCaptionMode(this.backendService.competition).subscribe(i=>{this.geraete=i||[],this.sortItems()}),this.backendService.newLastResults.pipe((0,T.p)(i=>!!i&&!!i.lastTopResults)).subscribe(i=>{this.items=[],this.toptop={},Object.keys(i.lastTopResults).forEach(n=>{const l=i.lastTopResults[n],d=this.toptop[l.wertung.wettkampfdisziplinId];d?d.wertung.endnote<l.wertung.endnote&&(this.toptop[l.wertung.wettkampfdisziplinId]=l):this.toptop[l.wertung.wettkampfdisziplinId]=l}),Object.keys(this.toptop).forEach(n=>{this.items.push(this.toptop[n])}),this.sortItems()})})}constructor(){this.backendService.competitions||this.backendService.getCompetitions()}sortItems(){this.items=this.items.sort((e,i)=>{let n=e.programm.localeCompare(i.programm);return 0===n&&(n=this.geraetOrder(e.geraet)-this.geraetOrder(i.geraet)),n})}get stationFreezed(){return this.backendService.stationFreezed}set competition(e){this.stationFreezed||(this.backendService.getDurchgaenge(e),this.backendService.activateNonCaptionMode(this.backendService.competition).subscribe(i=>{this.geraete=i||[],this.sortItems()}))}get competition(){return this.backendService.competition||""}getCompetitions(){return this.backendService.competitions||[]}competitionName(){if(!this.backendService.competitions)return"";const e=this.backendService.competitions.filter(i=>i.uuid===this.backendService.competition).map(i=>i.titel+", am "+(i.datum+"T").split("T")[0].split("-").reverse().join("-"));return 1===e.length?e[0]:""}geraetOrder(e){return this.geraete?this.geraete.findIndex(n=>n.id===e):0}geraetText(e){if(!this.geraete)return"";const i=this.geraete.filter(n=>n.id===e).map(n=>n.name);return 1===i.length?i[0]:""}getColumnSpec(){return this.geraete?.length||0}getMaxColumnSpec(){return Math.min(12,Math.max(1,Math.floor(12/this.geraete.length+.5)))}getTitle(e){return e.programm+" - "+this.geraetText(e.geraet)}onlyUnique(e,i,n){return n.indexOf(e)===i}getProgramme(){return this.items.map(e=>e.programm).filter(this.onlyUnique)}getWertungen(e){return this.items.filter(i=>i.programm===e)}itemTapped(e,i){}static \u0275fac=function(i){return new(i||o)};static \u0275cmp=t.VBU({type:o,selectors:[["app-last-top-results"]],standalone:!1,decls:17,vars:4,consts:[["slot","start"],["slot","icon-only","name","menu"],["no-padding",""],["slot","end"],["label","Wettkampf","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModel"],["label","Wettkampf","placeholder","Bitte ausw\xe4hlen","okText","Okay","cancelText","Abbrechen",3,"ngModelChange","ngModel"],[3,"value"],["size-xs","12","size-md","6","size-lg","3",1,"align-self-start"],[3,"item","title","groupedBy"],["size-xs","12","size-sm","6","size-md","4","size-lg","3",1,"align-self-start"]],template:function(i,n){1&i&&(t.j41(0,"ion-header")(1,"ion-toolbar")(2,"ion-buttons",0)(3,"ion-menu-toggle")(4,"ion-button"),t.nrm(5,"ion-icon",1),t.k0s()()(),t.j41(6,"ion-title")(7,"ion-grid",2)(8,"ion-row")(9,"ion-col")(10,"ion-label"),t.EFF(11,"Top Resultate"),t.k0s()(),t.nVh(12,k,3,1,"ion-col"),t.k0s()()(),t.nVh(13,x,2,1,"ion-note",3),t.k0s()(),t.j41(14,"ion-content"),t.nVh(15,M,3,0,"ion-grid",2),t.nVh(16,S,3,0,"ion-grid",2),t.k0s()),2&i&&(t.R7$(12),t.vxM(n.competition?-1:12),t.R7$(),t.vxM(n.competition?13:-1),t.R7$(2),t.vxM(n.items.length>0&&6===n.getColumnSpec()?15:-1),t.R7$(),t.vxM(n.items.length>0&&6!==n.getColumnSpec()?16:-1))},dependencies:[p.BC,p.vS,s.Jm,s.QW,s.hU,s.W9,s.lO,s.eU,s.iq,s.uz,s.he,s.cA,s.JI,s.ln,s.Nm,s.Ip,s.BC,s.ai,s.Je,g.v,u.vh],encapsulation:2})}return o})();var j=r(5079);const P=[{path:"",component:z}];let F=(()=>{class o{static \u0275fac=function(i){return new(i||o)};static \u0275mod=t.$C({type:o});static \u0275inj=c.G2t({imports:[u.MD,p.YN,s.bv,h.iI.forChild(P),j.h]})}return o})()}}]);