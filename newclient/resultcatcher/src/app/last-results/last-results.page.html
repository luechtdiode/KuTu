<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-toggle>
        <ion-button>
          <ion-icon slot="icon-only" name="menu"></ion-icon>
        </ion-button>
      </ion-menu-toggle>
    </ion-buttons>
    <ion-title>
      <ion-grid no-padding>
        <ion-row>
          <ion-col>
            <ion-label>Aktuelle Resultate</ion-label>
          </ion-col>
          <ion-col *ngIf="!competition">
            <ion-item>
              <ion-label>Wettkampf</ion-label>
              <ion-select placeholder='Bitte auswählen' *ngIf="getCompetitions().length > 0" [(ngModel)]='competition' okText='Okay' cancelText='Abbrechen'>
                  <ion-select-option *ngFor='let comp of getCompetitions()' [value]='comp.uuid'>
                    {{comp.titel + ' ' + (comp.datum | date:'dd-MM-yy')}}</ion-select-option>
                </ion-select>
            </ion-item>
          </ion-col>
        </ion-row>
      </ion-grid>
    </ion-title>
    <ion-note slot="end" *ngIf="competition">
      {{competitionName()}}
    </ion-note>    
  </ion-toolbar>
  <ion-searchbar *ngIf="scorelistAvailable()" placeholder="Search" showCancelButton="never"
    [(ngModel)]="sMyQuery"
    (ionInput)="reloadList($event)"
    (ionCancel)="reloadList($event)">
  </ion-searchbar>
</ion-header>

<ion-content>
  <ion-grid no-padding *ngIf="items.length > 0">
    <ion-row>
      <ion-col class="align-self-start"
        size-xs="12" size-md="6" size-lg="4" size-xl="2"
       col-12 col-sm-6 col-lg-4 col-xl-2 *ngFor='let w of items'
        (click)="itemTapped($event, w)">
        <div [ngClass]="{'gradient-border':isNew(w)}">
          <result-display [item]="w" [title]="getTitle(w)"></result-display>
        </div>
      </ion-col>
    </ion-row>
  </ion-grid>
  <ion-list *ngIf="scorelistAvailable()">
    <div *ngFor="let block of filteredScoreList">
      <ion-item-divider>{{block.title.text}}</ion-item-divider>
      <ion-item-sliding #slidingAthletItem *ngFor="let tn of block.rows">
        <scorelist-item [teilnehmer]="tn"
        (click)='itemTapped(tn, slidingAthletItem)'></scorelist-item>
        <!--ion-item-options side="end">
          <ion-item-option color="primary" (click)="followAthlet(tn, slidingAthletItem)">
              <ion-icon name="arrow-dropright-circle" ios="md-arrow-dropright-circle"></ion-icon>
            Detail-Wertungen {{tn.athlet}}
          </ion-item-option>
        </ion-item-options-->
      </ion-item-sliding>
    </div>    
  </ion-list>
</ion-content>

<ion-footer *ngIf="!!navigator && !!navigator.share && scorelistAvailable()">
  <ion-toolbar>
    <ion-list>
      <ion-button size="large" (click)="open()">
        <ion-icon slot="start" name="open"></ion-icon>Rangliste öffnen ...
      </ion-button>
      <ion-button size="large" (click)="share()">
        <ion-icon slot="start" name="share"></ion-icon>Share/Teilen ...
      </ion-button>
    </ion-list>
  </ion-toolbar>
</ion-footer>